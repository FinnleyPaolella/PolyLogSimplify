(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    296978,       7151]
NotebookOptionsPosition[    283948,       6907]
NotebookOutlinePosition[    284378,       6924]
CellTagsIndexPosition[    284335,       6921]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<PolyLogSimplify`\>\"", "]"}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.959569246158327*^9, 3.959569246158327*^9}, {
  3.9595692979153175`*^9, 3.9595693003063602`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"73c9fd6d-31db-fb48-bb8d-6d5ae1781c89"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Conj", "::", "usage"}], " ", "=", 
   " ", "\"\<Conj[a] returns the conjugate of a, changing the coefficients \
rather than the number field if a is an algebraic number.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9595693172928314`*^9, 3.9595693222313786`*^9}, {
  3.9595694099736576`*^9, 3.9595694255894337`*^9}, {3.9595696605413303`*^9, 
  3.9595696775758743`*^9}, {3.9595711482347164`*^9, 3.9595711493436375`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"01961651-9467-cb40-9c38-d5898273efab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InRealEmbeddings", "::", "usage"}], " ", "=", 
   " ", "\"\<InRealEmbeddings[expr] returns a list of expressions where the \
algebraic numbers in expr have been put into the different real embeddings.\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InComplexEmbeddings", "::", "usage"}], " ", "=", 
   " ", "\"\<InComplexEmbeddings[expr] returns a list of expressions where \
the algebraic numbers in expr have been put into the different complex \
embeddings (without embeddings conjugate to each other).\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InRealAndComplexEmbeddings", "::", "usage"}], " ", "=", 
   " ", "\"\<InRealAndComplexEmbeddings[expr] returns a list of expressions \
where the algebraic numbers in expr have been put into the different real and \
complex embeddings (without embeddings conjugate to each other).\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[3]:=",ExpressionUUID->"cf2c1847-6f3d-d841-805a-91311112cca2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Li2", "::", "usage"}], 
   "=", "\"\<Li2[x] represents PolyLog[2,x].\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReLi2", "::", "usage"}], 
   "=", "\"\<ReLi2[x] represents Re[PolyLog[2,x]].\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImLi2", "::", "usage"}], 
   "=", "\"\<ImLi2[x] represents Im[PolyLog[2,x]].\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D2", "::", "usage"}], 
   "=", "\"\<D2[x] represents the single-valued Bloch-Wigner \
dilogarithm\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ND2", "::", "usage"}], 
   "=", "\"\<ND2[x] gives the representation of D2[x] in terms of PolyLog and \
Log.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Li3", "::", "usage"}], 
   "=", "\"\<Li3[x] represents PolyLog[3,x]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReLi3", "::", "usage"}], 
   "=", "\"\<ReLi3[x] represents Re[PolyLog[3,x]]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImLi3", "::", "usage"}], 
   "=", "\"\<Imi3[x] represents Im[PolyLog[3,x]]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D3", "::", "usage"}], 
   "=", "\"\<D3[x] represents the single-valued trilogarithm.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ND3", "::", "usage"}], " ", "=", 
   " ", "\"\<ND3[x] gives the representation of D3[x] in terms of PolyLog and \
Log.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"N100", "::", "usage"}], 
   "=", "\"\<N100[x] is equivalent to N[x,{Infinity,x}] (100 places of \
accuracy).\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[6]:=",ExpressionUUID->"83984ce0-a45d-5548-b3ff-7378c116775f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sLi2", "::", "usage"}], " ", "=", 
   " ", "\"\<sLi2[x] uses the symmetries to evalute to an expression with \
Li2[y] where y is the representative of the symmetry class of x.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sImLi2", "::", "usage"}], " ", "=", 
   " ", "\"\<sImLi2[x] uses the symmetries to evalute to an expression with \
ImLi2[y] where y is the representative of the symmetry class of x.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sReLi2", "::", "usage"}], " ", "=", 
   " ", "\"\<sReLi2[x] uses the symmetries to evalute to an expression with \
ReLi2[y] where y is the representative of the symmetry class of x.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sD2", "::", "usage"}], " ", "=", 
   " ", "\"\<sD2[x] uses the symmetries to evalute to an expression with \
D2[y] where y is the representative of the symmetry class of x.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sD2NoConj", "::", "usage"}], " ", "=", 
   " ", "\"\<sD2NoConj[x] uses the symmetries (except the conjugation \
symmetry) to evalute to an expression with D2[y] where y is the \
representative of the symmetry class of x.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sLi3", "::", "usage"}], " ", "=", 
   " ", "\"\<sLi3[x] uses the symmetries to evalute to an expression with \
Li3[y] where y is the representative of the symmetry class of x.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sReLi3", "::", "usage"}], " ", "=", 
   " ", "\"\<sReLi3[x] uses the symmetries to evalute to an expression with \
ReLi3[y] where y is the representative of the symmetry class of x.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sImLi3", "::", "usage"}], " ", "=", 
   " ", "\"\<sImLi3[x] uses the symmetries to evalute to an expression with \
ImLi3[y] where y is the representative of the symmetry class of x.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sD3", "::", "usage"}], " ", "=", 
   " ", "\"\<sD3[x] uses the symmetries to evalute to an expression with \
D3[y] where y is the representative of the symmetry class of x.\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9595706236776295`*^9, 3.959570858963356*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"4d08fe26-b935-b642-a1e3-0cf1ada4c667"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EquivalentArgumentsLi2", "::", "usage"}], "=", 
   " ", "\"\<EquivalentArgumentsLi2[z] gives the list \
{z,1/z,1-z,1/(1-z),z/(z-1),1-1/z}\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EquivalentArgumentsLi3", "::", "usage"}], 
   "=", "\"\<EquivalentArgumentsLi3[z] gives the list {z,1/z}\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EquivalentArgumentsD2", "::", "usage"}], " ", "=", 
   " ", "\"\<EquivalentArgumentsD2[z] gives the list Join[A,Conj/@A] where \
A={z,1/z,1-z,1/(1-z),z/(z-1),1-1/z}.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EquivalentArgumentsD3", "::", "usage"}], " ", "=", 
   " ", "\"\<EquivalentArgumentsD3[z] gives the list \
{z,1/z,Conj[z],Conj[1/z]}.\>\""}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"3ad34e9d-2fa0-6d42-96e0-913c17c8517e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LogSimplify", "::", "usage"}], " ", "=", 
   " ", "\"\<LogSimplify[expr] reduces the number of different logarithms in \
expr as much as possible.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.959571278215767*^9, 3.959571330935812*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"bc805bf3-6048-a24b-a451-b0dd434d8c26"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PreprocessTrilogsAndDilogs", "::", "usage"}], " ", "=", 
   " ", "\"\<PreprocessTrilogsAndDilogs[expr] converts all trilogs and dilogs \
to ImLi3, D3, ReLi2, D2 and applies the symmetries.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[27]:=",ExpressionUUID->"fc023ea6-0d2e-bf44-99db-0dc24634263d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DuplicationRelationD2", "::", "usage"}], " ", "=", 
   " ", "\"\<DuplicationRelationD2[x] gives a relation with value 0.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FiveTermRelationD2", "::", "usage"}], 
   "=", "\"\<FiveTermRelationD2[x,y] gives a relation with value 0.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DuplicationRelationD3", "::", "usage"}], " ", "=", 
   " ", "\"\<DuplicationRelationD3[x] gives a relation with value 0.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ThreeTermRelationD3", "::", "usage"}], " ", "=", 
   " ", "\"\<ThreeTermRelationD3[x] gives a relation with value 0.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NineTermRelationD3", "::", "usage"}], " ", "=", 
   " ", "\"\<NineTermRelationD3[x,y] gives a relation with value 0.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TwentyTwoTermRelationD3", "::", "usage"}], 
   "=", "\"\<TwentyTwoTermRelationD3[x,y,z] gives a relation with value \
0.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DistributionRelationD2", "::", "usage"}], " ", "=", 
   " ", "\"\<DistributionRelationD2[n,gen][x] gives the distribution relation \
of order n, where the appearing roots of unity are expressed in the number \
field generated by gen.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DistributionRelationD3", "::", "usage"}], " ", "=", 
   " ", "\"\<DistributionRelationD3[n,gen][x] gives the distribution relation \
of order n, where the appearing roots of unity are expressed in the number \
field generated by gen.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetDistributionRelationsD2", "::", "usage"}], 
   "=", "\"\<GetDistributionRelationsD2[n, gen] gives the distribution \
relations for all divisor of n.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetDistributionRelationsD3", "::", "usage"}], 
   "=", "\"\<GetDistributionRelationsD3[n, gen] gives the distribution \
relations for all divisor of n.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9595732818476143`*^9, 3.959573469638546*^9}, {
  3.9595735004584465`*^9, 3.9595735857411404`*^9}, {3.9596019122965355`*^9, 
  3.9596019124320164`*^9}},ExpressionUUID->"8d61c227-a8be-5440-abb0-\
ce42f843bd50"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Beta2", "::", "usage"}], " ", "=", 
   " ", "\"\<Beta2[expr] returns the symbol corresponding to the dilogarithm \
expression.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Beta3", "::", "usage"}], " ", "=", 
   " ", "\"\<Beta3[expr] returns the symbol corresponding to the trilogarithm \
expression.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[37]:=",ExpressionUUID->"15530d53-1559-5e41-9cc3-e10bf2fbce5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TensorExpandRationalFunctions", "::", "usage"}], 
   "=", "\"\<TensorExpandRationalFunctions[expr] expands an expression \
Tensor[MultElt[f],Mult[g],...] + ... where f,g are rational functions\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[39]:=",ExpressionUUID->"107d5d66-206c-7041-8b47-4aca86dc6fe8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IndependentRelationsWithContractions", "::", "usage"}], " ", "=", 
   " ", "\"\<IndependentRelationsWithContractions[relationList,\
relatedArguments,F->sF] returns a list of all independent relations and \
contractions built from the relationList using the symmetries \
provided.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[40]:=",ExpressionUUID->"e0b4b808-6e75-f340-8191-bd82b27d5577"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ElementOfG2", "::", "usage"}], " ", "=", 
   " ", "\"\<ElementOfG2[expr] verifies wether a rational linear combination \
of D2[_] corresponds to an element in G_2 = A_2\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElementOfA2", "::", "usage"}], " ", "=", 
   " ", "\"\<ElementOfA2[expr] verifies wether a rational linear combination \
of D2[_] corresponds to an element in G_2 = A_2\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZeroInB2", "::", "usage"}], " ", "=", 
   " ", "\"\<ZeroInB2[expr] verifies wether a linear combination of D2[_] \
corresponds to a torsion element in B2 by attempting to write it as a linear \
combination of the five-term relation. Returns unevaluted if no such \
combination is found.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElementOfG3", "::", "usage"}], " ", "=", 
   " ", "\"\<ElementOfG3[expr] verifies wether a rational linear combination \
of D3[_] corresponds to an elment in G_3\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElementOfA3", "::", "usage"}], " ", "=", 
   " ", "\"\<ElementOfA3[expr] verifies wether a rational linear combination \
of D3[_] corresponds to an elment in A_3\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[41]:=",ExpressionUUID->"0a927b86-5bde-6140-9fbf-f07681f896c8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SeperateZeroSubexpression", "::", "usage"}], 
   "=", "\"\<SeperateZeroSubexpression[expr,relationList,F->sF] numerically \
seperates the expression into multiple expressions equaling zero with fewer \
terms; uses the symmetry F->sF.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GreedySimplify", "::", "usage"}], 
   "=", "\"\<GreedySimplify[expr,relationList,F->sF] reduces the number of \
terms of F by greedily subtracting relations; uses the symmetry F->sF.\>\""}],
   ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.959574201503683*^9, 3.9595742018015976`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"bf71d755-a704-9c40-bee6-938ce63f98a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SimplifyAllTermsOneIteration", "::", "usage"}], " ", "=", 
   " ", "\"\<SimplifyAllTermsOneIteration[expr,relationList,F->sF] attempts \
to eliminate all F terms in expr using the functional equations from \
relationList and the symmetry F->sF. See examples to understand what is \
meant.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimplifyAllTerms", "::", "usage"}], " ", "=", 
   " ", "\"\<SimplifyAllTerms[expr,plan,F->sF] attempts to eliminate all F \
terms in expr. plan should be a list with an association for each iteration, \
specifying relations, newArguments and linearSolve to be used in that \
iteration. See examples to understand what is meant.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[48]:=",ExpressionUUID->"8058decb-73e2-4b4f-b56b-7441ffac4c06"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Certificate", "::", "usage"}], 
   "=", "\"\<Certificate is a symbol used in the return value of the \
simplification routine if the option ReturnCertificate is set to True\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReturnCertificate", "::", "usage"}], " ", "=", 
  " ", "\"\<ReturnCertificate -> True can be given as an option to the \
simplification routines.\>\""}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9600051881111774`*^9, 3.960005263041624*^9}, {
  3.960005310238661*^9, 
  3.9600053390378246`*^9}},ExpressionUUID->"e4cc5703-7157-6a4d-9e20-\
fc2efa67656c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NewArgumentsFirstIteration", "::", "usage"}], " ", "=", 
   " ", "\"\<NewArgumentsFirstIteration should be provided as newArguments \
function in the first iteration of SimplifyAllTerms.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NewArgumentsSecondIterationAll", "::", "usage"}], " ", "=", 
   " ", "\"\<NewArgumentsSecondIterationAll can be provided as newArguments \
function in the second iteration of SimplifyAllTerms, does not apply any \
heuristics.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NewArgumentsSecondIterationWithCutoff", "::", "usage"}], " ", "=",
    " ", "\"\<NewArgumentsSecondIterationWithCutoff[#1,#2,cutoff]& can be \
provided as newArguments function in the second iteration of \
SimplifyAllTerms, only uses arguments which appear in relations with no more \
than cutoff new arguments.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LinearSolveStandard", "::", "usage"}], " ", "=", 
   " ", "\"\<LinearSolveStandard can be provided as linear solve function to \
SimplifyAllTerms; does not apply any heuristics.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LinearSolveWithCutoff", "::", "usage"}], 
   "=", "\"\<LinearSolveWithCutoff[#1,#2,{a_1,...,a_n},c]& can be provided in \
the n-th iteration of SimplifyAllTerms as a linear solve function. Relations \
from iteration i with more than a_i new arguments are discarded and so are \
relations which contain arguments appearing in less than c other relations.\>\
\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.959574727345148*^9, 3.959574849122959*^9}, {
   3.959574885097786*^9, 3.959574943928171*^9}, {3.9595749947966785`*^9, 
   3.9595750256370163`*^9}, {3.95957507742527*^9, 3.9595750778798904`*^9}, {
   3.959575125497343*^9, 3.9595752154271393`*^9}, {3.959575737414118*^9, 
   3.9595757421093388`*^9}, 3.9595757957248344`*^9, {3.9595758429266453`*^9, 
   3.959575864198433*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"fe1dcbbf-8360-144c-8122-c4c734194451"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MultElt", "::", "usage"}], " ", 
   "=", "\"\<MultElt[z] represents the element z in an abelian group under \
multiplication, so MultElt[a * b] = MultElt[a] + MultElt[b].\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[55]:=",ExpressionUUID->"6691cad9-1d15-8045-ae5c-c4b57ac79c72"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.959571165555937*^9, 3.959571165555937*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"46f6cf40-aabb-dc42-9702-1e6874b01021"],

Cell[CellGroupData[{

Cell["Conjugate", "Subsection",
 CellChangeTimes->{{3.9595694746024513`*^9, 3.959569477431608*^9}, 
   3.9595974557890053`*^9, {3.959998063791973*^9, 
   3.959998064182966*^9}},ExpressionUUID->"e0944e62-87d9-4d4d-a984-\
3fe835a33113"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"conjugationTransform", "::", "nclosed"}], " ", "=", 
    " ", "\"\<The number field defined by `1` is not closed under complex \
conjugation. You might want to choose a generator of the number field \
generated by `1` and its conjugate.\>\""}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Computing", " ", "the", " ", "matrix", " ", "is", " ", "computationally", 
    " ", "rather", " ", "expensive", " ", "as", " ", "ToNumberField", " ", 
    "can", " ", "take", " ", "quit", " ", "some", " ", 
    RowBox[{"time", ".", " ", "So"}], " ", "we", " ", "use", " ", 
    "memoization", " ", "as", " ", "the", " ", "number", " ", "field", " ", 
    "is", " ", "typically", " ", "the", " ", 
    RowBox[{"same", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"conjugationTransform", "[", "gen_", "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"conjugationTransform", "[", "gen", "]"}], " ", "=", " ", 
     RowBox[{"With", "[", "\n", "    ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"degreeOfExtension", " ", "=", " ", 
         RowBox[{"Length", "@", 
          RowBox[{"Last", "@", 
           RowBox[{"ToNumberField", "[", 
            RowBox[{"gen", ",", " ", "gen"}], "]"}]}]}]}], "}"}], ",", "\n", 
       "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Quiet", "@", 
          RowBox[{"Check", "[", "\n", "       ", 
           RowBox[{
            RowBox[{
             RowBox[{"ToNumberField", "[", 
              RowBox[{
               RowBox[{"Conjugate", "[", "gen", "]"}], ",", " ", "gen"}], 
              "]"}], ";", " ", "False"}], ",", "\n", "       ", "True", ",", 
            "\n", "       ", 
            RowBox[{"ToNumberField", "::", "nnfel"}]}], "\n", "       ", 
           "]"}]}], ",", "\n", "     ", "\n", "     ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "If", " ", "the", " ", "number", " ", "field", " ", "is", " ", 
            "not", " ", "closed", " ", "under", " ", "complex", " ", 
            "conjugation"}], ",", " ", 
           RowBox[{
           "messages", " ", "and", " ", "error", " ", "and", " ", "returns", " ", 
            RowBox[{"unevaluated", "."}]}]}], " ", "*)"}], "\n", "     ", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"conjugationTransform", "::", "nclosed"}], ",", " ", 
            "gen"}], "]"}], ";", "\n", "     ", 
          RowBox[{"HoldForm", "[", 
           RowBox[{"conjugationTransform", "[", "gen", "]"}], "]"}]}], ",", 
         "\n", "     ", "\n", "     ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Compute", " ", "the", " ", "matrix", " ", "by", " ", "which", " ", 
           "one", " ", "has", " ", "to", " ", "multiply", " ", "the", " ", 
           "coefficients", " ", "to", " ", "conjugate", " ", "the", " ", 
           RowBox[{"number", "."}]}], " ", "*)"}], "\n", "     ", 
         RowBox[{"Transpose", "[", "\n", "      ", 
          RowBox[{"Join", "[", "\n", "       ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "1", "}"}], ",", " ", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"0", ",", " ", 
                 RowBox[{"degreeOfExtension", " ", "-", " ", "1"}]}], "]"}]}],
               "]"}], "}"}], ",", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ToNumberField", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Conjugate", "[", "gen", "]"}], "^", "i"}], ",", 
                 " ", "gen"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", " ", "1", ",", " ", 
                RowBox[{"degreeOfExtension", " ", "-", " ", "1"}]}], "}"}]}], 
             "]"}]}], "]"}], "\n", "      ", "]"}]}], "\n", "     ", "]"}]}], 
      "\n", "    ", "]"}]}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Conj", "[", "x_AlgebraicNumber", "]"}], " ", ":=", " ", 
    RowBox[{"AlgebraicNumber", "[", 
     RowBox[{
      RowBox[{"First", "@", "x"}], ",", " ", 
      RowBox[{
       RowBox[{"conjugationTransform", "[", 
        RowBox[{"First", "@", "x"}], "]"}], " ", ".", " ", 
       RowBox[{"Last", "[", "x", "]"}]}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "[", "x", "]"}], " ", "yields", " ", "the", " ", 
     "generator"}], ",", " ", 
    RowBox[{
     RowBox[{"Last", "[", "x", "]"}], " ", "yields", " ", "the", " ", 
     RowBox[{"coefficients", "."}]}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Conj", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Conjugate", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "If", " ", "the", " ", "number", " ", "is", " ", "not", " ", "an", " ", 
     "Algebraic", " ", "number"}], ",", " ", 
    RowBox[{"the", " ", "standard", " ", "Conjugate", " ", "is", " ", 
     RowBox[{"used", "."}]}]}], "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.959566598018257*^9, {3.9595669173745575`*^9, 3.9595669176875153`*^9}, {
   3.959568646389742*^9, 3.959568646405369*^9}, 3.959569398551388*^9},
 CellLabel->"In[57]:=",ExpressionUUID->"241dfc59-c8e8-484d-89f4-ccee7ccd4711"]
}, Closed]],

Cell[CellGroupData[{

Cell["Embeddings", "Subsection",
 CellChangeTimes->{{3.9595697150378304`*^9, 
  3.9595697197429943`*^9}},ExpressionUUID->"921a150e-8fb6-724b-8697-\
b57057a5fe04"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FieldEmbeddings", "[", "polynomial_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "degree", ",", "allGenerators", ",", 
       RowBox[{"realEmbeddings", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"complexEmbeddings", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ",", "g", ",", " ", "cg"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"degree", "=", 
       RowBox[{"Exponent", "[", 
        RowBox[{
         RowBox[{"polynomial", "[", "x", "]"}], ",", "x"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allGenerators", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Root", "[", 
          RowBox[{"polynomial", ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "degree"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "allGenerators"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"g", "=", 
          RowBox[{"allGenerators", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"cg", " ", "=", 
          RowBox[{"Conjugate", "[", "g", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"cg", "==", "g"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"realEmbeddings", ",", "g"}], "]"}], ";", " ", 
            RowBox[{"allGenerators", "=", 
             RowBox[{"allGenerators", "[", 
              RowBox[{"[", 
               RowBox[{"2", ";;"}], "]"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"complexEmbeddings", ",", 
              RowBox[{"{", 
               RowBox[{"g", ",", "cg"}], "}"}]}], "]"}], ";", " ", 
            RowBox[{"allGenerators", "=", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"allGenerators", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ";;"}], "]"}], "]"}], ",", "cg", ",", "1"}], 
              "]"}]}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"realEmbeddings", ",", "complexEmbeddings"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InDifferentEmbedding", "::", "morethanone"}], 
   "=", "\"\<Expression contains algebraic numbers with different generators.\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InDifferentEmbedding", "[", 
    RowBox[{"expr_", ",", "newGenerator_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"Union", "@", 
           RowBox[{"Cases", "[", 
            RowBox[{"expr", ",", 
             RowBox[{
              RowBox[{"AlgebraicNumber", "[", 
               RowBox[{"a_", ",", "_"}], "]"}], ":>", "a"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}]}]}], ">", 
         "1"}], ",", 
        RowBox[{"Message", "[", 
         RowBox[{"InDifferentEmbedding", "::", "morethanone"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"expr", "/.", 
       RowBox[{
        RowBox[{"AlgebraicNumber", "[", 
         RowBox[{"_", ",", "x_"}], "]"}], ":>", 
        RowBox[{"AlgebraicNumber", "[", 
         RowBox[{"newGenerator", ",", "x"}], "]"}]}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "InRealAndComplexEmbeddings", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InComplexEmbeddings", "::", "onegenerator"}], 
    "=", "\"\<Expression must contain algebraic numbers in the same number \
field.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InComplexEmbeddings", "[", "expr_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"generators", "=", 
        RowBox[{"Union", "@", 
         RowBox[{"Cases", "[", 
          RowBox[{"expr", ",", 
           RowBox[{
            RowBox[{"AlgebraicNumber", "[", 
             RowBox[{"a_", ",", "_"}], "]"}], ":>", "a"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}]}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "generators"}], "!=", "1"}], ",", 
         RowBox[{"Message", "[", 
          RowBox[{"InComplexEmbeddings", "::", "onegenerator"}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"InDifferentEmbedding", "[", 
            RowBox[{"expr", ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], ",", 
          RowBox[{"Last", "[", 
           RowBox[{"FieldEmbeddings", "[", 
            RowBox[{"First", "@", 
             RowBox[{"First", "[", "generators", "]"}]}], "]"}], "]"}]}], 
         "]"}], "/;", 
        RowBox[{
         RowBox[{"Length", "@", "generators"}], "==", "1"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InRealEmbeddings", "[", "expr_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"generators", "=", 
        RowBox[{"Union", "@", 
         RowBox[{"Cases", "[", 
          RowBox[{"expr", ",", 
           RowBox[{
            RowBox[{"AlgebraicNumber", "[", 
             RowBox[{"a_", ",", "_"}], "]"}], ":>", "a"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}]}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "generators"}], "!=", "1"}], ",", 
         RowBox[{"Message", "[", 
          RowBox[{"InComplexEmbeddings", "::", "onegenerator"}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"InDifferentEmbedding", "[", 
            RowBox[{"expr", ",", "#"}], "]"}], "&"}], ",", 
          RowBox[{"First", "[", 
           RowBox[{"FieldEmbeddings", "[", 
            RowBox[{"First", "@", 
             RowBox[{"First", "[", "generators", "]"}]}], "]"}], "]"}]}], 
         "]"}], "/;", 
        RowBox[{
         RowBox[{"Length", "@", "generators"}], "==", "1"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InRealAndComplexEmbeddings", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"generators", "=", 
        RowBox[{"Union", "@", 
         RowBox[{"Cases", "[", 
          RowBox[{"expr", ",", 
           RowBox[{
            RowBox[{"AlgebraicNumber", "[", 
             RowBox[{"a_", ",", "_"}], "]"}], ":>", "a"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "fieldEmbeddings"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "generators"}], "!=", "1"}], ",", 
        RowBox[{"Message", "[", 
         RowBox[{"InComplexEmbeddings", "::", "onegenerator"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fieldEmbeddings", "=", 
          RowBox[{"FieldEmbeddings", "[", 
           RowBox[{"First", "@", 
            RowBox[{"First", "[", "generators", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"InDifferentEmbedding", "[", 
             RowBox[{"expr", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"First", "@", "fieldEmbeddings"}], ",", 
             RowBox[{
              RowBox[{"Last", "[", "fieldEmbeddings", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}], "]"}]}], 
        "\[IndentingNewLine]", ")"}], "/;", 
       RowBox[{
        RowBox[{"Length", "@", "generators"}], "==", "1"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBmIQPUXoU2dj7VvHFmueLhB9QJ9vIojeEFoyDUQHTEpe
D6ItqlU2gOg9rJw7QfSLma6HQbSB/awTIHrFlosnQXRJ0vSzYPWuS26A6DMb
/70A0Qw/W1+CaJ01rhJNQNrH5J8hiA747ukGojdEhniA6BxJzWAQfWWCL5hm
sf4QDpbncYgA0S08tSlg/Q1/wXTDJZZMEG2gLQCmr+zeWw2iJd5P7QfRBc1N
UyHqdWeB5W/qVbs1vHVUiQkE0w0zehpB9JOarHYQfSPMtxdEr+D6NAtEzzCI
nw+iA/7VLQDRNe4ey0D0mR2lO8DqVoQcAtE7pgkcA9EKa9vPgugj6e8vgGgf
39CbIHpKFMMdEP0h/sx9EJ3xU/IBiH5T8fspiI7QVWJ3B9Ibgh14QPSNlR/A
9AeeoF4QnRLDuRBEAwDwpNyx
  "],
 CellLabel->"In[61]:=",ExpressionUUID->"9b871551-4678-da44-95d8-91116e9eca88"]
}, Closed]],

Cell[CellGroupData[{

Cell["Polylogarithm Symbols", "Subsection",
 CellChangeTimes->{{3.950611336279316*^9, 3.95061134107876*^9}, {
  3.950612490933876*^9, 3.9506124942321205`*^9}, {3.9557947422191334`*^9, 
  3.9557947506166267`*^9}, {3.9580063574809895`*^9, 3.958006370057766*^9}, {
  3.9595704030447674`*^9, 
  3.9595704392690296`*^9}},ExpressionUUID->"6e9d50d6-9f79-1a45-8c9f-\
71660ef90526"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Li2", "[", "x_", "]"}], ",", 
     RowBox[{"n_", ":", "MachinePrecision"}]}], "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"PolyLog", "[", 
      RowBox[{"2", ",", "x"}], "]"}], ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"ReLi2", "[", "x_", "]"}], ",", 
     RowBox[{"n_", ":", "MachinePrecision"}]}], "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Re", "@", 
      RowBox[{"PolyLog", "[", 
       RowBox[{"2", ",", "x"}], "]"}]}], ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"ImLi2", "[", "x_", "]"}], ",", 
     RowBox[{"n_", ":", "MachinePrecision"}]}], "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Im", "@", 
      RowBox[{"PolyLog", "[", 
       RowBox[{"2", ",", "x"}], "]"}]}], ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ND2", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ND2", "[", "0", "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ND2", "[", "x_", "]"}], ":=", 
   RowBox[{"Im", "[", 
    RowBox[{
     RowBox[{"PolyLog", "[", 
      RowBox[{"2", ",", "x"}], "]"}], "+", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"1", "-", "x"}], "]"}], " ", 
      RowBox[{"Log", "[", 
       RowBox[{"Abs", "[", "x", "]"}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"D2", "[", "x_", "]"}], ",", 
      RowBox[{"n_", ":", "MachinePrecision"}]}], "]"}], ":=", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"ND2", "[", "x", "]"}], ",", "n"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Li3", "[", "x_", "]"}], ",", 
     RowBox[{"n_", ":", "MachinePrecision"}]}], "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"PolyLog", "[", 
      RowBox[{"3", ",", "x"}], "]"}], ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"ReLi3", "[", "x_", "]"}], ",", 
     RowBox[{"n_", ":", "MachinePrecision"}]}], "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Re", "@", 
      RowBox[{"PolyLog", "[", 
       RowBox[{"3", ",", "x"}], "]"}]}], ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"ImLi3", "[", "x_", "]"}], ",", 
     RowBox[{"n_", ":", "MachinePrecision"}]}], "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Im", "@", 
      RowBox[{"PolyLog", "[", 
       RowBox[{"3", ",", "x"}], "]"}]}], ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ND3", "[", "1", "]"}], "=", 
   RowBox[{"Zeta", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ND3", "[", "z_", "]"}], ":=", 
   RowBox[{"Re", "[", 
    RowBox[{
     RowBox[{"PolyLog", "[", 
      RowBox[{"3", ",", "z"}], "]"}], "-", 
     RowBox[{
      RowBox[{"PolyLog", "[", 
       RowBox[{"2", ",", "z"}], "]"}], 
      RowBox[{"Log", "[", 
       RowBox[{"Abs", "[", "z", "]"}], "]"}]}], "-", 
     RowBox[{
      FractionBox["1", "3"], 
      RowBox[{"Log", "[", 
       RowBox[{"1", "-", "z"}], "]"}], 
      SuperscriptBox[
       RowBox[{"Log", "[", 
        RowBox[{"Abs", "[", "z", "]"}], "]"}], "2"]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"D3", "[", "x_", "]"}], ",", 
     RowBox[{"n_", ":", "MachinePrecision"}]}], "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"ND3", "[", "x", "]"}], ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"N100", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"n_", ":", "100"}]}], "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{"\[Infinity]", ",", "n"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9506125048597584`*^9, 3.950612571945999*^9}, {
  3.9557870000992584`*^9, 3.9557870003223286`*^9}, {3.9557870426467857`*^9, 
  3.9557871046025944`*^9}, {3.9577826477173386`*^9, 3.9577826709844265`*^9}, {
  3.9595699173770294`*^9, 3.959570081273451*^9}, {3.9595702091055393`*^9, 
  3.959570400604805*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"1e8e3e23-dbb3-6a44-9c08-279f1a40e679"]
}, Closed]],

Cell[CellGroupData[{

Cell["Polylogarithms Symmetries", "Subsection",
 CellChangeTimes->{{3.958006375666256*^9, 3.958006376898468*^9}, {
  3.9595713708059025`*^9, 3.9595713761694775`*^9}, {3.959998057528515*^9, 
  3.9599980613906784`*^9}},ExpressionUUID->"13d7d264-6a08-2443-80ad-\
16ac60343bd9"],

Cell[CellGroupData[{

Cell["Li2", "Subsubsection",
 CellChangeTimes->{{3.950611405650923*^9, 3.9506114134013577`*^9}, 
   3.959570995306446*^9},ExpressionUUID->"bcbed952-ca5f-0845-a75f-\
88104b4744f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Calling", " ", 
    RowBox[{"sLi2", "[", "z", "]"}], " ", "on", " ", "a", " ", "number", " ", 
    "that", " ", "was", " ", "not", " ", "seen", " ", "before", " ", "will", " ",
     "define", " ", "z", " ", "as", " ", "the", " ", "canonical", " ", 
    "argument", " ", "and", " ", "set", " ", "the", " ", "pattern", " ", "to",
     " ", "automatically", " ", "express", " ", 
    RowBox[{"sLi2", "[", 
     RowBox[{"1", "-", "z"}], "]"}], " ", "as", " ", 
    RowBox[{"Li2", "[", "z", "]"}], " ", "plus", " ", "some", " ", "error", " ",
     "consisting", " ", "only", " ", "of", " ", "log", " ", 
    RowBox[{"terms", ".", " ", "I"}], " ", "think", " ", "it", " ", "is", " ",
     "better", " ", "to", " ", "keep", " ", "the", " ", "logarithmic", " ", 
    "error", " ", "terms", " ", "symbolic", " ", "and", " ", "only", " ", 
    "compute", " ", "them", " ", "when", " ", "needed", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "so", " ", "we", " ", "do", " ", "not", " ", "compute", " ", "them", " ",
        "for", " ", "all", " ", "the", " ", "relations", " ", "that", " ", 
       "are", " ", "generated"}], ")"}], "."}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"sLi2", " ", "for", " ", "symmetric", " ", "Li2"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"sLi2", "[", "z_", "]"}], ":=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"sLi2", "[", 
         RowBox[{"1", "-", "z"}], "]"}], "=", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Li2", "[", "z", "]"}]}], "+", 
         RowBox[{"logTermsOneMinusZ", "[", "z", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sLi2", "[", 
         FractionBox["1", "z"], "]"}], "=", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Li2", "[", "z", "]"}]}], "+", 
         RowBox[{"logTermsOneOverZ", "[", "z", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sLi2", "[", 
         FractionBox["1", 
          RowBox[{"1", "-", "z"}]], "]"}], "=", 
        RowBox[{
         RowBox[{"Li2", "[", "z", "]"}], "+", 
         RowBox[{"logTermsOneOverOneMinusZ", "[", "z", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sLi2", "[", 
         RowBox[{"1", "-", 
          FractionBox["1", "z"]}], "]"}], "=", 
        RowBox[{
         RowBox[{"Li2", "[", "z", "]"}], "+", 
         RowBox[{"logTermsOneMinusOneOverZ", "[", "z", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sLi2", "[", 
         FractionBox["z", 
          RowBox[{"z", "-", "1"}]], "]"}], "=", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Li2", "[", "z", "]"}]}], "+", 
         RowBox[{"logTermsZOverZMinusOne", "[", "z", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sLi2", "[", "z", "]"}], " ", "=", 
        RowBox[{"Li2", "[", "z", "]"}]}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9506113761106396`*^9, 3.9506113805973625`*^9}, {
   3.950672840442459*^9, 3.950672877180094*^9}, 3.95578776422884*^9},
 CellLabel->"In[83]:=",ExpressionUUID->"48c58a05-09e7-1547-80bf-efaf0dc879a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ReLi2", "Subsubsection",
 CellChangeTimes->{{3.9506114318261127`*^9, 
  3.9506114343444633`*^9}},ExpressionUUID->"51fb6714-c6f9-9048-9e92-\
162a1a61bb02"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "we", " ", "need", " ", "to", " ", "define", " ", "this", " ", "as", " ", 
     "a", " ", "special", " ", "case"}], ",", " ", 
    RowBox[{"otherwise", " ", "would", " ", "get", " ", 
     FractionBox["1", 
      RowBox[{"1", "-", "1"}]], " ", "when", " ", "computing", " ", "the", " ",
      "related", " ", "values"}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"sReLi2", "[", "0", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"sReLi2", "[", "1", "]"}], "=", 
      FractionBox[
       SuperscriptBox["\[Pi]", "2"], "6"]}], ";"}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"do", " ", "not", " ", "need", " ", "this"}], ",", " ", 
      RowBox[{
       RowBox[{"is", " ", "covered", " ", "by", "  ", "z"}], "==", 
       FractionBox["1", 
        RowBox[{"conjugate", " ", "z"}]]}]}], "*)"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "the", " ", "following", " ", "simplifications", " ", "are", " ", "for", 
      " ", "self", " ", "conjugate", " ", 
      RowBox[{"arguements", ".", " ", "Not"}], " ", "all", " ", "are", " ", 
      RowBox[{"tested", ".", " ", "Note"}], " ", "that", " ", "there", " ", 
      "are", " ", "in", " ", "principal", " ", "more", " ", "cases", " ", 
      "where", " ", 
      RowBox[{"ReLi2", "[", "z", "]"}], " ", "can", " ", "be", " ", 
      "reduced"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"e", ".", "g", ".", " ", "when"}], " ", "z"}], "==", 
      RowBox[{
       RowBox[{
        FractionBox["1", "z"], ".", " ", "These"}], " ", "additional", " ", 
       "cases", " ", "are", " ", "coverd", " ", "by", " ", "the", " ", 
       "three", " ", "cases", " ", "here"}]}], ",", " ", 
     RowBox[{
     "because", " ", "the", " ", "solutions", " ", "of", " ", "the", " ", 
      "additional", " ", "equations", " ", "are", " ", "real", " ", "so", " ",
       "then", " ", "conjugate", " ", "does", " ", "not", " ", "matter"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sReLi2", "[", 
      RowBox[{"z_", "/;", 
       RowBox[{"z", "==", 
        FractionBox["1", 
         RowBox[{"Conj", "[", "z", "]"}]]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"sReLi2", "[", "z", "]"}], "=", 
      RowBox[{
       FractionBox["1", "4"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"logTermsOneOverZ", "[", "z", "]"}], "+", 
         RowBox[{"logTermsOneOverZ", "[", 
          RowBox[{"Conj", "@", "z"}], "]"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sReLi2", "[", 
      RowBox[{"z_", "/;", 
       RowBox[{"z", "==", 
        RowBox[{"1", "-", 
         RowBox[{"Conj", "[", "z", "]"}]}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"sReLi2", "[", "z", "]"}], "=", 
      RowBox[{
       FractionBox["1", "4"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"logTermsOneMinusZ", "[", "z", "]"}], "+", 
         RowBox[{"logTermsOneMinusZ", "[", 
          RowBox[{"Conj", "@", "z"}], "]"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sReLi2", "[", 
      RowBox[{"z_", "/;", 
       RowBox[{"z", "==", 
        RowBox[{"Conj", "[", 
         FractionBox["z", 
          RowBox[{"z", "-", "1"}]], "]"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"sReLi2", "[", "z", "]"}], "=", 
      RowBox[{
       FractionBox["1", "4"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"logTermsZOverZMinusOne", "[", "z", "]"}], "+", 
         RowBox[{"logTermsZOverZMinusOne", "[", 
          RowBox[{"Conj", "@", "z"}], "]"}]}], ")"}]}]}]}], ";"}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sReLi2", "[", "z_", "]"}], ":=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"sReLi2", "[", 
         RowBox[{"1", "-", "z"}], "]"}], "=", 
        RowBox[{
         RowBox[{"sReLi2", "[", 
          RowBox[{"Conj", "[", 
           RowBox[{"1", "-", "z"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"ReLi2", "[", "z", "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"logTermsOneMinusZ", "[", "z", "]"}], "+", 
             RowBox[{"logTermsOneMinusZ", "[", 
              RowBox[{"Conj", "@", "z"}], "]"}]}], ")"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sReLi2", "[", 
         FractionBox["1", "z"], "]"}], "=", 
        RowBox[{
         RowBox[{"sReLi2", "[", 
          RowBox[{"Conj", "[", 
           FractionBox["1", "z"], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"ReLi2", "[", "z", "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"logTermsOneOverZ", "[", "z", "]"}], "+", 
             RowBox[{"logTermsOneOverZ", "[", 
              RowBox[{"Conj", "@", "z"}], "]"}]}], ")"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sReLi2", "[", 
         FractionBox["1", 
          RowBox[{"1", "-", "z"}]], "]"}], "=", 
        RowBox[{
         RowBox[{"sReLi2", "[", 
          RowBox[{"Conj", "[", 
           FractionBox["1", 
            RowBox[{"1", "-", "z"}]], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"ReLi2", "[", "z", "]"}], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"logTermsOneOverOneMinusZ", "[", "z", "]"}], "+", 
             RowBox[{"logTermsOneOverOneMinusZ", "[", 
              RowBox[{"Conj", "@", "z"}], "]"}]}], ")"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sReLi2", "[", 
         RowBox[{"1", "-", 
          FractionBox["1", "z"]}], "]"}], "=", 
        RowBox[{
         RowBox[{"sReLi2", "[", 
          RowBox[{"Conj", "[", 
           RowBox[{"1", "-", 
            FractionBox["1", "z"]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"ReLi2", "[", "z", "]"}], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"logTermsOneMinusOneOverZ", "[", "z", "]"}], "+", 
             RowBox[{"logTermsOneMinusOneOverZ", "[", 
              RowBox[{"Conj", "@", "z"}], "]"}]}], ")"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sReLi2", "[", 
         FractionBox["z", 
          RowBox[{"z", "-", "1"}]], "]"}], "=", 
        RowBox[{
         RowBox[{"sReLi2", "[", 
          RowBox[{"Conj", "[", 
           FractionBox["z", 
            RowBox[{"z", "-", "1"}]], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"ReLi2", "[", "z", "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"logTermsZOverZMinusOne", "[", "z", "]"}], "+", 
             RowBox[{"logTermsZOverZMinusOne", "[", 
              RowBox[{"Conj", "@", "z"}], "]"}]}], ")"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sReLi2", "[", "z", "]"}], "=", 
        RowBox[{
         RowBox[{"sReLi2", "[", 
          RowBox[{"Conj", "[", "z", "]"}], "]"}], "=", 
         RowBox[{"ReLi2", "[", "z", "]"}]}]}]}], "\[IndentingNewLine]", 
      ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"TODO", ":", " ", 
      RowBox[{
       RowBox[{"if", " ", "argument", " ", "is", " ", "real", " ", "and"}], 
       " ", ">", " ", "1"}]}], ",", " ", 
     RowBox[{
     "then", " ", "we", " ", "have", " ", "problems", " ", "because", " ", 
      "of", " ", "the", " ", 
      RowBox[{"branchcut", ".", " ", "Fix"}], " ", "that", " ", "somehow", " ",
       "or", " ", "at", " ", "least", " ", "show", " ", 
      RowBox[{"warnings", ".", " ", "Also"}], " ", "do", " ", "this", " ", 
      "for", " ", "Li2", " ", "and", " ", "ImLi2"}]}], " ", 
    "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9503450225874557`*^9, 3.950345353113199*^9}, {
   3.9503453971794815`*^9, 3.950345405087286*^9}, 3.950345478312889*^9, {
   3.9503456003314705`*^9, 3.9503456450141335`*^9}, {3.950345860874365*^9, 
   3.9503459017248096`*^9}, {3.950345973043913*^9, 3.95034598749922*^9}, {
   3.9503461041832485`*^9, 3.9503461047780647`*^9}, {3.9504388312684155`*^9, 
   3.950438873332857*^9}, {3.9506722200280533`*^9, 3.9506723224274483`*^9}, {
   3.950672366415943*^9, 3.950672372311058*^9}, {3.9506724604047527`*^9, 
   3.9506724736017723`*^9}, {3.9506725036350193`*^9, 3.950672630964403*^9}, {
   3.9506727145843163`*^9, 3.9506727351685734`*^9}, {3.9506737932818413`*^9, 
   3.950673795610428*^9}, {3.950673835777508*^9, 3.9506738525779457`*^9}, {
   3.9506742244604244`*^9, 3.9506742746283035`*^9}, {3.950674327502638*^9, 
   3.9506743338314514`*^9}, {3.95068590369137*^9, 3.9506859160672054`*^9}, {
   3.950685952665148*^9, 3.950685990606079*^9}, 3.950686022515049*^9, {
   3.950686066660202*^9, 3.950686069441847*^9}, {3.9506861076170425`*^9, 
   3.9506861760291996`*^9}, {3.9595709851807213`*^9, 3.9595709855414505`*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"6dc62752-1985-0a40-a246-f849ad866a40"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ImLi2", "Subsubsection",
 CellChangeTimes->{{3.9506114617858315`*^9, 
  3.9506114623954105`*^9}},ExpressionUUID->"fb3acb0f-5735-c245-8803-\
5aa15c7996a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sImLi2", "[", 
     RowBox[{"z_", "/;", 
      RowBox[{"z", "===", 
       RowBox[{"Conj", "[", "z", "]"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"sImLi2", "[", "z", "]"}], "=", "0"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"NOTE", ":", " ", 
     RowBox[{
      RowBox[{"For", " ", "z"}], ">", "1"}]}], ",", " ", 
    RowBox[{
    "this", " ", "does", " ", "not", " ", "hold", " ", "numerically", " ", 
     "because", " ", "there", " ", "is", " ", "the", " ", 
     RowBox[{"Branchcut", ".", " ", 
      RowBox[{"TODO", ":", " ", 
       RowBox[{"fix", " ", "this"}]}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sImLi2", "[", "z_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"sImLi2", "[", 
       RowBox[{"1", "-", "z"}], "]"}], "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"ImLi2", "[", "z", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", "\[ImaginaryI]"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"logTermsOneMinusZ", "[", "z", "]"}], "-", 
          RowBox[{"logTermsOneMinusZ", "[", 
           RowBox[{"Conj", "@", "z"}], "]"}]}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sImLi2", "[", 
       RowBox[{"Conj", "[", 
        RowBox[{"1", "-", "z"}], "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"sImLi2", "[", 
        RowBox[{"1", "-", "z"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sImLi2", "[", 
       FractionBox["1", "z"], "]"}], "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"ImLi2", "[", "z", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", "\[ImaginaryI]"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"logTermsOneOverZ", "[", "z", "]"}], "-", 
          RowBox[{"logTermsOneOverZ", "[", 
           RowBox[{"Conj", "@", "z"}], "]"}]}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sImLi2", "[", 
       RowBox[{"Conj", "[", 
        FractionBox["1", "z"], "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"sImLi2", "[", 
        FractionBox["1", "z"], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sImLi2", "[", 
       FractionBox["1", 
        RowBox[{"1", "-", "z"}]], "]"}], "=", 
      RowBox[{
       RowBox[{"ImLi2", "[", "z", "]"}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", "\[ImaginaryI]"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"logTermsOneOverOneMinusZ", "[", "z", "]"}], "-", 
          RowBox[{"logTermsOneOverOneMinusZ", "[", 
           RowBox[{"Conj", "@", "z"}], "]"}]}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sImLi2", "[", 
       RowBox[{"Conj", "[", 
        FractionBox["1", 
         RowBox[{"1", "-", "z"}]], "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"sImLi2", "[", 
        FractionBox["1", 
         RowBox[{"1", "-", "z"}]], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sImLi2", "[", 
       RowBox[{"1", "-", 
        FractionBox["1", "z"]}], "]"}], "=", 
      RowBox[{
       RowBox[{"ImLi2", "[", "z", "]"}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", "\[ImaginaryI]"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"logTermsOneMinusOneOverZ", "[", "z", "]"}], "-", 
          RowBox[{"logTermsOneMinusOneOverZ", "[", 
           RowBox[{"Conj", "@", "z"}], "]"}]}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sImLi2", "[", 
       RowBox[{"Conj", "[", 
        RowBox[{"1", "-", 
         FractionBox["1", "z"]}], "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"sImLi2", "[", 
        RowBox[{"1", "-", 
         FractionBox["1", "z"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sImLi2", "[", 
       FractionBox["z", 
        RowBox[{"z", "-", "1"}]], "]"}], "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"ImLi2", "[", "z", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", "\[ImaginaryI]"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"logTermsZOverZMinusOne", "[", "z", "]"}], "-", 
          RowBox[{"logTermsZOverZMinusOne", "[", 
           RowBox[{"Conj", "@", "z"}], "]"}]}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sImLi2", "[", 
       RowBox[{"Conj", "[", 
        FractionBox["z", 
         RowBox[{"z", "-", "1"}]], "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"sImLi2", "[", 
        FractionBox["z", 
         RowBox[{"z", "-", "1"}]], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sImLi2", "[", 
       RowBox[{"Conj", "[", "z", "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"ImLi2", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sImLi2", "[", "z", "]"}], "=", 
      RowBox[{"ImLi2", "[", "z", "]"}]}]}], "\[IndentingNewLine]", ")"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9503450225874557`*^9, 3.950345353113199*^9}, {
   3.9503453971794815`*^9, 3.950345405087286*^9}, 3.950345478312889*^9, {
   3.9503456003314705`*^9, 3.9503456450141335`*^9}, {3.950345860874365*^9, 
   3.9503459017248096`*^9}, {3.950345973043913*^9, 3.95034598749922*^9}, {
   3.9503461041832485`*^9, 3.9503461047780647`*^9}, {3.9503463656975975`*^9, 
   3.950346484170595*^9}, {3.95034685799753*^9, 3.950346858153776*^9}, {
   3.9503490572414513`*^9, 3.950349060585413*^9}, {3.950352771012102*^9, 
   3.9503527794355373`*^9}, {3.9506136760382023`*^9, 3.950613712856043*^9}, {
   3.9506138466652145`*^9, 3.950613872073578*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"9d2c9292-622c-a34a-8c66-da47391378e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["D2", "Subsubsection",
 CellChangeTimes->{{3.9506126326019306`*^9, 
  3.9506126328524265`*^9}},ExpressionUUID->"387454de-a443-5648-a13c-\
ebe8646a0e0b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sD2", "[", 
    RowBox[{"z_", "/;", 
     RowBox[{"z", "===", 
      RowBox[{"Conj", "[", "z", "]"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"sD2", "[", "z", "]"}], "=", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sD2", "[", "z_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"sD2", "[", 
       RowBox[{"1", "-", "z"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"D2", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sD2", "[", 
       RowBox[{"Conj", "[", 
        RowBox[{"1", "-", "z"}], "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"sD2", "[", 
        RowBox[{"1", "-", "z"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sD2", "[", 
       FractionBox["1", "z"], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"D2", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sD2", "[", 
       RowBox[{"Conj", "[", 
        FractionBox["1", "z"], "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"sD2", "[", 
        FractionBox["1", "z"], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sD2", "[", 
       FractionBox["1", 
        RowBox[{"1", "-", "z"}]], "]"}], "=", 
      RowBox[{"D2", "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sD2", "[", 
       RowBox[{"Conj", "[", 
        FractionBox["1", 
         RowBox[{"1", "-", "z"}]], "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"sD2", "[", 
        FractionBox["1", 
         RowBox[{"1", "-", "z"}]], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sD2", "[", 
       RowBox[{"1", "-", 
        FractionBox["1", "z"]}], "]"}], "=", 
      RowBox[{"D2", "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sD2", "[", 
       RowBox[{"Conj", "[", 
        RowBox[{"1", "-", 
         FractionBox["1", "z"]}], "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"sD2", "[", 
        RowBox[{"1", "-", 
         FractionBox["1", "z"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sD2", "[", 
       FractionBox["z", 
        RowBox[{"z", "-", "1"}]], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"D2", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sD2", "[", 
       RowBox[{"Conj", "[", 
        FractionBox["z", 
         RowBox[{"z", "-", "1"}]], "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"sD2", "[", 
        FractionBox["z", 
         RowBox[{"z", "-", "1"}]], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sD2", "[", 
       RowBox[{"Conj", "[", "z", "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"D2", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sD2", "[", "z", "]"}], "=", 
      RowBox[{"D2", "[", "z", "]"}]}]}], "\[IndentingNewLine]", ")"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9503450225874557`*^9, 3.950345353113199*^9}, {
   3.9503453971794815`*^9, 3.950345405087286*^9}, 3.950345478312889*^9, {
   3.9503456003314705`*^9, 3.9503456450141335`*^9}, {3.950345860874365*^9, 
   3.9503459017248096`*^9}, {3.950345973043913*^9, 3.95034598749922*^9}, {
   3.9503461041832485`*^9, 3.9503461047780647`*^9}, {3.9503463656975975`*^9, 
   3.950346484170595*^9}, {3.95034685799753*^9, 3.950346858153776*^9}, {
   3.9503490572414513`*^9, 3.950349060585413*^9}, {3.950352771012102*^9, 
   3.9503527794355373`*^9}, {3.950612645312187*^9, 3.9506127181698265`*^9}, 
   3.9506129823617573`*^9, {3.950613497680004*^9, 3.9506135280105495`*^9}, {
   3.950613578358782*^9, 3.9506135822809258`*^9}, 3.950613624502678*^9, {
   3.950685156565428*^9, 3.950685159659382*^9}, {3.9506852674470596`*^9, 
   3.95068528613682*^9}, 3.9580069132210407`*^9},
 CellLabel->"In[91]:=",ExpressionUUID->"0cc5bd88-b41a-b544-951a-2e1d74369bc3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["D2NoConj", "Subsubsection",
 CellChangeTimes->{{3.9580068958097897`*^9, 
  3.958006904185688*^9}},ExpressionUUID->"b0606d41-f776-1e44-9131-\
31f89d4025ea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sD2NoConj", "[", "0", "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sD2NoConj", "[", "1", "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sD2NoConj", "[", "z_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"sD2NoConj", "[", 
       RowBox[{"1", "-", "z"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"D2", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sD2NoConj", "[", 
       FractionBox["1", "z"], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"D2", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sD2NoConj", "[", 
       FractionBox["1", 
        RowBox[{"1", "-", "z"}]], "]"}], "=", 
      RowBox[{"D2", "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sD2NoConj", "[", 
       RowBox[{"1", "-", 
        FractionBox["1", "z"]}], "]"}], "=", 
      RowBox[{"D2", "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sD2NoConj", "[", 
       FractionBox["z", 
        RowBox[{"z", "-", "1"}]], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"D2", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sD2NoConj", "[", "z", "]"}], "=", 
      RowBox[{"D2", "[", "z", "]"}]}]}], "\[IndentingNewLine]", ")"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9580069209040794`*^9, 3.9580069577519894`*^9}, {
  3.95800797337982*^9, 3.9580079922624016`*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"d6274936-2223-0545-85d7-7b5fa6a8bdf3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Li3 & Error terms", "Subsubsection",
 CellChangeTimes->{{3.950611405650923*^9, 3.9506114134013577`*^9}, {
  3.955787580269665*^9, 
  3.9557875803634205`*^9}},ExpressionUUID->"06d342bd-d248-d845-a809-\
6eb20598c79a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"sLi3", "[", "z_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"sLi3", "[", 
       FractionBox["1", "z"], "]"}], "=", 
      RowBox[{
       RowBox[{"Li3", "[", "z", "]"}], "+", 
       RowBox[{"logTermsOneOverZLi3", "[", "z", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sLi3", "[", "z", "]"}], " ", "=", 
      RowBox[{"Li3", "[", "z", "]"}]}]}], ")"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9506113761106396`*^9, 3.9506113805973625`*^9}, {
  3.950672840442459*^9, 3.950672877180094*^9}, {3.9557875918612537`*^9, 
  3.955787593470627*^9}, {3.9557876371654377`*^9, 3.9557877302710648`*^9}, {
  3.955787832387642*^9, 3.9557878477840004`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"cf444c5a-8e83-554c-8860-4d9f86c5b4a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ReLi3", "Subsubsection",
 CellChangeTimes->{{3.9506114318261127`*^9, 3.9506114343444633`*^9}, {
  3.9557875822425175`*^9, 
  3.955787582322201*^9}},ExpressionUUID->"9eac3796-c032-7743-81d9-\
c9212e8d87ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"sReLi3", "[", "z_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"sReLi3", "[", 
       FractionBox["1", "z"], "]"}], "=", 
      RowBox[{
       RowBox[{"sReLi3", "[", 
        RowBox[{"Conj", "[", 
         FractionBox["1", "z"], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"ReLi3", "[", "z", "]"}], "+", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"logTermsOneOverZLi3", "[", "z", "]"}], "+", 
           RowBox[{"logTermsOneOverZLi3", "[", 
            RowBox[{"Conj", "@", "z"}], "]"}]}], ")"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sReLi3", "[", "z", "]"}], "=", 
      RowBox[{
       RowBox[{"sReLi3", "[", 
        RowBox[{"Conj", "[", "z", "]"}], "]"}], "=", 
       RowBox[{"ReLi3", "[", "z", "]"}]}]}]}], "\[IndentingNewLine]", ")"}]}],
   ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9503450225874557`*^9, 3.950345353113199*^9}, {
   3.9503453971794815`*^9, 3.950345405087286*^9}, 3.950345478312889*^9, {
   3.9503456003314705`*^9, 3.9503456450141335`*^9}, {3.950345860874365*^9, 
   3.9503459017248096`*^9}, {3.950345973043913*^9, 3.95034598749922*^9}, {
   3.9503461041832485`*^9, 3.9503461047780647`*^9}, {3.9504388312684155`*^9, 
   3.950438873332857*^9}, {3.9506722200280533`*^9, 3.9506723224274483`*^9}, {
   3.950672366415943*^9, 3.950672372311058*^9}, {3.9506724604047527`*^9, 
   3.9506724736017723`*^9}, {3.9506725036350193`*^9, 3.950672630964403*^9}, {
   3.9506727145843163`*^9, 3.9506727351685734`*^9}, {3.9506737932818413`*^9, 
   3.950673795610428*^9}, {3.950673835777508*^9, 3.9506738525779457`*^9}, {
   3.9506742244604244`*^9, 3.9506742746283035`*^9}, {3.950674327502638*^9, 
   3.9506743338314514`*^9}, {3.95068590369137*^9, 3.9506859160672054`*^9}, {
   3.950685952665148*^9, 3.950685990606079*^9}, 3.950686022515049*^9, {
   3.950686066660202*^9, 3.950686069441847*^9}, {3.9506861076170425`*^9, 
   3.9506861760291996`*^9}, {3.9557880388262424`*^9, 3.955788105300886*^9}, {
   3.9557881373122616`*^9, 3.955788164365877*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"bc708365-0a52-0a4b-aa12-be6ffc1b6509"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ImLi3", "Subsubsection",
 CellChangeTimes->{{3.9506114617858315`*^9, 3.9506114623954105`*^9}, {
  3.9557875844212*^9, 
  3.9557875845003376`*^9}},ExpressionUUID->"f4996ee1-316b-5841-81f3-\
fb84bbee31f4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sImLi3", "[", 
     RowBox[{"z_", "/;", 
      RowBox[{"z", "===", 
       RowBox[{"Conj", "[", "z", "]"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"sImLi3", "[", "z", "]"}], "=", "0"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"NOTE", ":", " ", 
     RowBox[{
      RowBox[{"For", " ", "z"}], ">", "1"}]}], ",", " ", 
    RowBox[{
    "this", " ", "does", " ", "not", " ", "hold", " ", "numerically", " ", 
     "because", " ", "there", " ", "is", " ", "the", " ", 
     RowBox[{"Branchcut", ".", " ", 
      RowBox[{"TODO", ":", " ", 
       RowBox[{"fix", " ", "this"}]}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sImLi3", "[", "z_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"sImLi3", "[", 
       FractionBox["1", "z"], "]"}], "=", 
      RowBox[{
       RowBox[{"ImLi3", "[", "z", "]"}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", "\[ImaginaryI]"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"logTermsOneOverZLi3", "[", "z", "]"}], "-", 
          RowBox[{"logTermsOneOverZLi3", "[", 
           RowBox[{"Conj", "@", "z"}], "]"}]}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sImLi3", "[", 
       RowBox[{"Conj", "[", 
        FractionBox["1", "z"], "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"sImLi3", "[", 
        FractionBox["1", "z"], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sImLi3", "[", 
       RowBox[{"Conj", "[", "z", "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{"ImLi3", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sImLi3", "[", "z", "]"}], "=", 
      RowBox[{"ImLi3", "[", "z", "]"}]}]}], "\[IndentingNewLine]", ")"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9503450225874557`*^9, 3.950345353113199*^9}, {
   3.9503453971794815`*^9, 3.950345405087286*^9}, 3.950345478312889*^9, {
   3.9503456003314705`*^9, 3.9503456450141335`*^9}, {3.950345860874365*^9, 
   3.9503459017248096`*^9}, {3.950345973043913*^9, 3.95034598749922*^9}, {
   3.9503461041832485`*^9, 3.9503461047780647`*^9}, {3.9503463656975975`*^9, 
   3.950346484170595*^9}, {3.95034685799753*^9, 3.950346858153776*^9}, {
   3.9503490572414513`*^9, 3.950349060585413*^9}, {3.950352771012102*^9, 
   3.9503527794355373`*^9}, {3.9506136760382023`*^9, 3.950613712856043*^9}, {
   3.9506138466652145`*^9, 3.950613872073578*^9}, {3.9557882285937824`*^9, 
   3.95578825440184*^9}, {3.9557882865696964`*^9, 3.9557883593230057`*^9}, {
   3.9557885083898697`*^9, 3.9557885085301*^9}, {3.955788656603771*^9, 
   3.955788668297592*^9}, {3.9557888180559063`*^9, 3.955788818418396*^9}, {
   3.9559461411990376`*^9, 3.9559461472492313`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"f1ed08d6-9e2f-c14d-9c0c-b27c3cee2d3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["D3", "Subsubsection",
 CellChangeTimes->{{3.9506126326019306`*^9, 3.9506126328524265`*^9}, {
  3.9557875864008713`*^9, 
  3.9557875865414906`*^9}},ExpressionUUID->"c6b7c884-3dd0-844e-b4a8-\
be629780767c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"sD3", "[", "z_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"sD3", "[", 
       FractionBox["1", "z"], "]"}], "=", 
      RowBox[{"D3", "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sD3", "[", 
       RowBox[{"Conj", "[", 
        FractionBox["1", "z"], "]"}], "]"}], "=", 
      RowBox[{"D3", "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sD3", "[", 
       RowBox[{"Conj", "[", "z", "]"}], "]"}], "=", 
      RowBox[{"D3", "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sD3", "[", "z", "]"}], "=", 
      RowBox[{"D3", "[", "z", "]"}]}]}], "\[IndentingNewLine]", ")"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9503450225874557`*^9, 3.950345353113199*^9}, {
   3.9503453971794815`*^9, 3.950345405087286*^9}, 3.950345478312889*^9, {
   3.9503456003314705`*^9, 3.9503456450141335`*^9}, {3.950345860874365*^9, 
   3.9503459017248096`*^9}, {3.950345973043913*^9, 3.95034598749922*^9}, {
   3.9503461041832485`*^9, 3.9503461047780647`*^9}, {3.9503463656975975`*^9, 
   3.950346484170595*^9}, {3.95034685799753*^9, 3.950346858153776*^9}, {
   3.9503490572414513`*^9, 3.950349060585413*^9}, {3.950352771012102*^9, 
   3.9503527794355373`*^9}, {3.950612645312187*^9, 3.9506127181698265`*^9}, 
   3.9506129823617573`*^9, {3.950613497680004*^9, 3.9506135280105495`*^9}, {
   3.950613578358782*^9, 3.9506135822809258`*^9}, 3.950613624502678*^9, {
   3.950685156565428*^9, 3.950685159659382*^9}, {3.9506852674470596`*^9, 
   3.95068528613682*^9}, {3.955788830753771*^9, 3.9557889108378468`*^9}, {
   3.955941943478462*^9, 3.9559419442951736`*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"3bcce977-5067-074e-9591-798e650f1cbb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute the Log terms", "Subsubsection",
 CellChangeTimes->{{3.9557877384299145`*^9, 
  3.955787752220598*^9}},ExpressionUUID->"01b81429-91da-ec49-85ae-\
41ce08bae83b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Compute", " ", "the", " ", "logarithmic", " ", "error", " ", 
    RowBox[{"terms", ".", " ", 
     RowBox[{"NOTE", ":", " ", 
      RowBox[{
      "Not", " ", "all", " ", "cases", " ", "have", " ", "been", " ", 
       "checked", " ", 
       RowBox[{"numerically", "."}]}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"For", " ", "the", " ", 
      RowBox[{"Li2", "[", "z", "]"}]}], "->", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Li2", "[", 
          FractionBox["1", "z"], "]"}]}], " ", "+"}], " ", "..."}], " ", 
      "rule"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "there", " ", "is", " ", "a", " ", "branchcut", " ", "if", " ", "0"}], 
     " ", "<=", " ", "z", " ", "<=", " ", "1."}]}], " ", "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ruleOneOverZ", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Li2", "[", "b_", "]"}], "/;", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{"!", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", "==", 
              RowBox[{"Conj", "[", "b", "]"}]}], "&&", 
             RowBox[{"0", "<=", 
              RowBox[{"Re", "[", "b", "]"}], "<=", "1"}]}], ")"}]}], "]"}]}], 
        ":>", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Li2", "[", 
           FractionBox["1", "b"], "]"}]}], "-", 
         RowBox[{
          FractionBox["1", "2"], 
          SuperscriptBox[
           RowBox[{"Log", "[", 
            RowBox[{"-", "b"}], "]"}], "2"]}], "-", 
         FractionBox[
          SuperscriptBox["\[Pi]", "2"], "6"]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Li2", "[", "b_", "]"}], "/;", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", "b", "]"}], "==", "0"}], "&&", 
            RowBox[{"0", "<=", 
             RowBox[{"Re", "[", "b", "]"}], "<=", "1"}]}], ")"}], "]"}]}], ":>", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Li2", "[", 
           FractionBox["1", "b"], "]"}]}], "-", 
         RowBox[{
          FractionBox["1", "2"], 
          SuperscriptBox[
           RowBox[{"Log", "[", 
            RowBox[{"-", "b"}], "]"}], "2"]}], "-", 
         FractionBox[
          SuperscriptBox["\[Pi]", "2"], "6"], "+", 
         RowBox[{"2", "\[ImaginaryI]", " ", "\[Pi]", " ", 
          RowBox[{"Log", "[", "b", "]"}]}]}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ruleMinusOne", "=", 
     RowBox[{
      RowBox[{"Li2", "[", "b_", "]"}], ":>", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Li2", "[", 
         RowBox[{"1", "-", "b"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", "b"}], "]"}], 
        RowBox[{"Log", "[", "b", "]"}]}], "+", 
       FractionBox[
        SuperscriptBox["\[Pi]", "2"], "6"]}]}]}], ";"}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"logTermsOneMinusZ", "[", "z_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Li2", "[", "z", "]"}], "/.", "ruleMinusOne"}], ")"}], " ", "+",
       " ", 
      RowBox[{"Li2", "[", 
       RowBox[{"1", "-", "z"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"logTermsOneOverZ", "[", "z_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Li2", "[", "z", "]"}], "/.", "ruleOneOverZ"}], ")"}], " ", "+",
       " ", 
      RowBox[{"Li2", "[", 
       FractionBox["1", "z"], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"logTermsOneOverOneMinusZ", "[", "z_", "]"}], ":=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Li2", "[", "z", "]"}], "/.", "ruleMinusOne"}], "/.", 
         "ruleOneOverZ"}], ")"}]}], " ", "+", " ", 
      RowBox[{"Li2", "[", 
       FractionBox["1", 
        RowBox[{"1", "-", "z"}]], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"logTermsOneMinusOneOverZ", "[", "z_", "]"}], ":=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Li2", "[", "z", "]"}], "/.", "ruleOneOverZ"}], "/.", 
         "ruleMinusOne"}], ")"}]}], " ", "+", " ", 
      RowBox[{"Li2", "[", 
       RowBox[{"1", "-", 
        FractionBox["1", "z"]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"logTermsZOverZMinusOne", "[", "z_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Li2", "[", "z", "]"}], "/.", "ruleOneOverZ"}], "/.", 
         "ruleMinusOne"}], "/.", "ruleOneOverZ"}], ")"}], " ", "+", " ", 
      RowBox[{"Li2", "[", 
       FractionBox["z", 
        RowBox[{"z", "-", "1"}]], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"logTermsOneOverZLi3", "[", "z_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", "6"], 
        SuperscriptBox[
         RowBox[{"Log", "[", 
          RowBox[{"-", "z"}], "]"}], "3"]}], "+", 
       RowBox[{
        FractionBox[
         SuperscriptBox["\[Pi]", "2"], "6"], 
        RowBox[{"Log", "[", 
         RowBox[{"-", "z"}], "]"}]}]}], "/;", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"z", "==", 
           RowBox[{"Conj", "[", "z", "]"}]}], "&&", 
          RowBox[{"0", "<=", 
           RowBox[{"Re", "[", "z", "]"}], "<=", "1"}]}], ")"}]}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9557878085515957`*^9, 3.95578782308123*^9}, {
  3.955787893581337*^9, 3.955787917832615*^9}, {3.9557879829827976`*^9, 
  3.955788009628044*^9}, {3.9559380983363934`*^9, 3.955938124993841*^9}, {
  3.959571039956972*^9, 3.959571111079653*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"413e801c-0326-d245-8031-ecabb0ebc91e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Log Simplify", "Subsection",
 CellChangeTimes->{{3.958009232806095*^9, 3.958009237526966*^9}, {
  3.9595713606459045`*^9, 
  3.9595713866390495`*^9}},ExpressionUUID->"5a626d2d-9e3b-6e42-bc4f-\
a22d7350c5b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LogSimplifySumRule", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"a_.", 
        RowBox[{"Log", "[", "b_", "]"}]}], "+", 
       RowBox[{"c_.", 
        RowBox[{"Log", "[", "d_", "]"}]}]}], "/;", 
      RowBox[{
       RowBox[{"Im", "[", "a", "]"}], "===", 
       RowBox[{"Im", "[", "c", "]"}], "===", "0"}]}], ":>", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{
        SuperscriptBox["b", "a"], 
        SuperscriptBox["d", "c"]}], "]"}], "+", "  ", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"Log", "[", "b", "]"}]}], "+", 
         RowBox[{"c", " ", 
          RowBox[{"Log", "[", "d", "]"}]}], "-", 
         RowBox[{"Log", "[", 
          RowBox[{
           SuperscriptBox["b", "a"], 
           SuperscriptBox["d", "c"]}], "]"}]}], ",", 
        RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]"}]}], "]"}]}]}]}], ";"}], 
  " ", 
  RowBox[{"(*", " ", 
   RowBox[{"This", " ", "correctly", " ", "handles", " ", "the", " ", 
    RowBox[{"branchcut", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"simplifyLinearComboOfLogs", "[", "expr_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FreeQ", "[", 
       RowBox[{"expr", ",", 
        RowBox[{"Log", "[", "_", "]"}]}], "]"}], ",", "expr", ",", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"gcd", "=", 
          RowBox[{"GCD", "@@", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Expand", "@", "expr"}], ",", 
             RowBox[{
              RowBox[{"a_.", 
               RowBox[{"Log", "[", "b_", "]"}]}], ":>", "a"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}]}], "}"}], ",", 
        RowBox[{"gcd", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Expand", "[", 
            FractionBox["expr", "gcd"], "]"}], "//.", "LogSimplifySumRule"}], 
          ")"}]}]}], "]"}]}], "]"}]}], ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"selectLogPart", "[", "expr_", "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{"expr", ",", 
     RowBox[{"MatchQ", "[", 
      RowBox[{"a_.", 
       RowBox[{"Log", "[", "_", "]"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"realPrefators", "[", "expr_", "]"}], ":=", 
   RowBox[{"expr", " ", "/.", " ", 
    RowBox[{
     RowBox[{"a_.", 
      RowBox[{"Log", "[", "b_", "]"}]}], ":>", 
     RowBox[{
      RowBox[{"Re", "[", "a", "]"}], 
      RowBox[{"Log", "[", "b", "]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"imagPrefators", "[", "expr_", "]"}], ":=", 
    RowBox[{"expr", " ", "/.", " ", 
     RowBox[{
      RowBox[{"a_.", 
       RowBox[{"Log", "[", "b_", "]"}]}], ":>", 
      RowBox[{
       RowBox[{"Im", "[", "a", "]"}], 
       RowBox[{"Log", "[", "b", "]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
       "This", " ", "function", " ", "returns", " ", "True", " ", "if", " ", 
        "an", " ", "epxression", " ", "of", " ", "the", " ", "form", " ", "a",
         " ", "\[Pi]"}], " ", "+", " ", 
       RowBox[{"b_", "1", 
        RowBox[{"Log", "[", 
         RowBox[{"z_", "1"}], "]"}]}], "+"}], " ", "..."}], " ", "+", " ", 
     RowBox[{
      RowBox[{"b_nLog", "[", "z_n", "]"}], " ", "equals", " ", "zero"}]}], ",",
     " ", 
    RowBox[{"where", " ", "a", " ", "and", " ", 
     SubscriptBox["b", "i"], " ", "have", " ", "rational", " ", "real", " ", 
     "and", " ", "imaginary", " ", 
     RowBox[{"part", ".", " ", "We"}], " ", "make", " ", "use", " ", "of", " ",
      "the", " ", "function", " ", "simplifyLinearComboOfLogs"}], ",", " ", 
    RowBox[{
    "which", " ", "was", " ", "defined", " ", "in", " ", "the", " ", 
     "subsection", " ", 
     RowBox[{"\"\<Converting Li2 to D2i\>\"", "."}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"linearComboOfLogZeroQ", "[", "expr_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"logPart", "=", 
         RowBox[{"selectLogPart", "[", "expr", "]"}]}], ",", " ", 
        "numberPart"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"numberPart", " ", "=", " ", 
        RowBox[{
         RowBox[{"expr", "-", "logPart"}], "//", "Expand"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"simplifyLinearComboOfLogs", "[", 
           RowBox[{"realPrefators", "[", "logPart", "]"}], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"simplifyLinearComboOfLogs", "[", 
            RowBox[{"imagPrefators", "[", "logPart", "]"}], "]"}]}], "+", 
          "numberPart"}], "==", "0"}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getRidOfOneLogArgument", "::", "couldnotprove"}], 
   "=", "\"\<The relation `1` could not be proven to be zero. Either the \
relation is not true or the simplification methods are not strong \
enough.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getRidOfOneLogArgument", "[", "expr_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "logTally", ",", " ", "rel", ",", "relExpr", ",", " ", "relPos", ",", 
        "leastCommonLog", ",", " ", "logToReplace", ",", "logPrefactor", ",", 
        " ", "rule"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"logTally", " ", "=", " ", 
        RowBox[{"Tally", "@", 
         RowBox[{"Cases", "[", 
          RowBox[{"expr", ",", 
           RowBox[{"Log", "[", "_", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "logTally"}], "==", "0"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"expr", ",", "Module"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rel", " ", "=", " ", 
        RowBox[{"Quiet", "[", 
         RowBox[{"FindIntegerNullVector", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"logTally", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "}"}]}], "]"}], "]"}], 
         "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "FindIntegerNullVector", " ", "gives", " ", "a", " ", "warning", " ",
           "message", " ", "if", " ", "it", " ", "cannot", " ", "decide", " ",
           "if", " ", "the", " ", "relation", " ", "is", " ", "actually", " ", 
          RowBox[{"true", ".", " ", "We"}], " ", "do", " ", "not", " ", 
          "rely", " ", "on", " ", "the", " ", "fact", " ", "that", " ", "the",
           " ", "relation", " ", "is", " ", "actually", " ", "correct"}], ",",
          " ", 
         RowBox[{
         "because", " ", "we", " ", "use", " ", "linearComboOfLogQ", " ", 
          "to", " ", "prove", " ", "that", " ", "it", " ", "is", " ", 
          RowBox[{"true", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "check", " ", "that", " ", "a", " ", "relation", " ", "has", " ", 
         "been", " ", 
         RowBox[{"found", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "rel", "]"}], "===", "FindIntegerNullVector"}],
          ",", "  ", 
         RowBox[{"Return", "[", 
          RowBox[{"expr", ",", " ", "Module"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"relExpr", " ", "=", " ", 
        RowBox[{"rel", ".", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"logTally", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"linearComboOfLogZeroQ", "[", "relExpr", "]"}], "=!=", " ", 
          "True"}], ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"getRidOfOneLogArgument", "::", "couldnotprove"}], ",", 
            "relExpr"}], "]"}], ";", " ", 
          RowBox[{"Return", "[", 
           RowBox[{"expr", ",", "Module"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"relPos", " ", "=", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"rel", "[", 
            RowBox[{"[", 
             RowBox[{";;", 
              RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
           RowBox[{"Except", "[", "0", "]"}], ",", "1", ",", 
           RowBox[{"Heads", "->", "False"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"leastCommonLog", " ", "=", " ", 
        RowBox[{"Min", "[", 
         RowBox[{"logTally", "[", 
          RowBox[{"[", 
           RowBox[{"relPos", ",", "2"}], "]"}], "]"}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "We", " ", "use", " ", "the", " ", "relation", " ", "to", " ", 
          "replace", " ", "the", " ", "log", " ", "that", " ", "appears", " ",
           "least", " ", 
          RowBox[{"often", ".", " ", "This"}], " ", "is", " ", "not", " ", 
          "crucial", " ", "for", " ", "the", " ", "routine"}], ",", " ", 
         RowBox[{
         "but", " ", "it", " ", "helps", " ", "to", " ", "avoid", " ", 
          "getting", " ", "very", " ", "long", " ", 
          RowBox[{"expression", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"logToReplace", " ", "=", " ", 
        RowBox[{"First", "@", 
         RowBox[{"First", "@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"logTally", "[", 
             RowBox[{"[", "relPos", "]"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "===", "leastCommonLog"}], 
             "&"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"logPrefactor", "=", 
        RowBox[{"Coefficient", "[", 
         RowBox[{"relExpr", ",", "logToReplace"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rule", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"logToReplace", " ", "->", " ", 
          RowBox[{"logToReplace", "-", 
           RowBox[{"Expand", "[", 
            FractionBox["relExpr", "logPrefactor"], "]"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Expand", "[", 
        RowBox[{"expr", "/.", "rule"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"LogSimplify", "[", "expr_", "]"}], ":=", " ", 
     RowBox[{"FixedPoint", "[", 
      RowBox[{"getRidOfOneLogArgument", ",", "expr"}], "]"}]}], ";"}], " ", 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logsRemaining", "[", "expr_", "]"}], ":=", 
   RowBox[{"Length", "@", 
    RowBox[{"Union", "@", 
     RowBox[{"Cases", "[", 
      RowBox[{"expr", ",", 
       RowBox[{
        RowBox[{"Log", "[", "a_", "]"}], ":>", "a"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LogSimplify", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"temp", ",", " ", "result"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"temp", "=", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<Different logs remaining: \>\"", ",", 
         RowBox[{"logsRemaining", "[", "expr", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"FixedPoint", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"NotebookDelete", "[", "temp", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"temp", "=", 
            RowBox[{"PrintTemporary", "[", 
             RowBox[{"\"\<Different logs remaining: \>\"", ",", 
              RowBox[{"logsRemaining", "[", "#", "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"getRidOfOneLogArgument", "[", "#", "]"}]}], "]"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "expr", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"logsRemaining", "[", "expr", "]"}], "+", "1"}]}], " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "is", " ", "an", " ", "upper", " ", "bound", " ", "for", " ", "the", 
          " ", "number", " ", "of", " ", "iterations"}], "*)"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"NotebookDelete", "[", "temp", "]"}], ";", 
      "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9595715388860703`*^9, 3.959571540076069*^9}, {
  3.959571603136776*^9, 3.959571662546524*^9}, {3.959571737143545*^9, 
  3.959571884177183*^9}, {3.959571934512268*^9, 3.959571977204376*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"3bc2055d-7d9c-664a-966a-5ab634a0bd06"]
}, Closed]],

Cell[CellGroupData[{

Cell["Preprocessing Polylogarithms", "Subsection",
 CellChangeTimes->{{3.95061147813113*^9, 3.9506114817881966`*^9}, {
  3.955794756441885*^9, 3.955794757849203*^9}, {3.9595725862468643`*^9, 
  3.9595726280498447`*^9}},ExpressionUUID->"7b87b7ee-7377-7244-b124-\
d50f40a371fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"convertImLi2toD2", "[", "expr_", "]"}], ":=", 
   RowBox[{"expr", "/.", 
    RowBox[{
     RowBox[{"ImLi2", "[", "z_", "]"}], ":>", 
     RowBox[{
      RowBox[{"sD2", "[", "z", "]"}], "-", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"Log", "[", 
        RowBox[{"z", "*", 
         RowBox[{"Conj", "[", "z", "]"}]}], "]"}], "*", 
       FractionBox[
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"1", "-", "z"}], "]"}], "-", 
         RowBox[{"Log", "[", 
          RowBox[{"1", "-", 
           RowBox[{"Conj", "[", "z", "]"}]}], "]"}]}], 
        RowBox[{"2", "\[ImaginaryI]"}]]}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"convertReLi3toD3", "[", "expr_", "]"}], ":=", 
   RowBox[{"expr", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"ReLi3", "[", "1", "]"}], ":>", 
       RowBox[{"sD3", "[", "1", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ReLi3", "[", "z_", "]"}], ":>", 
       RowBox[{
        RowBox[{"sD3", "[", "z", "]"}], "+", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"Log", "[", 
          RowBox[{"z", "*", 
           RowBox[{"Conj", "[", "z", "]"}]}], "]"}], 
         RowBox[{"sReLi2", "[", "z", "]"}]}], "+", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"Log", "[", 
            RowBox[{"1", "-", "z"}], "]"}], "+", 
           RowBox[{"Log", "[", 
            RowBox[{"1", "-", 
             RowBox[{"Conj", "[", "z", "]"}]}], "]"}]}], "24"], 
         SuperscriptBox[
          RowBox[{"Log", "[", 
           RowBox[{"z", " ", "*", 
            RowBox[{"Conj", "[", "z", "]"}]}], "]"}], "2"]}]}]}]}], "}"}]}]}],
   ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.955794929725363*^9, 3.9557949301170273`*^9}, {
   3.9557949646927032`*^9, 3.9557953040859356`*^9}, {3.955795477062559*^9, 
   3.9557954954537907`*^9}, {3.9557956582427635`*^9, 
   3.9557958060457783`*^9}, {3.9559356548782635`*^9, 
   3.9559356688835793`*^9}, {3.955935913364113*^9, 3.955935913645775*^9}, {
   3.9559362892382526`*^9, 3.9559362897542896`*^9}, {3.9595721605934925`*^9, 
   3.959572168479128*^9}, {3.959572202230198*^9, 3.959572226356928*^9}, 
   3.960001409657881*^9},ExpressionUUID->"7e717815-4ce6-2349-8964-\
3faf4b7f613e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"convertToLiWithNumberField", "[", 
    RowBox[{"expr_", ",", "numberFieldGenerator_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"TrigToExp", "[", "expr", "]"}], "/.", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Log", "[", "a_", "]"}], ":>", 
       RowBox[{"Log", "[", 
        RowBox[{"ToNumberField", "[", 
         RowBox[{"a", ",", "numberFieldGenerator"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PolyLog", "[", 
        RowBox[{"2", ",", "a_"}], "]"}], ":>", 
       RowBox[{"Li2", "[", 
        RowBox[{"ToNumberField", "[", 
         RowBox[{"a", ",", "numberFieldGenerator"}], "]"}], "]"}]}], ",", 
      RowBox[{"Catalan", ":>", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"Li2", "[", 
          RowBox[{"ToNumberField", "[", 
           RowBox[{"\[ImaginaryI]", ",", "numberFieldGenerator"}], "]"}], 
          "]"}]}], "-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", 
          SuperscriptBox["\[Pi]", "2"]}], "48"]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PolyLog", "[", 
        RowBox[{"3", ",", "a_"}], "]"}], ":>", 
       RowBox[{"Li3", "[", 
        RowBox[{"ToNumberField", "[", 
         RowBox[{"a", ",", "numberFieldGenerator"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Zeta", "[", "3", "]"}], ":>", 
       RowBox[{"Li3", "[", "1", "]"}]}]}], "\[IndentingNewLine]", "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PreprocessTrilogsAndDilogs", "[", 
    RowBox[{"expr_", ",", "numberFieldGenerator_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "newExpr", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "PrintTemporary", 
       "[", "\"\<Converting the arguments of the (Poly-)Logs to the number \
field (may take some time)...\>\"", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"newExpr", " ", "=", 
       RowBox[{"convertToLiWithNumberField", "[", 
        RowBox[{"expr", ",", "numberFieldGenerator"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "PrintTemporary", 
       "[", "\"\<Seperating the trilogs into real and imaginary part...\>\"", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"newExpr", " ", "=", 
       RowBox[{"newExpr", " ", "/.", " ", 
        RowBox[{
         RowBox[{"Li3", "[", "x_", "]"}], ":>", 
         RowBox[{
          RowBox[{"sReLi3", "[", "x", "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"sImLi3", "[", "x", "]"}]}]}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "PrintTemporary", 
       "[", "\"\<Convert ReLi3[z] to expression with D3[z]...\>\"", "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"newExpr", " ", "=", " ", 
       RowBox[{"convertReLi3toD3", "[", "newExpr", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "PrintTemporary", 
       "[", "\"\<Seperating the dilogs into real and imaginary part...\>\"", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"newExpr", " ", "=", " ", 
       RowBox[{"newExpr", "/.", 
        RowBox[{
         RowBox[{"Li2", "[", "x_", "]"}], ":>", 
         RowBox[{
          RowBox[{"sReLi2", "[", "x", "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"sImLi2", "[", "x", "]"}]}]}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "PrintTemporary", 
       "[", "\"\<Convert ImLi2[z] to expression with D2[z]...\>\"", "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"newExpr", " ", "=", " ", 
       RowBox[{"convertImLi2toD2", "[", "newExpr", "]"}]}], ";", 
      "\[IndentingNewLine]", "newExpr"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9559357053605976`*^9, 3.955935813345562*^9}, {
   3.955935843877249*^9, 3.9559358455807858`*^9}, {3.9559359080814342`*^9, 
   3.955935962966484*^9}, {3.955936110452936*^9, 3.9559364530108643`*^9}, 
   3.955936629622713*^9, 3.9559376466095314`*^9, {3.9559381788638573`*^9, 
   3.95593821366761*^9}, 3.9559401370491657`*^9, {3.955940523759592*^9, 
   3.955940563466053*^9}, {3.955940926143032*^9, 3.9559409357432384`*^9}, {
   3.9559419629456825`*^9, 3.955941963279228*^9}, {3.9559420962509937`*^9, 
   3.9559421835043163`*^9}, {3.9559427917097645`*^9, 3.9559428005936184`*^9}, 
   3.9559433231625767`*^9, {3.9559434380669384`*^9, 3.9559434447001705`*^9}, {
   3.9595720425730686`*^9, 3.959572049600767*^9}, {3.959572431336069*^9, 
   3.9595725148124485`*^9}, {3.9595725661514015`*^9, 
   3.9595725669498405`*^9}, {3.9595870557644157`*^9, 3.9595870645804195`*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"7293c372-41b3-bb4a-8382-150481a7215c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Functional Equations for Polylogarithms", "Subsection",
 CellChangeTimes->{{3.9506115051975307`*^9, 3.9506115091675777`*^9}, 
   3.9506116799785175`*^9, {3.959572654346966*^9, 
   3.9595726688390884`*^9}},ExpressionUUID->"3c87265b-ea57-1549-b66e-\
c23e11ee3767"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DuplicationRelationD2", "[", "z_", "]"}], ":=", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"D2", "[", "z", "]"}]}], "+", 
    RowBox[{"2", 
     RowBox[{"D2", "[", 
      RowBox[{"-", "z"}], "]"}]}], "-", 
    RowBox[{"D2", "[", 
     SuperscriptBox["z", "2"], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FiveTermRelationD2", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "===", "1"}], "||", 
       RowBox[{"y", "===", "1"}]}], ",", "Nothing", ",", 
      RowBox[{
       RowBox[{"D2", "[", "x", "]"}], "+", 
       RowBox[{"D2", "[", "y", "]"}], "-", 
       RowBox[{"D2", "[", 
        FractionBox["x", 
         RowBox[{"1", "-", "y"}]], "]"}], "-", 
       RowBox[{"D2", "[", 
        FractionBox["y", 
         RowBox[{"1", "-", "x"}]], "]"}], "+", 
       RowBox[{"D2", "[", 
        FractionBox[
         RowBox[{"x", " ", "y"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "x"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "y"}], ")"}]}]], "]"}]}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"I", " ", "recently", " ", "added", " ", "the", " ", "untested", " ", 
     RowBox[{"If", ".", " ", "But"}], " ", "should", " ", 
     RowBox[{"work", ".", " ", "Should"}], " ", "not", " ", "change", " ", 
     "anything"}], ",", " ", 
    RowBox[{"because", " ", 
     RowBox[{"D2", "[", 
      RowBox[{"real", " ", "number"}], "]"}], " ", "is", " ", "automatically",
      " ", "reduced", " ", "to", " ", "0."}]}], " ", "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9506830400633087`*^9, 3.950683070302685*^9}, {
  3.9506832365213547`*^9, 3.9506832446979237`*^9}, {3.9575992795374584`*^9, 
  3.957599329602049*^9}, {3.9576030081134567`*^9, 3.957603011504095*^9}, {
  3.9580064298725033`*^9, 3.9580064387695007`*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"7d8f8424-85f3-104a-9509-c29fe6f4cb66"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DuplicationRelationD3", "[", "z_", "]"}], ":=", 
    RowBox[{
     RowBox[{"4", " ", 
      RowBox[{"D3", "[", 
       RowBox[{"-", "z"}], "]"}]}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"D3", "[", "z", "]"}]}], "-", 
     RowBox[{"D3", "[", 
      SuperscriptBox["z", "2"], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "If", " ", "a", " ", "relation", " ", "does", " ", "not", " ", "apply", " ",
      "to", " ", "the", " ", "arguments", " ", "given", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"e", ".", "g", ".", " ", "because"}], " ", "that", " ", 
       "leads", " ", "to", " ", "division", " ", "by", " ", "zero"}], ")"}]}],
     ",", " ", 
    RowBox[{"the", " ", "relations", " ", "returns", " ", "Nothing"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NineTermRelationD3", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "===", "1"}], "||", 
      RowBox[{"y", "===", "1"}]}], ",", "Nothing", ",", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"D3", "[", "1", "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"D3", "[", "x", "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"D3", "[", 
        FractionBox[
         RowBox[{"1", "-", 
          FractionBox["1", "y"]}], 
         RowBox[{"1", "-", 
          FractionBox["1", "x"]}]], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"D3", "[", 
        FractionBox[
         RowBox[{"1", "-", 
          FractionBox["1", "y"]}], 
         RowBox[{"1", "-", "x"}]], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"D3", "[", 
        FractionBox[
         RowBox[{"1", "-", "y"}], 
         RowBox[{"1", "-", 
          FractionBox["1", "x"]}]], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"D3", "[", 
        FractionBox[
         RowBox[{"1", "-", "y"}], 
         RowBox[{"1", "-", "x"}]], "]"}]}], "+", 
      RowBox[{"D3", "[", 
       FractionBox["x", "y"], "]"}], "+", 
      RowBox[{"D3", "[", 
       FractionBox[
        RowBox[{"x", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "y"}], ")"}], "2"]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "x"}], ")"}], "2"], " ", "y"}]], "]"}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"D3", "[", "y", "]"}]}], "+", 
      RowBox[{"D3", "[", 
       RowBox[{"x", " ", "y"}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ThreeTermRelationD3", "[", "x_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "===", "1"}], ",", "Nothing", ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"D3", "[", "1", "]"}]}], "+", 
       RowBox[{"D3", "[", 
        RowBox[{"1", "-", 
         FractionBox["1", "x"]}], "]"}], "+", 
       RowBox[{"D3", "[", 
        RowBox[{"1", "-", "x"}], "]"}], "+", 
       RowBox[{"D3", "[", "x", "]"}]}]}], "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TwentyTwoTermRelationD3", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "=", 
        RowBox[{"1", "-", "c", "+", 
         RowBox[{"b", " ", "c"}]}]}], ",", " ", 
       RowBox[{"y", "=", 
        RowBox[{"1", "-", "a", "+", 
         RowBox[{"a", " ", "c"}]}]}], ",", 
       RowBox[{"z", "=", 
        RowBox[{"1", "-", "b", "+", 
         RowBox[{"a", " ", "b"}]}]}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "===", "0"}], "||", 
        RowBox[{"y", "===", "0"}], "||", 
        RowBox[{"z", "===", "0"}]}], ",", "Nothing", ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", 
         RowBox[{"D3", "[", "1", "]"}]}], "+", 
        RowBox[{"D3", "[", "a", "]"}], "+", 
        RowBox[{"D3", "[", "b", "]"}], "+", 
        RowBox[{"D3", "[", "c", "]"}], "+", 
        RowBox[{"D3", "[", 
         RowBox[{
          RowBox[{"-", "a"}], " ", "b", " ", "c"}], "]"}], "+", 
        RowBox[{"D3", "[", 
         FractionBox[
          RowBox[{"b", " ", "c"}], "x"], "]"}], "+", 
        RowBox[{"D3", "[", "x", "]"}], "-", 
        RowBox[{"D3", "[", 
         FractionBox["x", "b"], "]"}], "+", 
        RowBox[{"D3", "[", 
         FractionBox[
          RowBox[{"a", " ", "c"}], "y"], "]"}], "+", 
        RowBox[{"D3", "[", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"a", " ", "x"}], "y"]}], "]"}], "+", 
        RowBox[{"D3", "[", 
         FractionBox["x", 
          RowBox[{"b", " ", "y"}]], "]"}], "-", 
        RowBox[{"D3", "[", 
         FractionBox["x", 
          RowBox[{"b", " ", "c", " ", "y"}]], "]"}], "+", 
        RowBox[{"D3", "[", "y", "]"}], "-", 
        RowBox[{"D3", "[", 
         FractionBox["y", "c"], "]"}], "+", 
        RowBox[{"D3", "[", 
         FractionBox[
          RowBox[{"a", " ", "b"}], "z"], "]"}], "+", 
        RowBox[{"D3", "[", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"b", " ", "y"}], "z"]}], "]"}], "+", 
        RowBox[{"D3", "[", 
         FractionBox["y", 
          RowBox[{"c", " ", "z"}]], "]"}], "-", 
        RowBox[{"D3", "[", 
         FractionBox["y", 
          RowBox[{"a", " ", "c", " ", "z"}]], "]"}], "+", 
        RowBox[{"D3", "[", "z", "]"}], "-", 
        RowBox[{"D3", "[", 
         FractionBox["z", "a"], "]"}], "+", 
        RowBox[{"D3", "[", 
         FractionBox["z", 
          RowBox[{"a", " ", "x"}]], "]"}], "-", 
        RowBox[{"D3", "[", 
         FractionBox["z", 
          RowBox[{"a", " ", "b", " ", "x"}]], "]"}], "+", 
        RowBox[{"D3", "[", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"c", " ", "z"}], "x"]}], "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.955792801274004*^9, 3.9557928193249607`*^9}, {
   3.955792885482771*^9, 3.95579290381728*^9}, {3.9557929761284504`*^9, 
   3.9557929802086163`*^9}, {3.9557930329886284`*^9, 
   3.9557930344308205`*^9}, {3.95579406535956*^9, 3.955794111425558*^9}, {
   3.957599209926819*^9, 3.9575992231462593`*^9}, {3.9576029973632298`*^9, 
   3.9576030021132355`*^9}, {3.957603220444273*^9, 3.957603223944275*^9}, {
   3.958006440819687*^9, 3.9580065102493706`*^9}, 3.959573018158125*^9},
 CellLabel->
  "In[125]:=",ExpressionUUID->"a74d011e-da9c-0741-8dce-269d7250936b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rootsOfUnityInNumberField", "[", 
    RowBox[{"n_", ",", "generator_"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rootsOfUnityInNumberField", "[", 
      RowBox[{"n", ",", "generator"}], "]"}], "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"root", "=", 
         RowBox[{"ToNumberField", "[", 
          RowBox[{
           RowBox[{"Exp", "[", 
            FractionBox[
             RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]"}], "n"], "]"}], ",", 
           "generator"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox["root", "i"], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "]"}]}], 
    ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DistributionRelationD2", "[", 
     RowBox[{"n_", ",", " ", "generator_"}], "]"}], "[", "x_", "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roots", "=", 
       RowBox[{"rootsOfUnityInNumberField", "[", 
        RowBox[{"n", ",", "generator"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"D2", "[", 
       SuperscriptBox["x", "n"], "]"}], "-", 
      RowBox[{"n", "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"D2", "[", 
          RowBox[{"x", "*", 
           RowBox[{"roots", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DistributionRelationD3", "[", 
      RowBox[{"n_", ",", " ", "generator_"}], "]"}], "[", "x_", "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"roots", "=", 
        RowBox[{"rootsOfUnityInNumberField", "[", 
         RowBox[{"n", ",", "generator"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"D3", "[", 
        SuperscriptBox["x", "n"], "]"}], "-", 
       RowBox[{
        SuperscriptBox["n", "2"], "*", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"D3", "[", 
           RowBox[{"x", "*", 
            RowBox[{"roots", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetDistributionRelationsD2", "[", 
     RowBox[{"hightestRootOfUnity_", ",", "generator_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"divisors", "=", 
        RowBox[{"Divisors", "[", "hightestRootOfUnity", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DistributionRelationD2", "[", 
           RowBox[{"div", ",", "generator"}], "]"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"div", ",", 
          RowBox[{"divisors", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetDistributionRelationsD3", "[", 
    RowBox[{"hightestRootOfUnity_", ",", "generator_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"divisors", "=", 
       RowBox[{"Divisors", "[", "hightestRootOfUnity", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DistributionRelationD3", "[", 
          RowBox[{"div", ",", "generator"}], "]"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"div", ",", 
         RowBox[{"divisors", "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9583502875472965`*^9, 3.9583503300753155`*^9}, 
   3.9583504719263325`*^9, {3.9583508106034393`*^9, 3.9583509230568314`*^9}, {
   3.9583509878083534`*^9, 3.958351023517988*^9}, {3.958351466083477*^9, 
   3.958351475352127*^9}, {3.9583615120853367`*^9, 3.958361571377823*^9}, {
   3.9583617093312836`*^9, 3.958361749971178*^9}, {3.959383973152899*^9, 
   3.959384003165085*^9}, {3.959384072931225*^9, 3.9593841127539425`*^9}, {
   3.959384168783825*^9, 3.9593842321990414`*^9}, {3.959384384774929*^9, 
   3.959384418769829*^9}, {3.959384623399521*^9, 3.959384674805027*^9}, {
   3.959384738277399*^9, 3.959384758461544*^9}, {3.959384962330305*^9, 
   3.959384968643837*^9}, {3.959385025952381*^9, 3.9593850333784714`*^9}, {
   3.959474980068657*^9, 3.9594749885231533`*^9}, {3.959573485535324*^9, 
   3.95957349652116*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"f3f8051d-1f1a-d44e-bf3a-2c0d7158c91e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Independent Relations", "Subsection",
 CellChangeTimes->{{3.9506115631905212`*^9, 
  3.9506115677244816`*^9}},ExpressionUUID->"1e6156af-b82e-f34c-a6c5-\
2750ac160d13"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"selectTerms", "[", 
    RowBox[{"expr_", ",", "function_"}], "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{"expr", ",", 
       RowBox[{"function", "[", "_", "]"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{"#", ",", 
        RowBox[{"_.", 
         RowBox[{"function", "[", "_", "]"}]}]}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"toAssoc", "[", 
     RowBox[{"expr_", ",", "function_"}], "]"}], ":=", 
    RowBox[{"Association", "@", 
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{"expr", ",", 
         RowBox[{"function", "[", "_", "]"}]}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"a_.", " ", 
         RowBox[{"function", "[", "z_", "]"}]}], ":>", " ", 
        RowBox[{"(", 
         RowBox[{"z", "->", "a"}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"normalizeAssoc", "[", "assoc_", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       FractionBox["#", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"KeySort", "@", "assoc"}], ")"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]], "&"}], ",", 
      RowBox[{"KeySort", "@", "assoc"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "to", " ", "compare", " ", "if", " ", "two", " ", "associations", " ", 
     "represent", " ", "relations", " ", "that", " ", "are", " ", "multiples",
      " ", "of", " ", "each", " ", "other"}], ",", " ", 
    RowBox[{
    "we", " ", "normalize", " ", "them", " ", "by", " ", "setting", " ", 
     "the", " ", "first", " ", "coefficient", " ", "to", " ", "0.", " ", 
     "Note", " ", "that", " ", "we", " ", "make", " ", "the", " ", 
     "associations", " ", "canonically", " ", "orderd"}], ",", " ", 
    RowBox[{
    "so", " ", "two", " ", "associations", " ", "with", " ", "the", " ", 
     "same", " ", "keys", " ", "have", " ", "also", " ", "the", " ", "same", " ",
      "first", " ", 
     RowBox[{"key", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getAllRelationsWithContractions", "[", 
     RowBox[{"relationList_", ",", "relatedArgumentsFunction_"}], "]"}], ":=", 
    RowBox[{"Apply", "[", "\[IndentingNewLine]", 
     RowBox[{"Join", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"rel", ",", " ", "numberOfInputs"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Block", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"subsets", " ", "=", " ", 
              RowBox[{"Tuples", "[", 
               RowBox[{
                RowBox[{"Apply", "[", 
                 RowBox[{"Join", ",", 
                  RowBox[{"(", 
                   RowBox[{"relatedArgumentsFunction", "/@", 
                    RowBox[{"Array", "[", 
                    RowBox[{"Slot", ",", "numberOfInputs"}], "]"}]}], ")"}]}],
                  "]"}], ",", 
                RowBox[{"{", "numberOfInputs", "}"}]}], "]"}]}], ",", 
             "args"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"args", "=", 
             RowBox[{"Select", "[", 
              RowBox[{"subsets", ",", "\[IndentingNewLine]", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", "x", "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"slotsIndices", " ", "=", " ", 
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{
                    RowBox[{"Slot", "[", "i_", "]"}], ":>", "i"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], 
                    "]"}]}], "}"}], ",", 
                   RowBox[{
                    RowBox[{"Length", "[", "slotsIndices", "]"}], "==", 
                    RowBox[{"Max", "[", "slotsIndices", "]"}]}]}], "]"}]}], 
                "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"ReleaseHold", "[", 
             RowBox[{
              RowBox[{"Function", "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Hold", "[", "rel", "]"}], "@@@", "args"}], ")"}]}], 
              "/.", 
              RowBox[{"Conjugate", ":>", 
               RowBox[{"Hold", "[", "Conj", "]"}]}]}], "]"}]}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], "@@@", "relationList"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"copied", " ", "from", " ", "fullProof"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IndependentRelationsWithContractions", "[", 
    RowBox[{"relationList_", ",", "relatedArgumentsFunction_", ",", 
     RowBox[{"function_", "->", "symmetrizedFunction_"}], ",", 
     RowBox[{"generator_", ":", 
      SqrtBox[
       RowBox[{"-", "1"}]]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"allRelations", " ", "=", " ", 
        RowBox[{"getAllRelationsWithContractions", "[", 
         RowBox[{"relationList", ",", "relatedArgumentsFunction"}], "]"}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"maxNumberOfInputs", " ", "=", " ", 
        RowBox[{"Max", "[", 
         RowBox[{"relationList", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "testNumbers", ",", "\[IndentingNewLine]", 
       "relationsAssoc", ",", "\[IndentingNewLine]", "groups"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"testNumbers", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"ToNumberField", "[", 
          RowBox[{"#", ",", "generator"}], "]"}], "&"}], "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Floor", "@", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox["10", 
                RowBox[{
                 RowBox[{"8", "n"}], "-", "4"}]], " ", "Pi"}], ",", 
              SuperscriptBox["10", "4"]}], "]"}]}], "+", 
           RowBox[{"generator", " ", 
            RowBox[{"Floor", "@", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{
                SuperscriptBox["10", 
                 RowBox[{"8", "n"}]], " ", "Pi"}], ",", 
               SuperscriptBox["10", "4"]}], "]"}]}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", "maxNumberOfInputs"}], "}"}]}], 
         "]"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "testNumbers", " ", "should", " ", "be", " ", "sufficiently", " ", 
        "general", " ", "numbers", " ", "with", " ", "no", " ", "surprising", 
        " ", "relations"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"relationsAssoc", " ", "=", " ", 
       RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rel", ",", " ", "index"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"result", "=", 
               RowBox[{"ReplaceAll", "[", 
                RowBox[{
                 RowBox[{"rel", "@@", "testNumbers"}], ",", 
                 RowBox[{"function", "->", "symmetrizedFunction"}]}], "]"}]}],
               "}"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"result", "===", "Nothing"}], ",", "Nothing", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"normalizeAssoc", "@", 
                  RowBox[{"toAssoc", "[", 
                   RowBox[{"result", ",", "function"}], "]"}]}], ",", 
                 RowBox[{"First", "@", "index"}]}], "}"}]}], "]"}]}], "]"}]}],
           "]"}], ",", " ", "\[IndentingNewLine]", "allRelations"}], 
        "\[IndentingNewLine]", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "the", " ", "Nothing", " ", "check", " ", "handles", " ", "the", " ", 
        "case", " ", "where", " ", "the", " ", "relation", " ", "is", " ", 
        "applied", " ", "to", " ", "inputs", " ", "where", " ", "it", " ", 
        "does", " ", "not", " ", "make", " ", 
        RowBox[{"sense", ".", " ", 
         RowBox[{"TODO", ":", " ", 
          RowBox[{
          "I", " ", "think", " ", "this", " ", "is", " ", "not", " ", 
           "necessary", " ", "here"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"groups", "=", 
       RowBox[{"GroupBy", "[", 
        RowBox[{"relationsAssoc", ",", " ", 
         RowBox[{"First", "->", "Last"}], ",", "First"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", "x", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"Max", "[", 
            RowBox[{"Cases", "[", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"Slot", "[", "i_", "]"}], ":>", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "]"}]}], 
          "}"}]}], "]"}], "/@", 
       RowBox[{"allRelations", "[", 
        RowBox[{"[", 
         RowBox[{"Values", "@", "groups"}], "]"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950429871678007*^9, 3.950429911258707*^9}, {
   3.950430190083811*^9, 3.9504302167733707`*^9}, {3.950430331512102*^9, 
   3.9504303509354286`*^9}, {3.9504312997346287`*^9, 3.950431308125799*^9}, {
   3.950437441756071*^9, 3.950437446693899*^9}, {3.950437488898033*^9, 
   3.950437547425829*^9}, {3.9504376077016582`*^9, 3.9504377173013496`*^9}, {
   3.950437749834778*^9, 3.950437826182699*^9}, {3.9504378619177914`*^9, 
   3.950437898919901*^9}, {3.950437928953491*^9, 3.950437969847069*^9}, {
   3.950438056709879*^9, 3.9504380822892456`*^9}, 3.950438116494358*^9, {
   3.9504382196740074`*^9, 3.9504382352199783`*^9}, {3.950438285520054*^9, 
   3.9504383193197517`*^9}, {3.9504385316268044`*^9, 3.950438579128828*^9}, {
   3.950439702460161*^9, 3.9504397467274456`*^9}, 3.950608106847313*^9, {
   3.9506121240226765`*^9, 3.9506121251165085`*^9}, {3.950683353887808*^9, 
   3.9506833698930264`*^9}, {3.950683452588585*^9, 3.950683551428301*^9}, {
   3.95068390384359*^9, 3.950683908003435*^9}, {3.95068413203726*^9, 
   3.950684132382204*^9}, {3.9506845873078156`*^9, 3.950684592887501*^9}, {
   3.9506846785344105`*^9, 3.95068468358403*^9}, {3.9506848955789986`*^9, 
   3.950684919067297*^9}, {3.950685310388695*^9, 3.950685312030451*^9}, {
   3.9506857067532616`*^9, 3.9506857137381134`*^9}, 3.950686212751713*^9, {
   3.9557933079327106`*^9, 3.9557933092452106`*^9}, 3.957601901539171*^9, {
   3.958007048460966*^9, 3.9580070567403336`*^9}, {3.958007087119932*^9, 
   3.958007096080448*^9}, {3.958007196652033*^9, 3.958007200765524*^9}, {
   3.95800731273621*^9, 3.95800731399168*^9}, {3.958007409883461*^9, 
   3.9580074333964424`*^9}, {3.9580075491432915`*^9, 
   3.9580075785391903`*^9}, {3.959385054733549*^9, 3.9593850843598175`*^9}, {
   3.959585549052927*^9, 3.959585597978359*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"b8cc40cc-7e34-5a4d-9e89-26beaaaa28c1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EquivalentArgumentsLi2", "::", "usage"}], "=", 
   " ", "\"\<EquivalentArgumentsLi2[z] gives the list \
{z,1/z,1-z,1/(1-z),z/(z-1),1-1/z}\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EquivalentArgumentsLi3", "::", "usage"}], 
   "=", "\"\<EquivalentArgumentsLi3[z] gives the list {z,1/z}\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EquivalentArgumentsD2", "::", "usage"}], " ", "=", 
   " ", "\"\<EquivalentArgumentsD2[z] gives the list Join[A,Conj/@A] where \
A={z,1/z,1-z,1/(1-z),z/(z-1),1-1/z}.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EquivalentArgumentsD3", "::", "usage"}], " ", "=", 
   " ", "\"\<EquivalentArgumentsD3[z] gives the list \
{z,1/z,Conj[z],Conj[1/z]}.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EquivalentArgumentsLi2", "[", "z_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"z", ",", 
     FractionBox["1", "z"], ",", 
     RowBox[{"1", "-", "z"}], ",", 
     FractionBox["1", 
      RowBox[{"1", "-", "z"}]], ",", 
     FractionBox["z", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "z"}]], ",", 
     RowBox[{"1", "-", 
      FractionBox["1", "z"]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EquivalentArgumentsLi3", "[", "z_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"z", ",", 
     FractionBox["1", "z"]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EquivalentArgumentsD2", "[", "z_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"z", ",", 
      FractionBox["1", "z"], ",", 
      RowBox[{"1", "-", "z"}], ",", 
      FractionBox["1", 
       RowBox[{"1", "-", "z"}]], ",", 
      FractionBox["z", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "z"}]], ",", 
      RowBox[{"1", "-", 
       FractionBox["1", "z"]}], ",", 
      RowBox[{"Conj", "[", "z", "]"}], ",", 
      FractionBox["1", 
       RowBox[{"Conj", "[", "z", "]"}]], ",", 
      RowBox[{"1", "-", 
       RowBox[{"Conj", "[", "z", "]"}]}], ",", 
      FractionBox["1", 
       RowBox[{"1", "-", 
        RowBox[{"Conj", "[", "z", "]"}]}]], ",", 
      FractionBox[
       RowBox[{"Conj", "[", "z", "]"}], 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"Conj", "[", "z", "]"}]}]], ",", 
      RowBox[{"1", "-", 
       FractionBox["1", 
        RowBox[{"Conj", "[", "z", "]"}]]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EquivalentArgumentsD3", "[", "z_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"z", ",", 
     FractionBox["1", "z"], ",", 
     RowBox[{"Conj", "[", "z", "]"}], ",", 
     FractionBox["1", 
      RowBox[{"Conj", "[", "z", "]"}]]}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9595854628681717`*^9, 3.959585495671116*^9}, 
   3.9595863022156277`*^9, {3.9600043703065605`*^9, 
   3.9600045879662724`*^9}},ExpressionUUID->"2402d62c-3468-d541-8ee5-\
98b793578fb0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Iconize", "[", 
  RowBox[{
   RowBox[{"IndependentRelationsWithContractions", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DuplicationRelationD2", ",", " ", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"FiveTermRelationD2", ",", "2"}], "}"}]}], "}"}], ",", 
     "EquivalentArgumentsD2", ",", 
     RowBox[{"D2", "->", "sD2"}]}], "]"}], ",", "\"\<all relations D2\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.955793321970148*^9, 3.9557933371393223`*^9}, {
   3.958007222140251*^9, 3.958007238774006*^9}, {3.958007760323963*^9, 
   3.958007822683344*^9}, 3.959479204412836*^9, {3.9595862651418304`*^9, 
   3.9595862813094044`*^9}, {3.9595863502629356`*^9, 3.9595863787523365`*^9}},
 CellLabel->
  "In[275]:=",ExpressionUUID->"ad1dc18a-e897-f34c-a45a-e45789b75e05"],

Cell[BoxData[
 InterpretationBox[
  DynamicModuleBox[{Typeset`open = False}, 
   TemplateBox[{"List", 
     StyleBox[
     "\"all relations D2\"", "IconizedCustomName", StripOnInput -> False], 
     GridBox[{{
        RowBox[{
          TagBox["\"Head: \"", "IconizedLabel"], "\[InvisibleSpace]", 
          TagBox["List", "IconizedItem"]}]}, {
        RowBox[{
          TagBox["\"Dimensions: \"", "IconizedLabel"], "\[InvisibleSpace]", 
          TagBox[
           RowBox[{"{", 
             RowBox[{"19", ",", "2"}], "}"}], "IconizedItem"]}]}, {
        RowBox[{
          TagBox["\"Byte count: \"", "IconizedLabel"], "\[InvisibleSpace]", 
          TagBox["8848", "IconizedItem"]}]}}, 
      GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
      "Column", 
      GridBoxItemSize -> {
       "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
     Dynamic[Typeset`open]},
    "IconizedObject"]],
  {{PolyLogSimplify`DuplicationRelationD2[#]& , 1}, {
   PolyLogSimplify`DuplicationRelationD2[1 - #]& , 1}, {
   PolyLogSimplify`DuplicationRelationD2[(-1 + #)^(-1) #]& , 1}, {
   PolyLogSimplify`FiveTermRelationD2[#, #^(-1)]& , 1}, {
   PolyLogSimplify`FiveTermRelationD2[#, 1 - #]& , 1}, {
   PolyLogSimplify`FiveTermRelationD2[#, 
     PolyLogSimplify`AlgebraicConjugate[#]^(-1)]& , 1}, {
   PolyLogSimplify`FiveTermRelationD2[#, 1 - 
     PolyLogSimplify`AlgebraicConjugate[#]]& , 1}, {
   PolyLogSimplify`FiveTermRelationD2[#, #2]& , 2}, {
   PolyLogSimplify`FiveTermRelationD2[#, #2^(-1)]& , 2}, {
   PolyLogSimplify`FiveTermRelationD2[#, 1 - #2]& , 2}, {
   PolyLogSimplify`FiveTermRelationD2[#, (1 - #2)^(-1)]& , 2}, {
   PolyLogSimplify`FiveTermRelationD2[#, (-1 + #2)^(-1) #2]& , 2}, {
   PolyLogSimplify`FiveTermRelationD2[#, 1 - #2^(-1)]& , 2}, {
   PolyLogSimplify`FiveTermRelationD2[#, 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
   PolyLogSimplify`FiveTermRelationD2[#, 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
   PolyLogSimplify`FiveTermRelationD2[#, 1 - 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
   PolyLogSimplify`FiveTermRelationD2[#, (1 - 
      PolyLogSimplify`AlgebraicConjugate[#2])^(-1)]& , 2}, {
   PolyLogSimplify`FiveTermRelationD2[#, (-1 + 
       PolyLogSimplify`AlgebraicConjugate[#2])^(-1) 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
   PolyLogSimplify`FiveTermRelationD2[#, 1 - 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}},
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.959586422268093*^9},
 CellLabel->
  "Out[275]=",ExpressionUUID->"4c4ba0ea-43ba-a746-a12c-a7649f336c13"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Iconize", "[", 
  RowBox[{
   RowBox[{"IndependentRelationsWithContractions", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DuplicationRelationD2", ",", " ", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"FiveTermRelationD2", ",", "2"}], "}"}]}], "}"}], ",", 
     "EquivalentArgumentsLi2", ",", 
     RowBox[{"D2", "->", "sD2NoConj"}]}], "]"}], 
   ",", "\"\<all relations D2 no conjugate\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.959586385423853*^9, 3.959586386744751*^9}},
 CellLabel->
  "In[276]:=",ExpressionUUID->"3a56e5f4-c3a9-a346-8be1-20fe74094422"],

Cell[BoxData[
 InterpretationBox[
  DynamicModuleBox[{Typeset`open = False}, 
   TemplateBox[{"List", 
     StyleBox[
     "\"all relations D2 no conjugate\"", "IconizedCustomName", StripOnInput -> 
      False], 
     GridBox[{{
        RowBox[{
          TagBox["\"Head: \"", "IconizedLabel"], "\[InvisibleSpace]", 
          TagBox["List", "IconizedItem"]}]}, {
        RowBox[{
          TagBox["\"Dimensions: \"", "IconizedLabel"], "\[InvisibleSpace]", 
          TagBox[
           RowBox[{"{", 
             RowBox[{"11", ",", "2"}], "}"}], "IconizedItem"]}]}, {
        RowBox[{
          TagBox["\"Byte count: \"", "IconizedLabel"], "\[InvisibleSpace]", 
          TagBox["4792", "IconizedItem"]}]}}, 
      GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
      "Column", 
      GridBoxItemSize -> {
       "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
     Dynamic[Typeset`open]},
    "IconizedObject"]],
  {{PolyLogSimplify`DuplicationRelationD2[#]& , 1}, {
   PolyLogSimplify`DuplicationRelationD2[1 - #]& , 1}, {
   PolyLogSimplify`DuplicationRelationD2[(-1 + #)^(-1) #]& , 1}, {
   PolyLogSimplify`FiveTermRelationD2[#, #^(-1)]& , 1}, {
   PolyLogSimplify`FiveTermRelationD2[#, 1 - #]& , 1}, {
   PolyLogSimplify`FiveTermRelationD2[#, #2]& , 2}, {
   PolyLogSimplify`FiveTermRelationD2[#, #2^(-1)]& , 2}, {
   PolyLogSimplify`FiveTermRelationD2[#, 1 - #2]& , 2}, {
   PolyLogSimplify`FiveTermRelationD2[#, (1 - #2)^(-1)]& , 2}, {
   PolyLogSimplify`FiveTermRelationD2[#, (-1 + #2)^(-1) #2]& , 2}, {
   PolyLogSimplify`FiveTermRelationD2[#, 1 - #2^(-1)]& , 2}},
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.959586423692604*^9},
 CellLabel->
  "Out[276]=",ExpressionUUID->"129a2bf1-c991-c94b-b2bc-970332689d78"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Iconize", "[", 
  RowBox[{
   RowBox[{"IndependentRelationsWithContractions", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ThreeTermRelationD3", ",", " ", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"DuplicationRelationD3", ",", " ", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"NineTermRelationD3", ",", " ", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"TwentyTwoTermRelationD3", ",", " ", "3"}], "}"}]}], "}"}], ",",
      "EquivalentArgumentsD3", ",", 
     RowBox[{"D3", "->", "sD3"}]}], "]"}], ",", "\"\<all relations D3\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.959586393096874*^9, 3.9595863941213703`*^9}},
 CellLabel->
  "In[277]:=",ExpressionUUID->"672a3ac2-c786-9d48-ba8f-bb63e92768e4"],

Cell[BoxData[
 InterpretationBox[
  DynamicModuleBox[{Typeset`open = False}, 
   TemplateBox[{"List", 
     StyleBox[
     "\"all relations D3\"", "IconizedCustomName", StripOnInput -> False], 
     GridBox[{{
        RowBox[{
          TagBox["\"Head: \"", "IconizedLabel"], "\[InvisibleSpace]", 
          TagBox["List", "IconizedItem"]}]}, {
        RowBox[{
          TagBox["\"Dimensions: \"", "IconizedLabel"], "\[InvisibleSpace]", 
          TagBox[
           RowBox[{"{", 
             RowBox[{"75", ",", "2"}], "}"}], "IconizedItem"]}]}, {
        RowBox[{
          TagBox["\"Byte count: \"", "IconizedLabel"], "\[InvisibleSpace]", 
          TagBox["36352", "IconizedItem"]}]}}, 
      GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
      "Column", 
      GridBoxItemSize -> {
       "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
     Dynamic[Typeset`open]},
    "IconizedObject"]],
  {{$CellContext`ThreeTermRelationD3[#]& , 1}, {
   PolyLogSimplify`DuplicationRelationD3[#]& , 1}, {
   PolyLogSimplify`NineTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#]]& , 1}, {
   PolyLogSimplify`NineTermRelationD3[#, #2]& , 2}, {
   PolyLogSimplify`NineTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #, #]& , 1}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #, #^(-1)]& , 1}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #, 
     PolyLogSimplify`AlgebraicConjugate[#]]& , 1}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #, 
     PolyLogSimplify`AlgebraicConjugate[#]^(-1)]& , 1}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #, #2]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #, #2^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #, 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #, 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#]]& , 1}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #^(-1), #2]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#], #^(-1)]& , 1}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#], #2]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#], #2^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#], 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#], 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#]^(-1), #2]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#]^(-1), #2^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, #^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, 
     PolyLogSimplify`AlgebraicConjugate[#]^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, #2]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, #2^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, #3]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, #3^(-1)]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, 
     PolyLogSimplify`AlgebraicConjugate[#3]]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, 
     PolyLogSimplify`AlgebraicConjugate[#3]^(-1)]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#]^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), #2]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), #2^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), #3]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), #3^(-1)]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#3]]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#3]^(-1)]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2], #^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2], #2]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2], #2^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2], 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2], 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2], #3]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2], #3^(-1)]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2], 
     PolyLogSimplify`AlgebraicConjugate[#3]]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2], 
     PolyLogSimplify`AlgebraicConjugate[#3]^(-1)]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1), #2]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1), #2^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1), #3]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1), #3^(-1)]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#3]]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#3]^(-1)]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #3, #2]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #3, #2^(-1)]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #3, 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #3, 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #3^(-1), #2]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #3^(-1), #2^(-1)]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #3^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #3^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#3], #2]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#3], #2^(-1)]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#3], 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#3], 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#3]^(-1), #2]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#3]^(-1), #2^(-1)]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#3]^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 3}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#3]^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 3}},
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.9595864340846806`*^9},
 CellLabel->
  "Out[277]=",ExpressionUUID->"b686f41a-d397-2440-8f2b-32d42d99e674"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Iconize", "[", 
  RowBox[{
   RowBox[{"IndependentRelationsWithContractions", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ThreeTermRelationD3", ",", " ", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"DuplicationRelationD3", ",", " ", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"NineTermRelationD3", ",", " ", "2"}], "}"}]}], "}"}], ",", 
     "EquivalentArgumentsD3", ",", 
     RowBox[{"D3", "->", "sD3"}]}], "]"}], 
   ",", "\"\<all relations except 22 term D3\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.9595863988348103`*^9, 3.959586399345623*^9}},
 CellLabel->
  "In[278]:=",ExpressionUUID->"b90fd3b7-454c-eb46-a910-0ac1bc3b0079"],

Cell[BoxData[
 InterpretationBox[
  DynamicModuleBox[{Typeset`open = False}, 
   TemplateBox[{"List", 
     StyleBox[
     "\"all relations except 22 term D3\"", "IconizedCustomName", 
      StripOnInput -> False], 
     GridBox[{{
        RowBox[{
          TagBox["\"Head: \"", "IconizedLabel"], "\[InvisibleSpace]", 
          TagBox["List", "IconizedItem"]}]}, {
        RowBox[{
          TagBox["\"Dimensions: \"", "IconizedLabel"], "\[InvisibleSpace]", 
          TagBox[
           RowBox[{"{", 
             RowBox[{"5", ",", "2"}], "}"}], "IconizedItem"]}]}, {
        RowBox[{
          TagBox["\"Byte count: \"", "IconizedLabel"], "\[InvisibleSpace]", 
          TagBox["1552", "IconizedItem"]}]}}, 
      GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
      "Column", 
      GridBoxItemSize -> {
       "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
     Dynamic[Typeset`open]},
    "IconizedObject"]],
  {{$CellContext`ThreeTermRelationD3[#]& , 1}, {
   PolyLogSimplify`DuplicationRelationD3[#]& , 1}, {
   PolyLogSimplify`NineTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#]]& , 1}, {
   PolyLogSimplify`NineTermRelationD3[#, #2]& , 2}, {
   PolyLogSimplify`NineTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}},
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.9595864353497257`*^9},
 CellLabel->
  "Out[278]=",ExpressionUUID->"5e5ad2ef-6131-a74b-9da3-a3cd57629d11"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Iconize", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Select", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IndependentRelationsWithContractions", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ThreeTermRelationD3", ",", " ", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"DuplicationRelationD3", ",", " ", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"NineTermRelationD3", ",", " ", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"TwentyTwoTermRelationD3", ",", " ", "3"}], "}"}]}], "}"}], 
       ",", "EquivalentArgumentsD3", ",", 
       RowBox[{"D3", "->", "sD3"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Last", "[", "#", "]"}], "<", "3"}], "&"}]}], "]"}], ",", 
   "\[IndentingNewLine]", "\"\<all relations except 3 param relations \
D3\>\""}], "]"}]], "Input",
 CellLabel->
  "In[279]:=",ExpressionUUID->"fca15f5b-3f38-e94d-89ba-d76995962e6a"],

Cell[BoxData[
 InterpretationBox[
  DynamicModuleBox[{Typeset`open = False}, 
   TemplateBox[{"List", 
     StyleBox[
     "\"all relations except 3 param relations D3\"", "IconizedCustomName", 
      StripOnInput -> False], 
     GridBox[{{
        RowBox[{
          TagBox["\"Head: \"", "IconizedLabel"], "\[InvisibleSpace]", 
          TagBox["List", "IconizedItem"]}]}, {
        RowBox[{
          TagBox["\"Dimensions: \"", "IconizedLabel"], "\[InvisibleSpace]", 
          TagBox[
           RowBox[{"{", 
             RowBox[{"43", ",", "2"}], "}"}], "IconizedItem"]}]}, {
        RowBox[{
          TagBox["\"Byte count: \"", "IconizedLabel"], "\[InvisibleSpace]", 
          TagBox["20224", "IconizedItem"]}]}}, 
      GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
      "Column", 
      GridBoxItemSize -> {
       "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
     Dynamic[Typeset`open]},
    "IconizedObject"]],
  {{$CellContext`ThreeTermRelationD3[#]& , 1}, {
   PolyLogSimplify`DuplicationRelationD3[#]& , 1}, {
   PolyLogSimplify`NineTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#]]& , 1}, {
   PolyLogSimplify`NineTermRelationD3[#, #2]& , 2}, {
   PolyLogSimplify`NineTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #, #]& , 1}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #, #^(-1)]& , 1}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #, 
     PolyLogSimplify`AlgebraicConjugate[#]]& , 1}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #, 
     PolyLogSimplify`AlgebraicConjugate[#]^(-1)]& , 1}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #, #2]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #, #2^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #, 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #, 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#]]& , 1}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #^(-1), #2]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#], #^(-1)]& , 1}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#], #2]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#], #2^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#], 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#], 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#]^(-1), #2]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#]^(-1), #2^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, #^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, 
     PolyLogSimplify`AlgebraicConjugate[#]^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, #2]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, #2^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#]^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), #2]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), #2^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2], #^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2], #2]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2], #2^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2], 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2], 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1), #2]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1), #2^(-1)]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
   PolyLogSimplify`TwentyTwoTermRelationD3[#, 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1), 
     PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}},
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.959586446214983*^9},
 CellLabel->
  "Out[279]=",ExpressionUUID->"22e5d543-7b9d-e543-8415-f95130c4653b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AllRelationsD2", " ", "=", " ", 
   InterpretationBox[
    DynamicModuleBox[{Typeset`open = False}, 
     TemplateBox[{"List", 
       StyleBox[
       "\"all relations D2\"", "IconizedCustomName", StripOnInput -> False], 
       GridBox[{{
          RowBox[{
            TagBox["\"Head: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["List", "IconizedItem"]}]}, {
          RowBox[{
            TagBox["\"Dimensions: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox[
             RowBox[{"{", 
               RowBox[{"19", ",", "2"}], "}"}], "IconizedItem"]}]}, {
          RowBox[{
            TagBox["\"Byte count: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["8848", "IconizedItem"]}]}}, 
        GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
        "Column", 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
       Dynamic[Typeset`open]},
      "IconizedObject"]],
    {{PolyLogSimplify`DuplicationRelationD2[#]& , 1}, {
     PolyLogSimplify`DuplicationRelationD2[1 - #]& , 1}, {
     PolyLogSimplify`DuplicationRelationD2[(-1 + #)^(-1) #]& , 1}, {
     PolyLogSimplify`FiveTermRelationD2[#, #^(-1)]& , 1}, {
     PolyLogSimplify`FiveTermRelationD2[#, 1 - #]& , 1}, {
     PolyLogSimplify`FiveTermRelationD2[#, 
       PolyLogSimplify`AlgebraicConjugate[#]^(-1)]& , 1}, {
     PolyLogSimplify`FiveTermRelationD2[#, 1 - 
       PolyLogSimplify`AlgebraicConjugate[#]]& , 1}, {
     PolyLogSimplify`FiveTermRelationD2[#, #2]& , 2}, {
     PolyLogSimplify`FiveTermRelationD2[#, #2^(-1)]& , 2}, {
     PolyLogSimplify`FiveTermRelationD2[#, 1 - #2]& , 2}, {
     PolyLogSimplify`FiveTermRelationD2[#, (1 - #2)^(-1)]& , 2}, {
     PolyLogSimplify`FiveTermRelationD2[#, (-1 + #2)^(-1) #2]& , 2}, {
     PolyLogSimplify`FiveTermRelationD2[#, 1 - #2^(-1)]& , 2}, {
     PolyLogSimplify`FiveTermRelationD2[#, 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
     PolyLogSimplify`FiveTermRelationD2[#, 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
     PolyLogSimplify`FiveTermRelationD2[#, 1 - 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
     PolyLogSimplify`FiveTermRelationD2[#, (1 - 
        PolyLogSimplify`AlgebraicConjugate[#2])^(-1)]& , 2}, {
     PolyLogSimplify`FiveTermRelationD2[#, (-1 + 
         PolyLogSimplify`AlgebraicConjugate[#2])^(-1) 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
     PolyLogSimplify`FiveTermRelationD2[#, 1 - 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}},
    SelectWithContents->True,
    Selectable->False]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllRelationsD2NoConj", "=", 
   InterpretationBox[
    DynamicModuleBox[{Typeset`open = False}, 
     TemplateBox[{"List", 
       StyleBox[
       "\"all relations D2 no conjugate\"", "IconizedCustomName", 
        StripOnInput -> False], 
       GridBox[{{
          RowBox[{
            TagBox["\"Head: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["List", "IconizedItem"]}]}, {
          RowBox[{
            TagBox["\"Dimensions: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox[
             RowBox[{"{", 
               RowBox[{"11", ",", "2"}], "}"}], "IconizedItem"]}]}, {
          RowBox[{
            TagBox["\"Byte count: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["4792", "IconizedItem"]}]}}, 
        GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
        "Column", 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
       Dynamic[Typeset`open]},
      "IconizedObject"]],
    {{PolyLogSimplify`DuplicationRelationD2[#]& , 1}, {
     PolyLogSimplify`DuplicationRelationD2[1 - #]& , 1}, {
     PolyLogSimplify`DuplicationRelationD2[(-1 + #)^(-1) #]& , 1}, {
     PolyLogSimplify`FiveTermRelationD2[#, #^(-1)]& , 1}, {
     PolyLogSimplify`FiveTermRelationD2[#, 1 - #]& , 1}, {
     PolyLogSimplify`FiveTermRelationD2[#, #2]& , 2}, {
     PolyLogSimplify`FiveTermRelationD2[#, #2^(-1)]& , 2}, {
     PolyLogSimplify`FiveTermRelationD2[#, 1 - #2]& , 2}, {
     PolyLogSimplify`FiveTermRelationD2[#, (1 - #2)^(-1)]& , 2}, {
     PolyLogSimplify`FiveTermRelationD2[#, (-1 + #2)^(-1) #2]& , 2}, {
     PolyLogSimplify`FiveTermRelationD2[#, 1 - #2^(-1)]& , 2}},
    SelectWithContents->True,
    Selectable->False]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllRelationsD3", " ", "=", " ", 
   InterpretationBox[
    DynamicModuleBox[{Typeset`open = False}, 
     TemplateBox[{"List", 
       StyleBox[
       "\"all relations D3\"", "IconizedCustomName", StripOnInput -> False], 
       GridBox[{{
          RowBox[{
            TagBox["\"Head: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["List", "IconizedItem"]}]}, {
          RowBox[{
            TagBox["\"Dimensions: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox[
             RowBox[{"{", 
               RowBox[{"75", ",", "2"}], "}"}], "IconizedItem"]}]}, {
          RowBox[{
            TagBox["\"Byte count: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["36352", "IconizedItem"]}]}}, 
        GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
        "Column", 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
       Dynamic[Typeset`open]},
      "IconizedObject"]],
    {{$CellContext`ThreeTermRelationD3[#]& , 1}, {
     PolyLogSimplify`DuplicationRelationD3[#]& , 1}, {
     PolyLogSimplify`NineTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#]]& , 1}, {
     PolyLogSimplify`NineTermRelationD3[#, #2]& , 2}, {
     PolyLogSimplify`NineTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #, #]& , 1}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #, #^(-1)]& , 1}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #, 
       PolyLogSimplify`AlgebraicConjugate[#]]& , 1}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #, 
       PolyLogSimplify`AlgebraicConjugate[#]^(-1)]& , 1}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #, #2]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #, #2^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #, 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #, 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#]]& , 1}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #^(-1), #2]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#], #^(-1)]& , 1}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#], #2]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#], #2^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#], 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#], 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#]^(-1), #2]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#]^(-1), #2^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, #^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, 
       PolyLogSimplify`AlgebraicConjugate[#]^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, #2]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, #2^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, #3]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, #3^(-1)]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, 
       PolyLogSimplify`AlgebraicConjugate[#3]]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, 
       PolyLogSimplify`AlgebraicConjugate[#3]^(-1)]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#]^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), #2]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), #2^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), #3]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), #3^(-1)]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#3]]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#3]^(-1)]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2], #^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2], #2]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2], #2^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2], 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2], 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2], #3]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2], #3^(-1)]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2], 
       PolyLogSimplify`AlgebraicConjugate[#3]]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2], 
       PolyLogSimplify`AlgebraicConjugate[#3]^(-1)]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1), #2]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1), #2^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1), #3]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1), #3^(-1)]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#3]]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#3]^(-1)]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #3, #2]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #3, #2^(-1)]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #3, 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #3, 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #3^(-1), #2]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #3^(-1), #2^(-1)]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #3^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #3^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#3], #2]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#3], #2^(-1)]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#3], 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#3], 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#3]^(-1), #2]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#3]^(-1), #2^(-1)]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#3]^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 3}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#3]^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 3}},
    SelectWithContents->True,
    Selectable->False]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllRelationsD3Except22Term", " ", "=", " ", 
   InterpretationBox[
    DynamicModuleBox[{Typeset`open = False}, 
     TemplateBox[{"List", 
       StyleBox[
       "\"all relations except 22 term D3\"", "IconizedCustomName", 
        StripOnInput -> False], 
       GridBox[{{
          RowBox[{
            TagBox["\"Head: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["List", "IconizedItem"]}]}, {
          RowBox[{
            TagBox["\"Dimensions: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox[
             RowBox[{"{", 
               RowBox[{"5", ",", "2"}], "}"}], "IconizedItem"]}]}, {
          RowBox[{
            TagBox["\"Byte count: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["1552", "IconizedItem"]}]}}, 
        GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
        "Column", 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
       Dynamic[Typeset`open]},
      "IconizedObject"]],
    {{$CellContext`ThreeTermRelationD3[#]& , 1}, {
     PolyLogSimplify`DuplicationRelationD3[#]& , 1}, {
     PolyLogSimplify`NineTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#]]& , 1}, {
     PolyLogSimplify`NineTermRelationD3[#, #2]& , 2}, {
     PolyLogSimplify`NineTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}},
    SelectWithContents->True,
    Selectable->False]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllRelationsD3Except3Param", " ", "=", " ", 
   InterpretationBox[
    DynamicModuleBox[{Typeset`open = False}, 
     TemplateBox[{"List", 
       StyleBox[
       "\"all relations except 3 param relations D3\"", "IconizedCustomName", 
        StripOnInput -> False], 
       GridBox[{{
          RowBox[{
            TagBox["\"Head: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["List", "IconizedItem"]}]}, {
          RowBox[{
            TagBox["\"Dimensions: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox[
             RowBox[{"{", 
               RowBox[{"43", ",", "2"}], "}"}], "IconizedItem"]}]}, {
          RowBox[{
            TagBox["\"Byte count: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["20224", "IconizedItem"]}]}}, 
        GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
        "Column", 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
       Dynamic[Typeset`open]},
      "IconizedObject"]],
    {{$CellContext`ThreeTermRelationD3[#]& , 1}, {
     PolyLogSimplify`DuplicationRelationD3[#]& , 1}, {
     PolyLogSimplify`NineTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#]]& , 1}, {
     PolyLogSimplify`NineTermRelationD3[#, #2]& , 2}, {
     PolyLogSimplify`NineTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #, #]& , 1}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #, #^(-1)]& , 1}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #, 
       PolyLogSimplify`AlgebraicConjugate[#]]& , 1}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #, 
       PolyLogSimplify`AlgebraicConjugate[#]^(-1)]& , 1}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #, #2]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #, #2^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #, 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #, 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#]]& , 1}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #^(-1), #2]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#], #^(-1)]& , 1}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#], #2]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#], #2^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#], 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#], 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#]^(-1), #2]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#]^(-1), #2^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, #^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, 
       PolyLogSimplify`AlgebraicConjugate[#]^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, #2]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, #2^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2, 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#]^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), #2]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), #2^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, #2^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2], #^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2], #2]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2], #2^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2], 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2], 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1), #2]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1), #2^(-1)]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#2]]& , 2}, {
     PolyLogSimplify`TwentyTwoTermRelationD3[#, 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1), 
       PolyLogSimplify`AlgebraicConjugate[#2]^(-1)]& , 2}},
    SelectWithContents->True,
    Selectable->False]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.958008057122221*^9, 3.9580081581349754`*^9}, {
  3.9595864589690933`*^9, 3.959586483227293*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"46883437-339d-2e42-9ea9-87b932965158"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "adds", " ", "a", " ", "term", " ", "to", " ", "the", " ", "relation", " ",
     "that", " ", "serves", " ", "as", " ", "a", " ", 
    RowBox[{"certificate", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"addCertificate", "[", "relation_Function", "]"}], ":=", 
     RowBox[{"relation", "/.", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"body_", "[", "args__", "]"}], "]"}], ":>", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"body", "[", "args", "]"}], " ", "-", " ", 
         RowBox[{
          RowBox[{"Certificate", "[", "body", "]"}], "[", "args", "]"}]}], 
        "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"addAllCertificates", "[", "relationList_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"addCertificate", "[", 
          RowBox[{"First", "[", "#", "]"}], "]"}], ",", 
         RowBox[{"Last", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
      "relationList"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9595862173845825`*^9, 3.959586232040844*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"f974276c-88c3-104e-8a29-7ba4b86e1f89"]
}, Closed]],

Cell[CellGroupData[{

Cell["Algebraic Condition for Bloch Groups", "Subsection",
 CellChangeTimes->{{3.9580093621074696`*^9, 
  3.9580093678125362`*^9}},ExpressionUUID->"dddf15a9-e8b7-3d4d-b5ee-\
419b38aab27d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FindMultiplicativeEltRelation", "::", "wrong"}], 
   "=", "\"\<Relation does not hold.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FindMultiplicativeEltRelation", "::", "norelation"}], 
   "=", "\"\<No numerical relation found.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FindMultiplicativeEltRelation", "::", "complexcoeffs"}], " ", "=",
    " ", "\"\<Integer nullvector contains complex coefficients\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FindMultiplicativeEltRelation", "::", "usage"}], 
    "=", "\"\<FindMultiplicativeEltRelation[{\!\(\*SubscriptBox[\(a\), \(1\)]\
\),\!\(\*SubscriptBox[\(a\), \(2\)]\),...}] returns a rule \
MultElt[\!\(\*SubscriptBox[\(a\), \(k\)]\)] -> \!\(\*SubscriptBox[\(r\), \
\(1\)]\) MultElt[\!\(\*SubscriptBox[\(a\), SubscriptBox[\(i\), \(1\)]]\)] + \
... \!\(\*SubscriptBox[\(r\), \(l\)]\) MultElt[\!\(\*SubscriptBox[\(a\), \
SubscriptBox[\(i\), \(l\)]]\)] with rational \!\(\*SubscriptBox[\(r\), \(1\)]\
\) if \!\(\*SubscriptBox[\(a\), \
\(k\)]\)=\!\(\*SuperscriptBox[SubscriptBox[\(a\), SubscriptBox[\(i\), \
\(1\)]], SubscriptBox[\(r\), \
\(1\)]]\)...\!\(\*SuperscriptBox[SubscriptBox[\(a\), SubscriptBox[\(i\), \
\(l\)]], SubscriptBox[\(r\), \(l\)]]\) up to torsion.\>\""}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "returned", " ", "rule", " ", "is", " ", "proven", " ", "to", " ",
     "be", " ", 
    RowBox[{"correct", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FindMultiplicativeEltRelation", "[", "numbers_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nullVector", ",", "\[IndentingNewLine]", "index", ",", 
        "\[IndentingNewLine]", "relation"}], "\[IndentingNewLine]", "}"}], ",",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nullVector", " ", "=", 
        RowBox[{"Quiet", "[", 
         RowBox[{
          RowBox[{"Check", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FindIntegerNullVector", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]"}], "}"}], ",", 
               RowBox[{"Log", "/@", "numbers"}]}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Message", "[", 
              RowBox[{"FindMultiplicativeEltRelation", "::", "norelation"}], 
              "]"}], ";", 
             RowBox[{"Return", "[", 
              RowBox[{"$Failed", ",", "Module"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"FindIntegerNullVector", "::", "rnfu"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FindIntegerNullVector", "::", "rnfu"}], ",", 
            RowBox[{"FindIntegerNullVector", "::", "ztest1"}], ",", 
            RowBox[{"FindIntegerNullVector", "::", "ztest"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Sometimes", ",", " ", 
         RowBox[{
         "FindIntegerNullVector", " ", "gives", " ", "an", " ", "integer", " ",
           "nullvector", " ", "with", " ", "complex", " ", 
          RowBox[{"coefficients", ".", " ", "As"}], " ", "long", " ", "as", " ",
           "all", " ", "coefficients", " ", "are", " ", "purely", " ", 
          "imaginary"}], ",", " ", 
         RowBox[{"this", " ", "is", " ", 
          RowBox[{"fine", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{
           RowBox[{"Im", "/@", "nullVector"}], ",", 
           RowBox[{
            RowBox[{"#", "=!=", "0"}], "&"}]}], "]"}], ",", 
         RowBox[{"nullVector", " ", "=", " ", 
          RowBox[{"Im", "[", "nullVector", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{
           RowBox[{"Im", "/@", "nullVector"}], ",", 
           RowBox[{
            RowBox[{"#", "=!=", "0"}], "&"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"FindMultiplicativeEltRelation", "::", "complexcoeffs"}], ";",
           " ", 
          RowBox[{"Return", "[", 
           RowBox[{"$Failed", ",", "Module"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Check", " ", "if", " ", "the", " ", "relation", " ", "actually", " ", 
         RowBox[{"holds", ".", " ", "This"}], " ", "is", " ", "usally", " ", 
         "the", " ", "case", " ", "as", " ", "FindIntegerNullVector", " ", 
         "rarely", " ", "produces", " ", "wrong", " ", 
         RowBox[{"results", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Times", "@@", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Power", ",", 
             RowBox[{"{", 
              RowBox[{"numbers", ",", 
               RowBox[{"nullVector", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}]}], "=!=",
           "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"FindMultiplicativeEltRelation", "::", "wrong"}], "]"}], ";", 
          RowBox[{"Return", "[", 
           RowBox[{"$Failed", ",", "Module"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Return", " ", "a", " ", "rule", " ", "to", " ", "replace", " ", 
         "the", " ", "first", " ", "number", " ", "appearing", " ", "in", " ",
          "the", " ", 
         RowBox[{"relation", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"index", " ", "=", 
        RowBox[{"SelectFirst", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"Length", "@", "nullVector"}], "-", "1"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"nullVector", "[", 
             RowBox[{"[", 
              RowBox[{"#", "+", "1"}], "]"}], "]"}], "!=", "0"}], "&"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"relation", "=", 
        RowBox[{
         RowBox[{"MultElt", "[", 
          RowBox[{"numbers", "[", 
           RowBox[{"[", "index", "]"}], "]"}], "]"}], "->", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], 
           RowBox[{"nullVector", "[", 
            RowBox[{"[", 
             RowBox[{"index", "+", "1"}], "]"}], "]"}]], 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"MultElt", ",", 
             RowBox[{"numbers", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"index", "+", "1"}], ";;"}], "]"}], "]"}]}], "]"}], ".", 
           RowBox[{"nullVector", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"index", "+", "2"}], ";;"}], "]"}], "]"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", "relation"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReduceDimensionMultiplicativeElt", "::", "usage"}], 
   "=", "\"\<ReduceDimensionMultiplicativeElt[{a_1,a_2,...}] returns \
{{a_{i_1},...,a_{i_l}},{a_{j_1}->...,...}} where a_{i_1},...,a_{i_l} should \
be linearly independent (under multiplication) and {a_{j_1}->...,...} are \
rules for the other numbers to write them as rational linear combinations of \
all MultElem[a_{i_k}], up to torsion.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReduceDimensionMultiplicativeElt", "[", "numbers_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"updatedNumbers", " ", "=", " ", "numbers"}], ",", 
       "\[IndentingNewLine]", "relation", ",", "\[IndentingNewLine]", 
       RowBox[{"allRelations", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"guard", "=", 
        RowBox[{
         RowBox[{"Length", "@", "numbers"}], "+", "1"}]}]}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Only", " ", "to", " ", "avoid", " ", "infinite", " ", "loop", " ", 
        "if", " ", "something", " ", "goes", " ", "does", " ", "not", " ", 
        RowBox[{"work", "."}]}], " ", "*)"}], "\[IndentingNewLine]", "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"While", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Quiet", "[", 
           RowBox[{
            RowBox[{"Check", "[", 
             RowBox[{
              RowBox[{"relation", " ", "=", " ", 
               RowBox[{
               "FindMultiplicativeEltRelation", "[", "updatedNumbers", 
                "]"}]}], ",", "False", ",", 
              RowBox[{"FindMultiplicativeEltRelation", "::", "norelation"}]}],
              "]"}], ",", 
            RowBox[{"FindMultiplicativeEltRelation", "::", "norelation"}]}], 
           "]"}], "=!=", "False"}], "&&", " ", 
         RowBox[{"guard", ">", "0"}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"updatedNumbers", " ", "=", " ", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"updatedNumbers", ",", 
            RowBox[{
             RowBox[{"First", "@", "relation"}], "/.", 
             RowBox[{
              RowBox[{"MultElt", "[", "a_", "]"}], ":>", "a"}]}], ",", "1"}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"allRelations", "=", 
          RowBox[{"allRelations", "/.", "relation"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"allRelations", ",", " ", "relation"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"guard", "--"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"updatedNumbers", ",", "allRelations"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9579683593741474`*^9, 3.9579684662718506`*^9}, {
   3.9579687360045795`*^9, 3.9579687800816593`*^9}, {3.957968920446785*^9, 
   3.9579690356430397`*^9}, {3.957969216215662*^9, 3.9579693976426754`*^9}, {
   3.957969636743719*^9, 3.95796987586866*^9}, {3.9579700386089554`*^9, 
   3.9579700429974766`*^9}, {3.9579708215434284`*^9, 3.957970821773821*^9}, {
   3.9579708524990215`*^9, 3.9579708528186817`*^9}, {3.9579709150353985`*^9, 
   3.9579709270600185`*^9}, {3.9579712825858727`*^9, 
   3.9579713064414864`*^9}, {3.9579714941730824`*^9, 3.957971714003996*^9}, {
   3.957971889999445*^9, 3.9579719391637897`*^9}, 3.957971985480734*^9, {
   3.957972056408308*^9, 3.957972091162472*^9}, {3.957972131345581*^9, 
   3.9579721335358734`*^9}, 3.957972231814049*^9, {3.957972403356903*^9, 
   3.9579724163361835`*^9}, {3.957972496064579*^9, 3.95797250587129*^9}, {
   3.957972653680197*^9, 3.9579727173498383`*^9}, 3.9579727522894535`*^9, {
   3.957972816420103*^9, 3.9579728395238895`*^9}, {3.9579729112901955`*^9, 
   3.957972918160179*^9}, {3.957972962456459*^9, 3.9579731688815346`*^9}, {
   3.9579731989004173`*^9, 3.957973238012129*^9}, {3.9579732901482754`*^9, 
   3.957973314985298*^9}, {3.9579733794893265`*^9, 3.95797341484482*^9}, 
   3.9579736277447033`*^9, {3.957973961556692*^9, 3.957973989146248*^9}, {
   3.9579747713704815`*^9, 3.9579747747712975`*^9}, {3.9579748153290215`*^9, 
   3.957974902352375*^9}, {3.957975453756731*^9, 3.957975463156595*^9}, {
   3.9580095823445854`*^9, 3.9580096554946213`*^9}, {3.9580097953606644`*^9, 
   3.9580097998402367`*^9}, {3.9580098447207355`*^9, 3.95800984690926*^9}, {
   3.9580100248312855`*^9, 3.9580100522805443`*^9}, {3.958010093770605*^9, 
   3.9580101101252823`*^9}, 3.958010177109762*^9, {3.9580103368783627`*^9, 
   3.9580103751088047`*^9}, {3.9580104697143955`*^9, 3.958010470560232*^9}, {
   3.9580106453603*^9, 3.9580106508241463`*^9}, {3.9580123003105145`*^9, 
   3.9580123441997967`*^9}, {3.958012558261101*^9, 3.958012572103668*^9}, {
   3.958012736939579*^9, 3.958012744466896*^9}, {3.958012834027397*^9, 
   3.958012849705822*^9}, {3.958012945469158*^9, 3.958012946047924*^9}, {
   3.9580135733951015`*^9, 3.958013575363846*^9}, {3.958117138875738*^9, 
   3.9581171390497017`*^9}, 3.9595854225073433`*^9, {3.959585633439926*^9, 
   3.9595857162212105`*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"1356ea12-0dcf-524c-bdf4-46b860ef9d24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Beta2", "[", "expr_", "]"}], ":=", 
   RowBox[{"expr", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"D2", "[", "1", "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"D2", "[", "0", "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"D2", "[", "z_", "]"}], ":>", 
       RowBox[{
        RowBox[{"TensorProduct", "[", 
         RowBox[{
          RowBox[{"MultElt", "[", "z", "]"}], ",", 
          RowBox[{"MultElt", "[", 
           RowBox[{"1", "-", "z"}], "]"}]}], "]"}], "-", 
        RowBox[{"TensorProduct", "[", 
         RowBox[{
          RowBox[{"MultElt", "[", 
           RowBox[{"1", "-", "z"}], "]"}], ",", 
          RowBox[{"MultElt", "[", "z", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Beta3", "[", "expr_", "]"}], ":=", 
   RowBox[{"expr", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"D3", "[", "1", "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"D3", "[", "0", "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"D3", "[", "z_", "]"}], ":>", 
       RowBox[{
        RowBox[{"TensorProduct", "[", 
         RowBox[{
          RowBox[{"MultElt", "[", "z", "]"}], ",", 
          RowBox[{"MultElt", "[", "z", "]"}], ",", 
          RowBox[{"MultElt", "[", 
           RowBox[{"1", "-", "z"}], "]"}]}], "]"}], "-", 
        RowBox[{"TensorProduct", "[", 
         RowBox[{
          RowBox[{"MultElt", "[", "z", "]"}], ",", 
          RowBox[{"MultElt", "[", 
           RowBox[{"1", "-", "z"}], "]"}], ",", 
          RowBox[{"MultElt", "[", "z", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymmetrizeConjugateD2", "[", "expr_", "]"}], ":=", 
   RowBox[{"expr", "/.", 
    RowBox[{
     RowBox[{"D2", "[", "z_", "]"}], ":>", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D2", "[", "z", "]"}], "-", 
        RowBox[{"D2", "[", 
         RowBox[{"Conj", "[", "z", "]"}], "]"}]}], ")"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymmetrizeConjugateD3", "[", "expr_", "]"}], ":=", 
    RowBox[{"expr", "/.", 
     RowBox[{
      RowBox[{"D3", "[", "z_", "]"}], ":>", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"D3", "[", "z", "]"}], "+", 
         RowBox[{"D3", "[", 
          RowBox[{"Conj", "[", "z", "]"}], "]"}]}], ")"}]}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TensorSimplifyMultiplicativeNumbersOneStep", "[", "expr_", "]"}],
     ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numbers", ",", "rule"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"numbers", " ", "=", " ", 
        RowBox[{"Union", "@", 
         RowBox[{"Cases", "[", 
          RowBox[{"expr", ",", 
           RowBox[{
            RowBox[{"MultElt", "[", "a_", "]"}], ":>", "a"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "numbers"}], "==", "0"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"expr", ",", "Module"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"rule", " ", "=", 
        RowBox[{"Quiet", "[", 
         RowBox[{
          RowBox[{"Check", "[", 
           RowBox[{
            RowBox[{"FindMultiplicativeEltRelation", "[", "numbers", "]"}], ",",
             "None", ",", 
            RowBox[{"FindMultiplicativeEltRelation", "::", "norelation"}]}], 
           "]"}], ",", 
          RowBox[{"FindMultiplicativeEltRelation", "::", "norelation"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rule", "===", "None"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"expr", ",", "Module"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"TensorExpand", "[", 
        RowBox[{"expr", "/.", "rule"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorSimplifyMultiplicativeNumbers", "[", "expr_", "]"}], ":=", 
     RowBox[{"FixedPoint", "[", 
      RowBox[{"TensorSimplifyMultiplicativeNumbersOneStep", ",", "expr", ",", 
       RowBox[{"Length", "@", 
        RowBox[{"Union", "@", 
         RowBox[{"Cases", "[", 
          RowBox[{"expr", ",", 
           RowBox[{
            RowBox[{"MultElt", "[", "a_", "]"}], ":>", "a"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}]}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"numbersRemaining", "[", "expr_", "]"}], ":=", 
   RowBox[{"Length", "@", 
    RowBox[{"Union", "@", 
     RowBox[{"Cases", "[", 
      RowBox[{"expr", ",", 
       RowBox[{
        RowBox[{"MultElt", "[", "a_", "]"}], ":>", "a"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TensorSimplifyMultiplicativeNumbers", "[", "expr_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"temp", ",", " ", "result"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"temp", "=", 
        RowBox[{"PrintTemporary", "[", 
         RowBox[{"\"\<Different numbers remaining: \>\"", ",", 
          RowBox[{"numbersRemaining", "[", "expr", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"FixedPoint", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"NotebookDelete", "[", "temp", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"temp", "=", 
             RowBox[{"PrintTemporary", "[", 
              RowBox[{"\"\<Different numbers remaining: \>\"", ",", 
               RowBox[{"numbersRemaining", "[", "#", "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
            "TensorSimplifyMultiplicativeNumbersOneStep", "[", "#", "]"}]}], 
           "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "expr", ",",
           "\[IndentingNewLine]", 
          RowBox[{"Length", "@", 
           RowBox[{"Union", "@", 
            RowBox[{"Cases", "[", 
             RowBox[{"expr", ",", 
              RowBox[{
               RowBox[{"MultElt", "[", "a_", "]"}], ":>", "a"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NotebookDelete", "[", "temp", "]"}], ";", 
       "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "As", " ", "a", " ", "safeguard", " ", "agaings", " ", "infinite", " ", 
     "repitition", " ", "if", " ", "somethings", " ", "goes", " ", "wrong"}], 
    ",", " ", 
    RowBox[{
    "bound", " ", "the", " ", "maximum", " ", "iterations", " ", "by", " ", 
     "the", " ", "number", " ", "of", " ", "multiplicative", " ", 
     RowBox[{"elements", "."}]}]}], " ", "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.957974331876684*^9, 3.957974759625143*^9}, {
  3.957974950366068*^9, 3.957975058231386*^9}, {3.9579750933965836`*^9, 
  3.9579751543938484`*^9}, {3.9580095535078373`*^9, 3.9580095541484413`*^9}, {
  3.958010389013998*^9, 3.9580103948070393`*^9}, {3.9580109768247643`*^9, 
  3.958011185106594*^9}, {3.958012363183161*^9, 3.9580123634958725`*^9}, {
  3.95801303317507*^9, 3.958013066560877*^9}, {3.959601724007742*^9, 
  3.9596017827726345`*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"716241c2-921c-aa43-b59f-57656414d1af"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ElementOfG2", "[", "expr_", "]"}], ":=", 
   RowBox[{
    RowBox[{"TensorSimplifyMultiplicativeNumbers", "[", 
     RowBox[{"Beta2", "[", "expr", "]"}], "]"}], "==", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ElementOfA2", "[", "expr_", "]"}], ":=", 
    RowBox[{"ElementOfG2", "[", "expr", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ZeroInB2", "[", "expr_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"result", " ", "=", 
        RowBox[{"SimplifyAllTermsOneIteration", "[", 
         RowBox[{"expr", ",", "AllRelationsD2NoConj", ",", 
          RowBox[{"D2", "->", "sD2NoConj"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"True", "/;", 
       RowBox[{"result", "===", "0"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElementOfG3", "[", "expr_", "]"}], ":=", 
   RowBox[{
    RowBox[{"TensorSimplifyMultiplicativeNumbers", "[", 
     RowBox[{"Beta3", "[", "expr", "]"}], "]"}], "==", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElementOfA3", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "temp", ",", "\[IndentingNewLine]", "args", ",", "\[IndentingNewLine]", 
       "reducedArgs", ",", "\[IndentingNewLine]", "rules", ",", 
       "\[IndentingNewLine]", "homomorphisms", ",", "\[IndentingNewLine]", 
       "applyHomomorphism", ",", "\[IndentingNewLine]", 
       "dilogExpressionsToCheck", ",", "\[IndentingNewLine]", "result"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"temp", "=", 
       RowBox[{
       "PrintTemporary", "[", "\"\<Checking if expression is in G3...\>\"", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ElementOfG3", "[", "expr", "]"}], "!=", "True"}], ",", 
        RowBox[{
         RowBox[{
         "Print", 
          "[", "\"\<Cannot even prove that it is an element of G3.\>\"", 
          "]"}], ";", " ", 
         RowBox[{"Return", "[", 
          RowBox[{"False", ",", "Module"}], "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"NotebookDelete", "[", "temp", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"args", " ", "=", " ", 
       RowBox[{"Keys", "@", 
        RowBox[{"toAssoc", "[", 
         RowBox[{"expr", ",", "D3"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"reducedArgs", ",", "rules"}], "}"}], " ", "=", " ", 
       RowBox[{"ReduceDimensionMultiplicativeElt", "[", "args", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"homomorphisms", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"AssociationThread", "[", 
          RowBox[{"reducedArgs", "->", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{"Length", "@", "reducedArgs"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "reducedArgs"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"applyHomomorphism", "[", 
        RowBox[{"arg_", ",", "hom_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MultElt", "[", "arg", "]"}], "/.", "rules"}], ")"}], "/.", 
        RowBox[{
         RowBox[{"MultElt", "[", "a_", "]"}], ":>", 
         RowBox[{"hom", "[", "a", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dilogExpressionsToCheck", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"expr", "/.", 
          RowBox[{
           RowBox[{"D3", "[", "a_", "]"}], ":>", 
           RowBox[{
            RowBox[{"applyHomomorphism", "[", 
             RowBox[{"a", ",", "hom"}], "]"}], "*", 
            RowBox[{"D2", "[", "a", "]"}]}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"hom", ",", "homomorphisms"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"\"\<Checking that \>\"", ",", 
        RowBox[{"Length", "@", "dilogExpressionsToCheck"}], ",", 
        " ", "\"\< expressions are zero in B2...\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AllTrue", "[", 
       RowBox[{"dilogExpressionsToCheck", ",", "ZeroInB2"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.957975197111788*^9, 3.9579752919036827`*^9}, {
   3.9579754223427277`*^9, 3.9579754384174824`*^9}, 3.957975485566391*^9, {
   3.9580118832213364`*^9, 3.958011887413883*^9}, {3.958011926876791*^9, 
   3.958011975121689*^9}, 3.958012005482456*^9, {3.9580121722516613`*^9, 
   3.9580121808776855`*^9}, {3.958012219477669*^9, 3.958012259261936*^9}, {
   3.9580123796788425`*^9, 3.958012417705591*^9}, {3.958012786534094*^9, 
   3.958012792074028*^9}, {3.958013551966717*^9, 3.958013554280266*^9}, {
   3.9580139491633816`*^9, 3.9580139691388435`*^9}, {3.9580140927225*^9, 
   3.9580141307652893`*^9}, {3.958014163291889*^9, 3.958014192419161*^9}, {
   3.9580142897680473`*^9, 3.958014412599037*^9}, {3.958014477084467*^9, 
   3.958014519691408*^9}, {3.95801457059783*^9, 3.958014572770071*^9}, {
   3.959585805151472*^9, 3.959586005754772*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"12d9ad38-117f-0541-89da-4632c7804889"]
}, Closed]],

Cell[CellGroupData[{

Cell["Expand Tensor Of Rational Functions", "Subsection",
 CellChangeTimes->{{3.9595851286663914`*^9, 
  3.95958513655357*^9}},ExpressionUUID->"9b6ec48a-b93f-b34c-a5ab-\
1eb2db55ce97"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"multExpandRules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"HoldPattern", "[", 
       RowBox[{"MultElt", "[", 
        RowBox[{"Times", "[", "args__", "]"}], "]"}], "]"}], ":>", 
      RowBox[{"Total", "[", 
       RowBox[{"MultElt", "/@", 
        RowBox[{"{", "args", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"HoldPattern", "[", 
       RowBox[{"MultElt", "[", 
        RowBox[{"Power", "[", 
         RowBox[{"base_", ",", "exp_"}], "]"}], "]"}], "]"}], ":>", 
      RowBox[{"exp", "*", 
       RowBox[{"MultElt", "[", "base", "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MultElt", "[", "1", "]"}], "->", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MultElt", "[", 
       RowBox[{"-", "1"}], "]"}], "->", "0"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"isNegativePower", "[", "expr_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"NumericQ", "[", "expr", "]"}], ",", 
     RowBox[{"Negative", "[", "expr", "]"}], ",", "False"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"isNegativeMonomial", "[", "expr_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "expr", "]"}], "===", "Times"}], ",", 
     RowBox[{"isNegativePower", "[", 
      RowBox[{"First", "[", "expr", "]"}], "]"}], ",", 
     RowBox[{"isNegativePower", "[", "expr", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"isNegative", "[", "expr_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "expr", "]"}], "===", "Plus"}], ",", 
     RowBox[{"isNegativeMonomial", "[", 
      RowBox[{"First", "@", "expr"}], "]"}], ",", 
     RowBox[{"isNegativeMonomial", "[", "expr", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"torsionRule", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MultElt", "[", 
       RowBox[{"arg_", "?", "isNegative"}], "]"}], ":>", 
      RowBox[{"MultElt", "[", 
       RowBox[{"-", "arg"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorExpandRationalFunctions", "[", "expr_", "]"}], ":=", 
   RowBox[{"TensorExpand", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"expr", "/.", 
       RowBox[{
        RowBox[{"MultElt", "[", "x_", "]"}], ":>", 
        RowBox[{"MultElt", "[", 
         RowBox[{"Factor", "[", "x", "]"}], "]"}]}]}], "//.", 
      "multExpandRules"}], " ", "/.", "torsionRule"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9593086944753876`*^9, 3.959308746666979*^9}, {
   3.959308780379816*^9, 3.959308781754801*^9}, {3.9593088326539097`*^9, 
   3.9593088874032803`*^9}, {3.9593089360742264`*^9, 
   3.9593089571861916`*^9}, {3.9593090397458744`*^9, 
   3.9593090464646244`*^9}, {3.959309719711054*^9, 3.9593097868229046`*^9}, {
   3.959310004673727*^9, 3.959310011970587*^9}, {3.959310088238039*^9, 
   3.9593101786824055`*^9}, 3.959310219095148*^9, {3.959310523315258*^9, 
   3.959310523799635*^9}, 3.9593105750678387`*^9, {3.9593106480547924`*^9, 
   3.9593106611652317`*^9}, {3.959314201764002*^9, 3.959314259047859*^9}, {
   3.9593143594573593`*^9, 3.9593143685823574`*^9}, {3.959584390538351*^9, 
   3.959584397272642*^9}, {3.9595850136221313`*^9, 3.959585068763649*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"e400b4f3-ada6-a641-b173-2541a1cd82a1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"TensorExpandRationalFunctions", "[", 
    RowBox[{"Beta3", "[", 
     RowBox[{"ThreeTermRelationD3", "[", "x", "]"}], "]"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.959585195033201*^9, 3.9595852370391865`*^9}, {
  3.9595853891563587`*^9, 3.959585397500189*^9}},
 CellLabel->
  "In[247]:=",ExpressionUUID->"d62ef629-0ad4-3a42-9a20-0f672330e53e"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.9595852310900745`*^9, 3.9595852374847374`*^9}, 
   3.959585399771343*^9},
 CellLabel->
  "Out[247]=",ExpressionUUID->"55e5b8c8-3bed-6f4f-a6cc-5827b8556b59"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}], ",", 
   RowBox[{"TensorExpandRationalFunctions", "[", 
    RowBox[{"Beta3", "[", 
     RowBox[{"NineTermRelationD3", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.959585244253891*^9, 3.9595852679991913`*^9}},
 CellLabel->
  "In[236]:=",ExpressionUUID->"8f001c7a-9505-984c-bd3e-4812287b880c"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.9595852492251225`*^9, 3.9595852687630825`*^9}},
 CellLabel->
  "Out[236]=",ExpressionUUID->"63e22905-258e-9044-bd06-ef9972552b30"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
   RowBox[{"TensorExpandRationalFunctions", "[", 
    RowBox[{"Beta3", "[", 
     RowBox[{"TwentyTwoTermRelationD3", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], "]"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9595852772003555`*^9, 3.959585282356615*^9}},
 CellLabel->
  "In[237]:=",ExpressionUUID->"d9ac9cb9-0e8b-5b48-b63f-98b5aaff6ec5"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.9595852834292355`*^9},
 CellLabel->
  "Out[237]=",ExpressionUUID->"d4c9cbb4-7262-7044-859f-c7c1b5f38d2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}], ",", 
   RowBox[{"TensorExpandRationalFunctions", "[", 
    RowBox[{"Beta2", "[", 
     RowBox[{"FiveTermRelationD2", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.959585300258911*^9, 3.9595853356366215`*^9}},
 CellLabel->
  "In[242]:=",ExpressionUUID->"eb42c5bc-7b2b-894e-be0c-660174d5a05e"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.9595853125249367`*^9, 3.9595853359784756`*^9}},
 CellLabel->
  "Out[242]=",ExpressionUUID->"a4bd967e-0da2-4d44-8541-84b37a8bfca4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"TensorExpandRationalFunctions", "[", 
    RowBox[{"Beta2", "[", 
     RowBox[{"DuplicationRelationD2", "[", "x", "]"}], "]"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9595853419031143`*^9, 3.9595853504798374`*^9}},
 CellLabel->
  "In[245]:=",ExpressionUUID->"0fb8f9d3-4f1b-d44e-84da-acb8de7f5dba"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.9595853475137253`*^9, 3.959585356281143*^9}},
 CellLabel->
  "Out[245]=",ExpressionUUID->"09c941e6-c0fa-4742-bb44-b1550b49fdaa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"TensorExpandRationalFunctions", "[", 
    RowBox[{"Beta3", "[", 
     RowBox[{"DuplicationRelationD3", "[", "x", "]"}], "]"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9595853620815945`*^9, 3.9595853638676434`*^9}},
 CellLabel->
  "In[246]:=",ExpressionUUID->"212e4dab-7e8c-8846-aa29-3f7bddca8f67"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.9595853646601334`*^9},
 CellLabel->
  "Out[246]=",ExpressionUUID->"688566fc-a8b7-5243-bdd6-2df605907cf6"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Relation Generation", "Subsection",
 CellChangeTimes->{{3.959585151284916*^9, 
  3.9595851531801796`*^9}},ExpressionUUID->"216f03dd-6e47-f945-83ec-\
3cdfc89fc206"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Given", " ", "a", " ", "relation", " ", 
     RowBox[{"{", 
      RowBox[{"f", ",", " ", "n"}], "}"}], " ", "and", " ", "a", " ", "list", 
     " ", "of", " ", "arguments", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"z_", "1"}], ",", " ", "...", ",", " ", "z_k"}], "}"}]}], ",", 
    " ", 
    RowBox[{"returns", " ", "a", " ", "list", " ", "of", " ", 
     RowBox[{"f", "[", 
      RowBox[{
       RowBox[{"z_", 
        RowBox[{"{", 
         RowBox[{"i_", "1"}], "}"}]}], ",", " ", 
       RowBox[{"z_", 
        RowBox[{"{", 
         RowBox[{"i_", "2"}], "}"}]}], ",", " ", "...", ",", " ", 
       RowBox[{"z_", 
        RowBox[{"{", "i_n", "}"}]}]}], "]"}], " ", "for", " ", "all", " ", 
     "ordered", " ", "tuples", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"i_", "1"}], ",", "...", ",", "i_m"}], ")"}], " ", "in", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "...", ",", "k"}], "}"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"generateRelationsForOneRel", "[", 
      RowBox[{"listOfArguments_", ",", "relation_"}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"relationFunction", "=", 
          RowBox[{"relation", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"numberOfInputs", "=", 
          RowBox[{"relation", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], "@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"relationFunction", "@@", "#"}], "&"}], ",", 
            RowBox[{"Subsets", "[", 
             RowBox[{"listOfArguments", ",", 
              RowBox[{"{", "numberOfInputs", "}"}]}], "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Nothing", "+", "_"}], "->", "Nothing"}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "The", " ", "replace", " ", "is", " ", "there", " ", "to", " ", "handle", 
     " ", "the", " ", "case", " ", "where", " ", "a", " ", "relation", " ", 
     "returns", " ", "Nothing", " ", "but", " ", "the", " ", "certificate", " ",
      "was", " ", 
     RowBox[{"added", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"NOTE", ":", " ", 
      RowBox[{"weirdly", " ", "enough"}]}], ",", " ", 
     RowBox[{
      RowBox[{"defining", " ", "monitor"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], " ",
        "and", " ", "then", " ", "using", " ", "monitor", " ", "does", " ", 
       "not", " ", "work"}]}], ",", " ", 
     RowBox[{
     "then", " ", "map", " ", "gets", " ", "evaluated", " ", "before", " ", 
      "the", " ", "pattern", " ", "for", " ", 
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], " ",
        "[", 
       RowBox[{"Map", "[", "...", "]"}], "]"}], " ", "is", " ", 
      RowBox[{"applied", ".", " ", "Do"}], " ", "not", " ", "fully", " ", 
      "understand", " ", 
      RowBox[{"this", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "is", " ", "a", " ", "bit", " ", "inefficient", " ", 
      "because", " ", "the", " ", "large", " ", "list", " ", "of", " ", 
      "subsets", " ", "is", " ", "generated", " ", "at", " ", "once", " ", 
      "even", " ", "though", " ", "it", " ", "is", " ", "not", " ", 
      RowBox[{"needed", ".", " ", "An"}], " ", "iterative", " ", "approach", " ",
       "would", " ", "be", " ", "better"}], ",", " ", 
     RowBox[{
     "but", " ", "somehow", " ", "mathematica", " ", "is", " ", "not", " ", 
      "build", " ", "for", " ", 
      RowBox[{"this", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"generateRelations", "[", 
      RowBox[{"listOfArguments_", ",", " ", "listOfRelations_"}], "]"}], ":=", 
     RowBox[{"Join", "@@", 
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"generateRelationsForOneRel", "[", 
           RowBox[{"listOfArguments", ",", " ", "#"}], "]"}], "&"}], ",", 
         "listOfRelations"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"generateRelations", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"f", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"g", ",", "1"}], "}"}]}], "}"}]}], "]"}], " ", "gives", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"a", ",", "b"}], "]"}], ",", 
       RowBox[{"f", "[", 
        RowBox[{"a", ",", "c"}], "]"}], ",", 
       RowBox[{"f", "[", 
        RowBox[{"b", ",", "c"}], "]"}], ",", 
       RowBox[{"g", "[", "a", "]"}], ",", 
       RowBox[{"g", "[", "b", "]"}], ",", 
       RowBox[{"g", "[", "c", "]"}]}], "}"}]}], " ", "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9600086940303383`*^9, 
  3.9600088316274567`*^9}},ExpressionUUID->"005ff800-526a-f04f-bd7c-\
225d7a28bd6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Greedy Local Search Simplification", "Subsection",
 CellChangeTimes->{{3.9580083141818333`*^9, 3.958008318591215*^9}, {
  3.95957422322785*^9, 
  3.959574228024803*^9}},ExpressionUUID->"e334979b-a1f6-1745-92dc-\
225443990618"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "This", " ", "takes", " ", "to", " ", "associations", " ", "of", " ", 
      "the", " ", "form", " ", 
      RowBox[{"(", 
       RowBox[{"argument", " ", "of", " ", "Li2"}], ")"}]}], " ", "->", " ", 
     "coefficient"}], ",", " ", 
    RowBox[{
    "one", " ", "for", " ", "the", " ", "target", " ", "expression", " ", 
     "and", " ", "one", " ", "for", " ", "the", " ", 
     RowBox[{"relation", ".", " ", "If"}], " ", "computes", " ", "the", " ", 
     "optimal", " ", "multiple", " ", "of", " ", "the", " ", "relation", " ", 
     "that", " ", "should", " ", "be", " ", "subtracted", " ", "to", " ", 
     "reduce", " ", "the", " ", "number", " ", "of", " ", 
     RowBox[{"terms", ".", " ", "In"}], " ", "most", " ", "cases"}], ",", " ", 
    RowBox[{"this", " ", "will", " ", "be", " ", "0"}], ",", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "the"}], " ", "relation", " ", "cannot",
      " ", "be", " ", "used", " ", "to", " ", 
     RowBox[{"simplify", ".", " ", "The"}], " ", "module", " ", "returns", " ",
      "a", " ", "list", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "optimal", " ", "multiple", " ", "of", " ", "relation", " ", "to", " ",
         "subtract"}], ",", " ", 
       RowBox[{
        RowBox[{
        "number", " ", "of", " ", "Li2", " ", "terms", " ", "that", " ", 
         "will", " ", "vanish", " ", "in", " ", "total", " ", "after", " ", 
         "subtracting", " ", "the", " ", "relation"}], " ", "=", 
        RowBox[{":", " ", 
         RowBox[{"reduction", " ", "number"}]}]}]}], "}"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"optimalMultipleForReduction", "[", 
      RowBox[{"targetAssoc_", ",", "relationAssoc_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"quotients", ",", " ", "optimalMultiple"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "relationAssoc"}], "==", "0"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", "Module"}], "]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"quotients", "=", 
         RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"relArg", ",", "relCoeff"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"KeyExistsQ", "[", 
                RowBox[{"targetAssoc", ",", "relArg"}], "]"}], ",", 
               FractionBox[
                RowBox[{"Lookup", "[", 
                 RowBox[{"targetAssoc", ",", "relArg"}], "]"}], "relCoeff"], ",",
                "0"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
           "relationAssoc"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"optimalMultiple", "=", 
         RowBox[{"First", "@", 
          RowBox[{"Commonest", "[", 
           RowBox[{"quotients", ",", "1"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"optimalMultiple", ",", " ", 
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"quotients", ",", "optimalMultiple"}], "]"}], "-", 
           RowBox[{"Count", "[", 
            RowBox[{"quotients", ",", "0"}], "]"}]}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"TODO", ":", " ", 
      RowBox[{"as", " ", "it", " ", "stands"}]}], ",", " ", 
     RowBox[{
     "depends", " ", "on", " ", "the", " ", "order", " ", "of", " ", "the", " ",
       "association", " ", "and", " ", "if", " ", "a", " ", "multiple", " ", 
      "can", " ", "be", " ", "subtracted", " ", "without", " ", "changing", " ",
       "number", " ", "of", " ", "terms"}], ",", " ", 
     RowBox[{
     "is", " ", "not", " ", "determined", " ", "wether", " ", "0", " ", "or", 
      " ", "a", " ", "nonzero", " ", "multiple", " ", "will", " ", "be", " ", 
      RowBox[{"returned", "."}]}]}], " ", "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.950440028116705*^9, 3.950440078342924*^9}, {
  3.950441536087778*^9, 3.950441570951931*^9}, {3.950582442075569*^9, 
  3.950582483367626*^9}, {3.950582716473543*^9, 3.950582798368965*^9}, {
  3.9505828437157364`*^9, 3.950582915188484*^9}, {3.9505829646130447`*^9, 
  3.9505831580447216`*^9}, {3.9505832283299694`*^9, 3.9505832619879246`*^9}, {
  3.9505834561075363`*^9, 3.9505835235491543`*^9}, {3.950584329590914*^9, 
  3.9505843333879986`*^9}, {3.959481568853121*^9, 3.959481579053196*^9}, {
  3.9600089544192333`*^9, 3.9600089743571415`*^9}, {3.960012961551527*^9, 
  3.9600129622702885`*^9}},ExpressionUUID->"8cbb8fb1-6383-264d-93b1-\
26c893497b04"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "greedySimplifyOneStep", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"ReturnCertificate", "->", "False"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"greedySimplifyOneStep", "[", 
    RowBox[{"expr_", ",", "listOfRelations_", ",", 
     RowBox[{"function_", "->", "symmetrisedFunction_"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "exprSymm", ",", "\[IndentingNewLine]", "targetAssoc", ",", 
       "\[IndentingNewLine]", "relations", ",", "\[IndentingNewLine]", 
       "relationAssocs", ",", "\[IndentingNewLine]", 
       "optimalMultiplesAndReductionNums", ",", "\[IndentingNewLine]", 
       "reductionNums", ",", "\[IndentingNewLine]", "maxReductionNum", ",", 
       "\[IndentingNewLine]", "indicesOfRelationsYieldingBestReduction", ",", 
       "\[IndentingNewLine]", "chosenIndex", ",", "\[IndentingNewLine]", 
       "multiple", ",", "\[IndentingNewLine]", "listOfRelationsCert"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"listOfRelationsCert", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "ReturnCertificate", "]"}], ",", 
         RowBox[{"addAllCertificates", "@", "listOfRelations"}], ",", 
         "listOfRelations"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"exprSymm", "=", 
       RowBox[{"Collect", "[", 
        RowBox[{
         RowBox[{"expr", "/.", 
          RowBox[{"function", "->", "symmetrisedFunction"}]}], ",", 
         RowBox[{"function", "[", "_", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"targetAssoc", "=", 
       RowBox[{"toAssoc", "[", 
        RowBox[{"exprSymm", ",", "function"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"\"\<Generating relations on \>\"", ",", 
        RowBox[{"Length", "@", 
         RowBox[{"Keys", "@", "targetAssoc"}]}], ",", 
        " ", "\"\< numbers\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"relations", "=", 
       RowBox[{"generateRelations", "[", 
        RowBox[{
         RowBox[{"Keys", "@", "targetAssoc"}], ",", "listOfRelationsCert"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"relations", " ", "=", " ", 
       RowBox[{"relations", "/.", 
        RowBox[{"function", "->", "symmetrisedFunction"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"relationAssocs", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"toAssoc", "[", 
          RowBox[{"#", ",", "function"}], "]"}], "&"}], "/@", "relations"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"optimalMultiplesAndReductionNums", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"optimalMultipleForReduction", "[", 
          RowBox[{"targetAssoc", ",", "#"}], "]"}], "&"}], "/@", 
        "relationAssocs"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reductionNums", "=", 
       RowBox[{"optimalMultiplesAndReductionNums", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxReductionNum", "=", 
       RowBox[{"Max", "[", "reductionNums", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"maxReductionNum", "==", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<No one-step simplification found.\>\"", "]"}], 
          ";"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"exprSymm", ",", "Module"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"\"\<Subtracting relation to reduce the number of terms by \
\>\"", ",", " ", "maxReductionNum", ",", "\"\<.\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"indicesOfRelationsYieldingBestReduction", " ", "=", " ", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Position", "[", 
         RowBox[{"reductionNums", ",", "maxReductionNum"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<There are \>\"", ",", " ", "\[IndentingNewLine]", 
          RowBox[{"Length", "@", "indicesOfRelationsYieldingBestReduction"}], 
          ",", " ", 
          "\[IndentingNewLine]", "\"\< relations that will reduce the number \
of terms by \>\"", ",", "\[IndentingNewLine]", "maxReductionNum", ",", " ", 
          "\[IndentingNewLine]", "\"\<. Choosing the first one arbitrarily.\>\
\""}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"chosenIndex", " ", "=", " ", 
       RowBox[{"First", "@", "indicesOfRelationsYieldingBestReduction"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"multiple", " ", "=", " ", 
       RowBox[{"optimalMultiplesAndReductionNums", "[", 
        RowBox[{"[", 
         RowBox[{"chosenIndex", ",", " ", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Subtracting \>\"", ",", " ", 
          RowBox[{"multiple", "*", 
           RowBox[{"relations", "[", 
            RowBox[{"[", "chosenIndex", "]"}], "]"}]}], ",", "\"\<.\>\""}], 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"exprSymm", "-", 
       RowBox[{"Expand", "[", 
        RowBox[{"multiple", "*", 
         RowBox[{"relations", "[", 
          RowBox[{"[", "chosenIndex", "]"}], "]"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GreedySimplify", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"ReturnCertificate", "->", "False"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GreedySimplify", "[", 
    RowBox[{"expr_", ",", "listOfRelations_", ",", 
     RowBox[{"function_", "->", "symmetrisedFunction_"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"FixedPoint", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"greedySimplifyOneStep", "[", 
       RowBox[{"#", ",", "listOfRelations", ",", 
        RowBox[{"function", "->", "symmetrisedFunction"}], ",", 
        RowBox[{"ReturnCertificate", "->", 
         RowBox[{"OptionValue", "[", "ReturnCertificate", "]"}]}]}], "]"}], 
      "&"}], ",", "\[IndentingNewLine]", "expr", ",", "\[IndentingNewLine]", 
     RowBox[{"Length", "@", 
      RowBox[{"toAssoc", "[", 
       RowBox[{"expr", ",", "function"}], "]"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9505839856980343`*^9, 3.9505839995574875`*^9}, {
   3.9505840301700535`*^9, 3.95058403066971*^9}, {3.950584153191572*^9, 
   3.950584243601654*^9}, {3.9505843069329624`*^9, 3.9505843714683113`*^9}, {
   3.95058442547064*^9, 3.9505844591917477`*^9}, {3.9505845038821163`*^9, 
   3.9505847277224827`*^9}, {3.950584897589966*^9, 3.9505850498642044`*^9}, 
   3.950585490015934*^9, {3.9506120965665073`*^9, 3.9506121080713863`*^9}, {
   3.9506898775754795`*^9, 3.9506899071430492`*^9}, {3.9564838717461796`*^9, 
   3.956483884270748*^9}, {3.9564932599796333`*^9, 3.956493290742428*^9}, {
   3.9564933655840263`*^9, 3.9564933992429256`*^9}, {3.95800834045002*^9, 
   3.9580084872977695`*^9}, {3.9580085753927975`*^9, 
   3.9580085947321568`*^9}, {3.959481294842907*^9, 3.9594812982927513`*^9}, {
   3.9595740693230133`*^9, 3.959574144360922*^9}, {3.9595741810567627`*^9, 
   3.9595741980405846`*^9}, {3.959574363164171*^9, 3.9595743859982166`*^9}, {
   3.959574434859892*^9, 3.9595745201824074`*^9}, {3.9595745738033104`*^9, 
   3.959574621860037*^9}, {3.959575487058525*^9, 3.9595754907244415`*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"457bbd32-f6c3-cf44-a4fa-00bdb30aac1e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Seperate Into Zero Subexpressions Numerically", "Subsection",
 CellChangeTimes->{{3.958008612437502*^9, 3.958008616245329*^9}, {
  3.958008807722166*^9, 3.958008807889021*^9}, {3.9595742328059025`*^9, 
  3.9595742408212013`*^9}},ExpressionUUID->"3190ae1c-fcad-c64f-8587-\
93b47847617f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"seperateZeroSubexpressionOneStep", "[", 
     RowBox[{"expr_", ",", 
      RowBox[{"function_", "->", "symmetrisedFunction_"}], ",", 
      "numericalFunction_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "exprSymm", ",", "\[IndentingNewLine]", "targetAssoc", ",", 
        "\[IndentingNewLine]", "relation", ",", "\[IndentingNewLine]", 
        "multiple", ",", "\[IndentingNewLine]", "functionTermsList", ",", 
        "\[IndentingNewLine]", "nullVector"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"exprSymm", "=", 
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{"expr", "/.", 
           RowBox[{"function", "->", "symmetrisedFunction"}]}], ",", 
          RowBox[{"function", "[", "_", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"targetAssoc", "=", 
        RowBox[{"toAssoc", "[", 
         RowBox[{"exprSymm", ",", "function"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "targetAssoc"}], "==", "0"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"exprSymm", ",", "Module"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"functionTermsList", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"function", ",", 
          RowBox[{"Keys", "@", "targetAssoc"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nullVector", " ", "=", 
        RowBox[{"Quiet", "@", 
         RowBox[{"Check", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"FindIntegerNullVector", "[", 
            RowBox[{"functionTermsList", "/.", 
             RowBox[{"function", "->", "numericalFunction"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "Print", "[", "\"\<No integer nullvector found.\>\"", "]"}], ";", 
            RowBox[{"Return", "[", 
             RowBox[{"exprSymm", ",", "Module"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"FindIntegerNullVector", "::", "rnfu"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"relation", "=", 
        RowBox[{"nullVector", ".", "functionTermsList"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"multiple", "=", 
        RowBox[{"First", "@", 
         RowBox[{"optimalMultipleForReduction", "[", 
          RowBox[{"targetAssoc", ",", 
           RowBox[{"toAssoc", "[", 
            RowBox[{"relation", ",", "function"}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Subtracting \>\"", ",", " ", 
         RowBox[{"multiple", "*", "relation"}], ",", "\"\<.\>\""}], "]"}], ";",
        " ", "\[IndentingNewLine]", 
       RowBox[{"exprSymm", "-", 
        RowBox[{"Expand", "[", 
         RowBox[{"multiple", "*", "relation"}], "]"}], "+", 
        RowBox[{"multiple", "*", 
         RowBox[{"ZeroExpression", "[", "relation", "]"}]}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SeperateZeroSubexpression", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"function_", "->", "symmetrisedFunction_"}], ",", 
     "numericalFunction_"}], "]"}], ":=", 
   RowBox[{"FixedPoint", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"seperateZeroSubexpressionOneStep", "[", 
       RowBox[{"#", ",", 
        RowBox[{"function", "->", "symmetrisedFunction"}], ",", 
        "numericalFunction"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
     "expr", ",", "\[IndentingNewLine]", "13"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9580086192476788`*^9, 3.9580086227365913`*^9}, {
  3.95800865904278*^9, 3.9580086623431225`*^9}, {3.9595740036945934`*^9, 
  3.959574011706541*^9}, {3.959574149044945*^9, 3.959574184704172*^9}},
 CellLabel->
  "In[183]:=",ExpressionUUID->"d19440ed-073f-2e49-8780-b28d24cdb607"]
}, Closed]],

Cell[CellGroupData[{

Cell["Simplify all Terms in One Iteration", "Subsection",
 CellChangeTimes->{{3.9580086974945087`*^9, 3.9580087168394604`*^9}, {
  3.959575925118637*^9, 
  3.9595759343640785`*^9}},ExpressionUUID->"3d177c16-421c-e042-97f1-\
13276ae87076"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SimplifyAllTermsOneIteration", "::", "nosol"}], " ", "=", 
   " ", "\"\<No solution found.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SimplifyAllTermsOneIteration", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"ReturnCertificate", "->", "False"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimplifyAllTermsOneIteration", "[", 
    RowBox[{"expr_", ",", "listOfRelations_", ",", 
     RowBox[{"function_", "->", "symmetrisedFunction_"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "exprSymm", ",", "\[IndentingNewLine]", "targetAssoc", ",", 
       "\[IndentingNewLine]", "relations", ",", "\[IndentingNewLine]", 
       "relationAssocs", ",", "\[IndentingNewLine]", "allArguments", ",", 
       "\[IndentingNewLine]", "argumentToIndex", ",", "\[IndentingNewLine]", 
       "targetVector", ",", "\[IndentingNewLine]", "relationVectors", ",", 
       "\[IndentingNewLine]", "relationMatrix", ",", "\[IndentingNewLine]", 
       "solutionVector", ",", "\[IndentingNewLine]", "listOfRelationsCert"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"listOfRelationsCert", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "ReturnCertificate", "]"}], ",", 
         RowBox[{"addAllCertificates", "@", "listOfRelations"}], ",", 
         "listOfRelations"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "put", " ", "expr", " ", "in", " ", "association", " ", "form", " ", 
        "and", " ", "generate", " ", "relations", " ", "for", " ", "all", " ",
         "appearing", " ", "arguments"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"exprSymm", "=", 
       RowBox[{"Collect", "[", 
        RowBox[{
         RowBox[{"expr", "/.", 
          RowBox[{"function", "->", "symmetrisedFunction"}]}], ",", 
         RowBox[{"function", "[", "_", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"targetAssoc", "=", 
       RowBox[{"toAssoc", "[", 
        RowBox[{"exprSymm", ",", "function"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "targetAssoc"}], "==", "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"exprSymm", ",", "Module"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"relations", "=", 
       RowBox[{"generateRelations", "[", 
        RowBox[{
         RowBox[{"Keys", "@", "targetAssoc"}], ",", "listOfRelationsCert"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"relations", "=", 
       RowBox[{"relations", "/.", 
        RowBox[{"function", "->", "symmetrisedFunction"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"relationAssocs", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"toAssoc", "[", 
          RowBox[{"#", ",", "function"}], "]"}], "&"}], "/@", "relations"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "create", " ", "an", " ", "association", " ", "that", " ", 
        "associates", " ", "to", " ", "each", " ", "argument", " ", "an", " ",
         "index"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"allArguments", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"Keys", "@", "targetAssoc"}], ",", 
         RowBox[{"Union", "@@", 
          RowBox[{"(", 
           RowBox[{"Keys", "/@", "relationAssocs"}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"argumentToIndex", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"allArguments", "->", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "allArguments", "]"}], "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "use", " ", "the", " ", "argumentToIndex", " ", "association", " ", 
        "to", " ", "make", " ", "the", " ", "association", " ", "to", " ", 
        "arrayRules", " ", "which", " ", "can", " ", "directly", " ", "be", " ",
         "converted", " ", "to", " ", "sparse", " ", "arrays"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"targetVector", " ", "=", " ", 
       RowBox[{"SparseArray", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Normal", "@", 
          RowBox[{"KeyMap", "[", 
           RowBox[{"argumentToIndex", ",", "targetAssoc"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Length", "@", "allArguments"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"relationVectors", "=", 
       RowBox[{
        RowBox[{"KeyMap", "[", "argumentToIndex", "]"}], "/@", 
        "relationAssocs"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"relationMatrix", " ", "=", " ", 
       RowBox[{"SparseArray", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Flatten", "@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", "#"}], "}"}], "->", 
               RowBox[{
                RowBox[{"relationVectors", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", "#", "]"}]}], "&"}], "/@", 
             RowBox[{"Keys", "[", 
              RowBox[{"relationVectors", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "relationVectors", "]"}]}], "}"}]}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "@", "relations"}], ",", 
           RowBox[{"Length", "@", "allArguments"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"solutionVector", "=", 
       RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Check", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"LinearSolve", "[", 
            RowBox[{
             RowBox[{"Transpose", "@", "relationMatrix"}], ",", 
             "targetVector"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{"SimplifyAllTermsOneIteration", "::", "nosol"}], "]"}], ";",
             " ", 
            RowBox[{"Return", "[", 
             RowBox[{"exprSymm", ",", "Module"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"LinearSolve", "::", "nosol"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LinearSolve", "::", "nosol"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"exprSymm", " ", "-", " ", 
       RowBox[{"Expand", "[", 
        RowBox[{"solutionVector", ".", "relations"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.958008736948557*^9, 3.958008757974407*^9}, {
  3.958013684922062*^9, 3.958013697314455*^9}, {3.9595759367482758`*^9, 
  3.9595759878770924`*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"1eef44e1-4b1e-6448-b7f8-25f5933cae3b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Simplify all Terms in Multiple Iterations", "Subsection",
 CellChangeTimes->{{3.9580088402128296`*^9, 3.958008847005789*^9}, {
  3.9595760538435745`*^9, 
  3.9595760605129986`*^9}},ExpressionUUID->"5e899738-4de8-7345-a0b1-\
c7cd5e11a9d0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NewArgumentsFirstIteration", "[", 
    RowBox[{"targetAssoc_", ",", 
     RowBox[{"{", "}"}]}], "]"}], ":=", 
   RowBox[{"Keys", "@", "targetAssoc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NewArgumentsSecondIterationAll", "[", 
     RowBox[{"targetAssoc_", ",", 
      RowBox[{"{", "relationAssocs_", "}"}]}], "]"}], ":=", 
    RowBox[{"Union", "[", 
     RowBox[{
      RowBox[{"Keys", "@", "targetAssoc"}], ",", 
      RowBox[{"Union", "@@", 
       RowBox[{"Map", "[", 
        RowBox[{"Keys", ",", "relationAssocs"}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"containsFewNewTermsQ", "[", 
     RowBox[{"relationAssoc_", ",", "maxIndexOfOldArgs_", ",", "cutoff_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"Length", "@", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Keys", "@", "relationAssoc"}], ",", 
        RowBox[{
         RowBox[{"#", ">", "maxIndexOfOldArgs"}], "&"}]}], "]"}]}], "<=", 
     "cutoff"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NewArgumentsSecondIterationWithCutoff", "[", 
     RowBox[{"targetAssoc_", ",", 
      RowBox[{"{", "relationAssocs_", "}"}], ",", "cutoff_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"goodRelations", ",", "maxIndexOfTarget"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"maxIndexOfTarget", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Keys", "@", "targetAssoc"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"goodRelations", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"relationAssocs", ",", 
          RowBox[{
           RowBox[{"containsFewNewTermsQ", "[", 
            RowBox[{"#", ",", "maxIndexOfTarget", ",", "cutoff"}], "]"}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"Keys", "@", "targetAssoc"}], ",", 
         RowBox[{"Union", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{"Keys", ",", "goodRelations"}], "]"}]}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"addOffsetToArrayRules", "[", 
     RowBox[{"arrayRules_", ",", "offset_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "offset"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "->", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "&"}], "/@", 
     "arrayRules"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LinearSolveStandard", "::", "nosol"}], 
   "=", "\"\<No solution.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LinearSolveStandard", "[", 
     RowBox[{"targetAssoc_", ",", "listOfRelationAssocs_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "numberOfArguments", ",", "offsets", ",", "targetVector", ",", 
        "allRelations", ",", "relationMatrix", ",", "solution"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"numberOfArguments", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"Keys", "/@", "relationAssocs"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"relationAssocs", ",", "listOfRelationAssocs"}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"offsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"Accumulate", "[", 
           RowBox[{"Length", "/@", "listOfRelationAssocs"}], "]"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"targetVector", " ", "=", " ", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "targetAssoc", "]"}], ",", 
          RowBox[{"Last", "@", "numberOfArguments"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allRelations", "=", 
        RowBox[{"Join", "@@", "listOfRelationAssocs"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"relationMatrix", " ", "=", 
        RowBox[{"SparseArray", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"j", ",", "#"}], "}"}], "->", 
                 RowBox[{
                  RowBox[{"allRelations", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
               RowBox[{"Keys", "[", 
                RowBox[{"allRelations", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", "allRelations", "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", "allRelations", "]"}], ",", 
            RowBox[{"Last", "@", "numberOfArguments"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Calling LinearSolve on matrix with dimension \>\"", ",", 
         "  ", 
         RowBox[{"Dimensions", "[", "relationMatrix", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"solution", " ", "=", " ", 
        RowBox[{"Quiet", "[", 
         RowBox[{
          RowBox[{"Check", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"LinearSolve", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", "relationMatrix"}], ",", 
              "targetVector"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Message", "[", 
              RowBox[{"LinearSolveStandard", "::", "nosol"}], "]"}], ";", " ", 
             RowBox[{"Return", "[", 
              RowBox[{"None", ",", "Module"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"LinearSolve", "::", "nosol"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"LinearSolve", "::", "nosol"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"solution", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"offsets", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ";;", 
            RowBox[{"offsets", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "@", "listOfRelationAssocs"}]}], "}"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "solves", " ", "a", " ", "linear", " ", "system", " ", 
     "while", " ", "only", " ", "considering", " ", "good", " ", "numbers", " ",
      "and", " ", "relations"}], ",", " ", 
    RowBox[{
    "in", " ", "the", " ", "sense", " ", "defined", " ", "by", " ", "the", " ",
      "function", " ", 
     RowBox[{"above", ".", " ", "A"}], " ", "cutoff", " ", "of", " ", "1", " ",
      "is", " ", "garuanteed", " ", "to", " ", "find", " ", "a", " ", 
     "solution", " ", "if", " ", "it", " ", "exists", " ", 
     RowBox[{"(", 
      RowBox[{
      "because", " ", "a", " ", "relation", " ", "containing", " ", "a", " ", 
       "number", " ", "that", " ", "does", " ", "not", " ", "appear", " ", 
       "in", " ", "any", " ", "other", " ", "relation", " ", "is", " ", 
       "useless"}], ")"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"linearSolveDiscardRelationsWithRareArguments", "[", 
    RowBox[{"relMatrix_", ",", " ", "target_", ",", " ", 
     RowBox[{"cutoff_", ":", "1"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "goodNumbers", ",", "goodRelations", ",", " ", "goodRelMatrix", ",", 
       "goodTarget", ",", " ", "goodSolution", ",", " ", "totalSolution", ",",
        "maxIndexInTarget"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "We", " ", "do", " ", "not", " ", "want", " ", "to", " ", "discard", " ",
        "numbers", " ", "appearing", " ", "in", " ", "the", " ", 
       RowBox[{"targetVector", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"maxIndexInTarget", " ", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Keys", "[", 
          RowBox[{
           RowBox[{"ArrayRules", "[", "target", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", 
             RowBox[{"-", "2"}]}], "]"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"goodNumbers", ",", "goodRelations"}], "}"}], " ", "=", " ", 
       RowBox[{"getGoodNumbersAndRels", "[", 
        RowBox[{"relMatrix", ",", "maxIndexInTarget", ",", "cutoff"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<original dimension \>\"", ",", " ", 
        RowBox[{"Dimensions", "[", "relMatrix", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<new \>\"", ",", " ", 
        RowBox[{"Length", "@", "goodRelations"}], ",", "\"\< \>\"", ",", 
        RowBox[{"Length", "@", "goodNumbers"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"goodRelMatrix", " ", "=", " ", 
       RowBox[{"relMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"goodRelations", ",", "goodNumbers"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"goodTarget", " ", "=", " ", 
       RowBox[{"target", "[", 
        RowBox[{"[", "goodNumbers", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Calling LinearSolve on matrix with dimension \>\"", ",", 
        RowBox[{"Dimensions", "[", "goodRelMatrix", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"goodSolution", " ", "=", " ", 
       RowBox[{"LinearSolve", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "goodRelMatrix", "]"}], ",", 
         "goodTarget"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "goodSolution", "]"}], "===", "LinearSolve"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<No solution.\>\"", "]"}], ";", 
         RowBox[{"Return", "[", 
          RowBox[{"Nothing", ",", " ", "Module"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Solution found.\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"totalSolution", " ", "=", " ", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"Length", "[", "relMatrix", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"totalSolution", "[", 
        RowBox[{"[", "goodRelations", "]"}], "]"}], "=", " ", 
       "goodSolution"}], ";", "\[IndentingNewLine]", "totalSolution"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"TODO", ":", " ", 
    RowBox[{
    "test", " ", "the", " ", "fast", " ", "functions", " ", "from", " ", 
     "package", " ", "v1", " ", "and", " ", "put", " ", "them", " ", 
     RowBox[{"here", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getGoodNumbersAndRels", "[", 
    RowBox[{"relMatrix_", ",", " ", "numbersToKeep_", ",", " ", 
     RowBox[{"cutoff_", ":", "1"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "goodNumbers", ",", "badNumbers", ",", "goodRelations", ",", 
       "badRelations", ",", " ", "maxIndexInTarget"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"goodNumbers", "=", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", "relMatrix", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "<=", "numbersToKeep"}], "||", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"relMatrix", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "#"}], "]"}], "]"}], ")"}], 
               "[", "\"\<NonzeroValues\>\"", "]"}], "]"}], ">", "cutoff"}]}], 
           "&"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"badNumbers", " ", "=", "  ", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"Dimensions", "[", "relMatrix", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "goodNumbers"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"badRelations", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Keys", "[", 
          RowBox[{
           RowBox[{"ArrayRules", "[", 
            RowBox[{"relMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "badNumbers"}], "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", 
             RowBox[{"-", "2"}]}], "]"}], "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
        "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"goodRelations", " ", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "relMatrix", "]"}], "]"}], ",", 
         "badRelations"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"goodNumbers", ",", "goodRelations"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LinearSolveWithCutoff", "[", 
    RowBox[{
    "targetAssoc_", ",", "listOfRelationAssocs_", ",", 
     "maxNewArgumentsInRelation_", ",", "minRelationsWithArgument_"}], "]"}], 
   ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "numberOfArguments", ",", "\[IndentingNewLine]", 
       "numbersOfArgumentsWithTarget", ",", "\[IndentingNewLine]", "offsets", 
       ",", "\[IndentingNewLine]", "offsetsForGoodRelations", ",", 
       "\[IndentingNewLine]", "targetVector", ",", "\[IndentingNewLine]", 
       "goodRelationsIndices", ",", "\[IndentingNewLine]", "allRelations", ",",
        "\[IndentingNewLine]", "relationMatrix", ",", "\[IndentingNewLine]", 
       "solution", ",", "\[IndentingNewLine]", "solutionVectors", ",", 
       "\[IndentingNewLine]", "totalSolution"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numberOfArguments", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"Keys", "/@", "relationAssocs"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"relationAssocs", ",", "listOfRelationAssocs"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"numbersOfArgumentsWithTarget", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Max", "@", 
          RowBox[{"Keys", "[", "targetAssoc", "]"}]}], ",", 
         "numberOfArguments"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"offsets", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"Accumulate", "[", 
          RowBox[{"Length", "/@", "listOfRelationAssocs"}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Orginally, have \>\"", ",", " ", 
        RowBox[{"Last", "@", "offsets"}], ",", " ", "\"\< relations and \>\"",
         ",", 
        RowBox[{"Last", "@", "numberOfArguments"}], ",", 
        " ", "\"\< arguments.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"targetVector", " ", "=", " ", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"Normal", "[", "targetAssoc", "]"}], ",", 
         RowBox[{"Last", "@", "numberOfArguments"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"goodRelationsIndices", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", 
             RowBox[{"listOfRelationAssocs", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"containsFewNewTermsQ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"listOfRelationAssocs", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", 
              RowBox[{"numbersOfArgumentsWithTarget", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              RowBox[{"maxNewArgumentsInRelation", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "&"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "@", "listOfRelationAssocs"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"offsetsForGoodRelations", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"Accumulate", "[", 
          RowBox[{"Length", "/@", "goodRelationsIndices"}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"allRelations", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"listOfRelationAssocs", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"goodRelationsIndices", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "@", "listOfRelationAssocs"}]}], "}"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<After filtering relations, have \>\"", ",", " ", 
        RowBox[{"Length", "@", "allRelations"}], ",", 
        " ", "\"\< relations left.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"relationMatrix", " ", "=", 
       RowBox[{"SparseArray", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Flatten", "@", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"j", ",", "#"}], "}"}], "->", 
               RowBox[{
                RowBox[{"allRelations", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", "#", "]"}]}], "&"}], "/@", 
             RowBox[{"Keys", "[", 
              RowBox[{"allRelations", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "allRelations", "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "allRelations", "]"}], ",", 
           RowBox[{"Last", "@", "numberOfArguments"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"solution", "=", 
       RowBox[{"linearSolveDiscardRelationsWithRareArguments", "[", 
        RowBox[{
        "relationMatrix", ",", "targetVector", ",", 
         "minRelationsWithArgument"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"solution", "===", "Nothing"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"None", ",", "Module"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"solutionVectors", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"solution", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"offsetsForGoodRelations", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ";;", 
            RowBox[{"offsetsForGoodRelations", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "@", "listOfRelationAssocs"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"totalSolution", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"Length", "[", 
            RowBox[{"listOfRelationAssocs", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "@", "listOfRelationAssocs"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"totalSolution", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"goodRelationsIndices", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "=", 
         RowBox[{"solutionVectors", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "@", "listOfRelationAssocs"}]}], "}"}]}], "]"}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", "totalSolution"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.958009014339596*^9, 3.9580090780962677`*^9}, {
   3.9580091513656178`*^9, 3.958009193424324*^9}, {3.9580137121565075`*^9, 
   3.9580137124690304`*^9}, 3.95938576846015*^9, {3.9593862400919724`*^9, 
   3.959386262927126*^9}, 3.959575503290764*^9, {3.9595755609589367`*^9, 
   3.959575596127453*^9}, {3.959575639805189*^9, 3.959575766652237*^9}, {
   3.9595759116096535`*^9, 3.95957591495982*^9}, {3.9600129672301807`*^9, 
   3.9600129760621166`*^9}, {3.960013038643881*^9, 
   3.96001303873765*^9}},ExpressionUUID->"5cb15c32-8fbf-5a4a-859f-\
264a201ce2af"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SimplifyAllTerms", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"ReturnCertificate", "->", "False"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimplifyAllTerms", "::", "nosol"}], " ", "=", 
   " ", "\"\<No solution found.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimplifyAllTerms", "[", 
    RowBox[{"expr_", ",", "plan_", ",", 
     RowBox[{"function_", "->", "symmetrisedFunction_"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "useCert", ",", "\[IndentingNewLine]", "exprSymm", ",", 
       "\[IndentingNewLine]", "targetAssoc", ",", "\[IndentingNewLine]", 
       "targetAssocByIndex", ",", "\[IndentingNewLine]", "relations", ",", 
       "\[IndentingNewLine]", "relationAssocs", ",", "\[IndentingNewLine]", 
       "relationAssocsByIndex", ",", "\[IndentingNewLine]", "allArguments", ",",
        "\[IndentingNewLine]", "goodArgumentsIndices", ",", 
       "\[IndentingNewLine]", "goodArguments", ",", "\[IndentingNewLine]", 
       "argumentToIndex", ",", "\[IndentingNewLine]", "solutionVectors", ",", 
       "\[IndentingNewLine]", "i", ",", "\[IndentingNewLine]", "date", ",", 
       "\[IndentingNewLine]", "relationFunctions"}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"useCert", "=", 
       RowBox[{"OptionValue", "[", "ReturnCertificate", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "put", " ", "expr", " ", "in", " ", "association", " ", "form", " ", 
        "and", " ", "generate", " ", "relations", " ", "for", " ", "all", " ",
         "appearing", " ", "arguments"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
      "Print", "[", "\"\<Preparing expression (collection functions terms and \
putting into association)...\>\"", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"exprSymm", "=", 
       RowBox[{"Collect", "[", 
        RowBox[{
         RowBox[{"expr", "/.", 
          RowBox[{"function", "->", "symmetrisedFunction"}]}], ",", 
         RowBox[{"function", "[", "_", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"targetAssoc", "=", 
       RowBox[{"toAssoc", "[", 
        RowBox[{"exprSymm", ",", "function"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "targetAssoc"}], "==", "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"exprSymm", ",", "Module"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allArguments", " ", "=", 
       RowBox[{"Keys", "@", "targetAssoc"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"argumentToIndex", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"allArguments", "->", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "allArguments", "]"}], "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"targetAssocByIndex", " ", "=", 
       RowBox[{"KeyMap", "[", 
        RowBox[{"argumentToIndex", ",", "targetAssoc"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"date", " ", "=", " ", 
       RowBox[{"DateString", "[", 
        RowBox[{"Now", ",", 
         RowBox[{"{", 
          
          RowBox[{"\"\<Year\>\"", ",", "\"\<_\>\"", ",", "\"\<Month\>\"", 
           ",", "\"\<_\>\"", ",", "\"\<Day\>\"", ",", "\"\<_\>\"", 
           ",", "\"\<Hour\>\"", ",", "\"\<_\>\"", ",", "\"\<Minute\>\"", 
           ",", "\"\<_\>\"", ",", "\"\<Second\>\""}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Files will be stored under the datetime \>\"", ",", " ",
           "date"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<Exporting targetAssocByIndex...\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          
          RowBox[{"\"\<C:\\\\Users\\\\finnl\\\\OneDrive\\\\Studium\\\\\
Bachelorarbeit\\\\Package\\\\exports\\\\\>\"", "<>", "date", 
           "<>", "\"\<_targetAssocByIndex.mx\>\""}], ",", 
          "targetAssocByIndex"}], "]"}], ";"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<=", 
         RowBox[{"Length", "[", "plan", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Starting iteration \>\"", ",", "i"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
         "Print", 
          "[", "\"\<Selecting the numbers to use for relation generation...\>\
\"", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"goodArgumentsIndices", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"plan", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<newArguments\>\"", 
            "]"}], "[", 
           RowBox[{"targetAssocByIndex", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"relationAssocsByIndex", "[", "j", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"goodArguments", "=", 
          RowBox[{"allArguments", "[", 
           RowBox[{"[", "goodArgumentsIndices", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Starting relation generation on \>\"", ",", 
           RowBox[{"Length", "@", "goodArguments"}], ",", 
           " ", "\"\< numbers.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"relationFunctions", " ", "=", " ", 
          RowBox[{"If", "[", 
           RowBox[{"useCert", ",", 
            RowBox[{"addAllCertificates", "@", 
             RowBox[{
              RowBox[{"plan", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<relations\>\"", 
              "]"}]}], ",", 
            RowBox[{
             RowBox[{"plan", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<relations\>\"", 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"relations", "[", "i", "]"}], "=", 
          RowBox[{
           RowBox[{"generateRelations", "[", 
            RowBox[{"goodArguments", ",", "relationFunctions"}], "]"}], "/.", 
           RowBox[{"function", "->", "symmetrisedFunction"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Generated \>\"", ",", " ", 
           RowBox[{"Length", "@", 
            RowBox[{"relations", "[", "i", "]"}]}], 
           ",", "\"\< relations. Putting them in association form...\>\""}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"relationAssocs", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"toAssoc", "[", 
             RowBox[{"#", ",", "function"}], "]"}], "&"}], "/@", 
           RowBox[{"relations", "[", "i", "]"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "Joins", " ", "newly", " ", "introduced", " ", "arguments", " ", 
            "into", " ", "the", " ", "list"}], ",", " ", 
           RowBox[{
           "while", " ", "keeping", " ", "the", " ", "positions", " ", "of", " ",
             "the", " ", "old", " ", "arguments", " ", 
            RowBox[{"unchanged", ".", " ", "This"}], " ", "is", " ", 
            "important", " ", "as", " ", "it", " ", "ensures", " ", "that", " ",
             "the", " ", "old", " ", "relation", " ", "matrices", " ", "and", 
            " ", "target", " ", "vector", " ", "are", " ", 
            RowBox[{"consistent", "."}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"allArguments", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"allArguments", ",", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"Union", "@@", 
               RowBox[{"(", 
                RowBox[{"Keys", "/@", "relationAssocs"}], ")"}]}], ",", 
              "allArguments"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"argumentToIndex", "=", 
          RowBox[{"AssociationThread", "[", 
           RowBox[{"allArguments", "->", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "allArguments", "]"}], "]"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<Exporting argumentToIndex...\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{
             
             RowBox[{"\"\<C:\\\\Users\\\\finnl\\\\OneDrive\\\\Studium\\\\\
Bachelorarbeit\\\\Package\\\\exports\\\\\>\"", "<>", "date", 
              "<>", "\"\<_allArgumemts_\>\"", "<>", 
              RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.mx\>\""}], ",",
              "allArguments"}], "]"}], ";"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "transforms", " ", "the", " ", "list", " ", "of", " ", "relations", 
           " ", "to", " ", "be", " ", "of", " ", "type", " ", 
           RowBox[{"<|", 
            RowBox[{"index", " ", "->", " ", "prefactor"}], "|>"}], " ", 
           "instead", " ", "of", " ", 
           RowBox[{"<|", 
            RowBox[{"argument", " ", "->", " ", "prefactor"}], " ", "|>"}]}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"relationAssocsByIndex", "[", "i", "]"}], " ", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{"KeyMap", "[", "argumentToIndex", "]"}], ",", 
            "relationAssocs"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            
            RowBox[{"\"\<Exporting relationAssocsByIndex[\>\"", ",", "i", 
             ",", "\"\<]...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{
             
             RowBox[{"\"\<C:\\\\Users\\\\finnl\\\\OneDrive\\\\Studium\\\\\
Bachelorarbeit\\\\Package\\\\exports\\\\\>\"", "<>", "date", 
              "<>", "\"\<_relationAssocsByIndex_\>\"", "<>", 
              RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.mx\>\""}], ",", 
             RowBox[{"relationAssocsByIndex", "[", "i", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", "\"\<Starting to find solution...\>\"", "]"}], ";"}],
           "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"solutionVectors", " ", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"plan", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<linearSolve\>\"", 
            "]"}], "[", 
           RowBox[{"targetAssocByIndex", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"relationAssocsByIndex", "[", "j", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "]"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"solutionVectors", "=!=", "None"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Return", "[", 
             RowBox[{
              RowBox[{"exprSymm", "-", 
               RowBox[{"Expand", "[", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"solutionVectors", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ".", 
                   RowBox[{"relations", "[", "j", "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "]"}], "]"}]}],
               ",", "Module"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Message", "[", 
       RowBox[{"SimplifyAllTerms", "::", "nosol"}], "]"}], ";", 
      "\[IndentingNewLine]", "exprSymm"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[198]:=",ExpressionUUID->"99f014b0-f036-3b4a-9973-97a55910dedd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Of Package", "Subsection",
 CellChangeTimes->{{3.9595860624241657`*^9, 
  3.959586068703779*^9}},ExpressionUUID->"7c404054-a428-6a44-82fa-\
b98cfbf04eca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.959571181790251*^9, 3.959571181790251*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"0df0226b-2ffa-d846-beef-84e839a7afd1"]
}, Open  ]]
},
Evaluator->"Local Kernel 3",
WindowSize->{958, 1001},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b750f066-2a64-084e-a04a-c4933e8c6f6d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 333, 7, 44, "Input",ExpressionUUID->"73c9fd6d-31db-fb48-bb8d-6d5ae1781c89",
 InitializationCell->True],
Cell[890, 29, 575, 11, 82, "Input",ExpressionUUID->"01961651-9467-cb40-9c38-d5898273efab",
 InitializationCell->True],
Cell[1468, 42, 1065, 21, 215, "Input",ExpressionUUID->"cf2c1847-6f3d-d841-805a-91311112cca2",
 InitializationCell->True],
Cell[2536, 65, 1860, 50, 234, "Input",ExpressionUUID->"83984ce0-a45d-5548-b3ff-7378c116775f",
 InitializationCell->True],
Cell[4399, 117, 2494, 57, 538, "Input",ExpressionUUID->"4d08fe26-b935-b642-a1e3-0cf1ada4c667",
 InitializationCell->True],
Cell[6896, 176, 917, 21, 120, "Input",ExpressionUUID->"3ad34e9d-2fa0-6d42-96e0-913c17c8517e",
 InitializationCell->True],
Cell[7816, 199, 390, 8, 44, "Input",ExpressionUUID->"bc805bf3-6048-a24b-a451-b0dd434d8c26",
 InitializationCell->True],
Cell[8209, 209, 366, 7, 82, "Input",ExpressionUUID->"fc023ea6-0d2e-bf44-99db-0dc24634263d",
 InitializationCell->True],
Cell[8578, 218, 2470, 57, 329, "Input",ExpressionUUID->"8d61c227-a8be-5440-abb0-ce42f843bd50",
 InitializationCell->True],
Cell[11051, 277, 506, 12, 63, "Input",ExpressionUUID->"15530d53-1559-5e41-9cc3-e10bf2fbce5d",
 InitializationCell->True],
Cell[11560, 291, 373, 8, 82, "Input",ExpressionUUID->"107d5d66-206c-7041-8b47-4aca86dc6fe8",
 InitializationCell->True],
Cell[11936, 301, 457, 9, 82, "Input",ExpressionUUID->"e0b4b808-6e75-f340-8191-bd82b27d5577",
 InitializationCell->True],
Cell[12396, 312, 1416, 29, 291, "Input",ExpressionUUID->"0a927b86-5bde-6140-9fbf-f07681f896c8",
 InitializationCell->True],
Cell[13815, 343, 739, 15, 139, "Input",ExpressionUUID->"bf71d755-a704-9c40-bee6-938ce63f98a7",
 InitializationCell->True],
Cell[14557, 360, 868, 16, 177, "Input",ExpressionUUID->"8058decb-73e2-4b4f-b56b-7441ffac4c06",
 InitializationCell->True],
Cell[15428, 378, 654, 15, 101, "Input",ExpressionUUID->"e4cc5703-7157-6a4d-9e20-fc2efa67656c",
 InitializationCell->True],
Cell[16085, 395, 2123, 39, 348, "Input",ExpressionUUID->"fe1dcbbf-8360-144c-8122-c4c734194451",
 InitializationCell->True],
Cell[18211, 436, 351, 8, 82, "Input",ExpressionUUID->"6691cad9-1d15-8045-ae5c-c4b57ac79c72",
 InitializationCell->True],
Cell[18565, 446, 264, 5, 44, "Input",ExpressionUUID->"46f6cf40-aabb-dc42-9702-1e6874b01021",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[18854, 455, 234, 4, 53, "Subsection",ExpressionUUID->"e0944e62-87d9-4d4d-a984-3fe835a33113"],
Cell[19091, 461, 5555, 128, 634, "Input",ExpressionUUID->"241dfc59-c8e8-484d-89f4-ccee7ccd4711",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[24683, 594, 162, 3, 37, "Subsection",ExpressionUUID->"921a150e-8fb6-724b-8697-b57057a5fe04"],
Cell[24848, 599, 9729, 250, 843, "Input",ExpressionUUID->"9b871551-4678-da44-95d8-91116e9eca88",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[34614, 854, 373, 6, 37, "Subsection",ExpressionUUID->"6e9d50d6-9f79-1a45-8c9f-71660ef90526"],
Cell[34990, 862, 4636, 141, 329, "Input",ExpressionUUID->"1e8e3e23-dbb3-6a44-9c08-279f1a40e679",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[39663, 1008, 274, 4, 37, "Subsection",ExpressionUUID->"13d7d264-6a08-2443-80ad-16ac60343bd9"],
Cell[CellGroupData[{
Cell[39962, 1016, 179, 3, 43, "Subsubsection",ExpressionUUID->"bcbed952-ca5f-0845-a75f-88104b4744f5"],
Cell[40144, 1021, 3391, 81, 394, "Input",ExpressionUUID->"48c58a05-09e7-1547-80bf-efaf0dc879a9",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[43572, 1107, 160, 3, 43, "Subsubsection",ExpressionUUID->"51fb6714-c6f9-9048-9e92-162a1a61bb02"],
Cell[43735, 1112, 9574, 240, 762, "Input",ExpressionUUID->"6dc62752-1985-0a40-a246-f849ad866a40",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[53346, 1357, 160, 3, 43, "Subsubsection",ExpressionUUID->"fb3acb0f-5735-c245-8803-5aa15c7996a4"],
Cell[53509, 1362, 5919, 162, 523, "Input",ExpressionUUID->"9d2c9292-622c-a34a-8c66-da47391378e9",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[59465, 1529, 157, 3, 43, "Subsubsection",ExpressionUUID->"387454de-a443-5648-a13c-ebe8646a0e0b"],
Cell[59625, 1534, 3993, 103, 483, "Input",ExpressionUUID->"0cc5bd88-b41a-b544-951a-2e1d74369bc3",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[63655, 1642, 161, 3, 43, "Subsubsection",ExpressionUUID->"b0606d41-f776-1e44-9131-31f89d4025ea"],
Cell[63819, 1647, 1679, 45, 317, "Input",ExpressionUUID->"d6274936-2223-0545-85d7-7b5fa6a8bdf3",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[65535, 1697, 221, 4, 43, "Subsubsection",ExpressionUUID->"06d342bd-d248-d845-a809-6eb20598c79a"],
Cell[65759, 1703, 879, 21, 129, "Input",ExpressionUUID->"cf444c5a-8e83-554c-8860-4d9f86c5b4a8",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[66675, 1729, 211, 4, 43, "Subsubsection",ExpressionUUID->"9eac3796-c032-7743-81d9-c9212e8d87ce"],
Cell[66889, 1735, 2266, 47, 148, "Input",ExpressionUUID->"bc708365-0a52-0a4b-aa12-be6ffc1b6509",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[69192, 1787, 209, 4, 43, "Subsubsection",ExpressionUUID->"f4996ee1-316b-5841-81f3-fb84bbee31f4"],
Cell[69404, 1793, 2953, 70, 244, "Input",ExpressionUUID->"f1ed08d6-9e2f-c14d-9c0c-b27c3cee2d3f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[72394, 1868, 210, 4, 43, "Subsubsection",ExpressionUUID->"c6b7c884-3dd0-844e-b4a8-be629780767c"],
Cell[72607, 1874, 1841, 38, 204, "Input",ExpressionUUID->"3bcce977-5067-074e-9591-798e650f1cbb",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[74485, 1917, 174, 3, 43, "Subsubsection",ExpressionUUID->"01b81429-91da-ec49-85ae-41ce08bae83b"],
Cell[74662, 1922, 6234, 182, 457, "Input",ExpressionUUID->"413e801c-0326-d245-8031-ecabb0ebc91e",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[80945, 2110, 213, 4, 37, "Subsection",ExpressionUUID->"5a626d2d-9e3b-6e42-bc4f-a22d7350c5b1"],
Cell[81161, 2116, 13995, 351, 1276, "Input",ExpressionUUID->"3bc2055d-7d9c-664a-966a-5ab634a0bd06",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[95193, 2472, 276, 4, 37, "Subsection",ExpressionUUID->"7b87b7ee-7377-7244-b124-d50f40a371fd"],
Cell[95472, 2478, 2369, 63, 126, "Input",ExpressionUUID->"7e717815-4ce6-2349-8964-3faf4b7f613e",
 InitializationCell->True],
Cell[97844, 2543, 4892, 115, 444, "Input",ExpressionUUID->"7293c372-41b3-bb4a-8382-150481a7215c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[102773, 2663, 268, 4, 37, "Subsection",ExpressionUUID->"3c87265b-ea57-1549-b66e-c23e11ee3767"],
Cell[103044, 2669, 2071, 55, 142, "Input",ExpressionUUID->"7d8f8424-85f3-104a-9509-c29fe6f4cb66",
 InitializationCell->True],
Cell[105118, 2726, 6640, 187, 395, "Input",ExpressionUUID->"a74d011e-da9c-0741-8dce-269d7250936b",
 InitializationCell->True],
Cell[111761, 2915, 5275, 136, 455, "Input",ExpressionUUID->"f3f8051d-1f1a-d44e-bf3a-2c0d7158c91e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[117073, 3056, 173, 3, 37, "Subsection",ExpressionUUID->"1e6156af-b82e-f34c-a6c5-2750ac160d13"],
Cell[117249, 3061, 12222, 279, 971, "Input",ExpressionUUID->"b8cc40cc-7e34-5a4d-9e89-26beaaaa28c1",
 InitializationCell->True],
Cell[129474, 3342, 3034, 85, 335, "Input",ExpressionUUID->"2402d62c-3468-d541-8ee5-98b793578fb0",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[132533, 3431, 850, 19, 47, "Input",ExpressionUUID->"ad1dc18a-e897-f34c-a45a-e45789b75e05"],
Cell[133386, 3452, 2632, 56, 36, "Output",ExpressionUUID->"4c4ba0ea-43ba-a746-a12c-a7649f336c13"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136055, 3513, 643, 16, 47, "Input",ExpressionUUID->"3a56e5f4-c3a9-a346-8be1-20fe74094422"],
Cell[136701, 3531, 1788, 40, 36, "Output",ExpressionUUID->"129a2bf1-c991-c94b-b2bc-970332689d78"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138526, 3576, 813, 20, 66, "Input",ExpressionUUID->"672a3ac2-c786-9d48-ba8f-bb63e92768e4"],
Cell[139342, 3598, 8941, 171, 36, "Output",ExpressionUUID->"b686f41a-d397-2440-8f2b-32d42d99e674"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148320, 3774, 735, 18, 66, "Input",ExpressionUUID->"b90fd3b7-454c-eb46-a910-0ac1bc3b0079"],
Cell[149058, 3794, 1477, 36, 36, "Output",ExpressionUUID->"5e5ad2ef-6131-a74b-9da3-a3cd57629d11"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150572, 3835, 1036, 25, 123, "Input",ExpressionUUID->"fca15f5b-3f38-e94d-89ba-d76995962e6a"],
Cell[151611, 3862, 5451, 108, 36, "Output",ExpressionUUID->"22e5d543-7b9d-e543-8415-f95130c4653b"]
}, Open  ]],
Cell[157077, 3973, 21017, 411, 145, "Input",ExpressionUUID->"46883437-339d-2e42-9ea9-87b932965158",
 InitializationCell->True],
Cell[178097, 4386, 1320, 35, 101, "Input",ExpressionUUID->"f974276c-88c3-104e-8a29-7ba4b86e1f89",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[179454, 4426, 188, 3, 37, "Subsection",ExpressionUUID->"dddf15a9-e8b7-3d4d-b5ee-419b38aab27d"],
Cell[179645, 4431, 13019, 277, 1246, "Input",ExpressionUUID->"1356ea12-0dcf-524c-bdf4-46b860ef9d24",
 InitializationCell->True],
Cell[192667, 4710, 8294, 214, 842, "Input",ExpressionUUID->"716241c2-921c-aa43-b59f-57656414d1af",
 InitializationCell->True],
Cell[200964, 4926, 5764, 133, 653, "Input",ExpressionUUID->"12d9ad38-117f-0541-89da-4632c7804889",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[206765, 5064, 184, 3, 37, "Subsection",ExpressionUUID->"9b6ec48a-b93f-b34c-a5ab-1eb2db55ce97"],
Cell[206952, 5069, 3659, 89, 310, "Input",ExpressionUUID->"e400b4f3-ada6-a641-b173-2541a1cd82a1",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[210636, 5162, 450, 11, 28, "Input",ExpressionUUID->"d62ef629-0ad4-3a42-9a20-0f672330e53e"],
Cell[211089, 5175, 207, 4, 32, "Output",ExpressionUUID->"55e5b8c8-3bed-6f4f-a6cc-5827b8556b59"]
}, Open  ]],
Cell[CellGroupData[{
Cell[211333, 5184, 447, 11, 28, "Input",ExpressionUUID->"8f001c7a-9505-984c-bd3e-4812287b880c"],
Cell[211783, 5197, 181, 3, 32, "Output",ExpressionUUID->"63e22905-258e-9044-bd06-ef9972552b30"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212001, 5205, 475, 12, 28, "Input",ExpressionUUID->"d9ac9cb9-0e8b-5b48-b63f-98b5aaff6ec5"],
Cell[212479, 5219, 155, 3, 32, "Output",ExpressionUUID->"d4c9cbb4-7262-7044-859f-c7c1b5f38d2a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212671, 5227, 447, 11, 28, "Input",ExpressionUUID->"eb42c5bc-7b2b-894e-be0c-660174d5a05e"],
Cell[213121, 5240, 181, 3, 32, "Output",ExpressionUUID->"a4bd967e-0da2-4d44-8541-84b37a8bfca4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[213339, 5248, 403, 10, 28, "Input",ExpressionUUID->"0fb8f9d3-4f1b-d44e-84da-acb8de7f5dba"],
Cell[213745, 5260, 179, 3, 32, "Output",ExpressionUUID->"09c941e6-c0fa-4742-bb44-b1550b49fdaa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[213961, 5268, 403, 10, 28, "Input",ExpressionUUID->"212e4dab-7e8c-8846-aa29-3f7bddca8f67"],
Cell[214367, 5280, 155, 3, 32, "Output",ExpressionUUID->"688566fc-a8b7-5243-bdd6-2df605907cf6"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[214571, 5289, 169, 3, 37, "Subsection",ExpressionUUID->"216f03dd-6e47-f945-83ec-3cdfc89fc206"],
Cell[214743, 5294, 5644, 140, 386, "Input",ExpressionUUID->"005ff800-526a-f04f-bd7c-225d7a28bd6f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[220424, 5439, 232, 4, 53, "Subsection",ExpressionUUID->"e334979b-a1f6-1745-92dc-225443990618"],
Cell[220659, 5445, 5086, 111, 451, "Input",ExpressionUUID->"8cbb8fb1-6383-264d-93b1-26c893497b04",
 InitializationCell->True],
Cell[225748, 5558, 8095, 171, 919, "Input",ExpressionUUID->"457bbd32-f6c3-cf44-a4fa-00bdb30aac1e",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[233880, 5734, 292, 4, 53, "Subsection",ExpressionUUID->"3190ae1c-fcad-c64f-8587-93b47847617f"],
Cell[234175, 5740, 4150, 96, 519, "Input",ExpressionUUID->"d19440ed-073f-2e49-8780-b28d24cdb607",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[238362, 5841, 238, 4, 37, "Subsection",ExpressionUUID->"3d177c16-421c-e042-97f1-13276ae87076"],
Cell[238603, 5847, 7511, 169, 957, "Input",ExpressionUUID->"1eef44e1-4b1e-6448-b7f8-25f5933cae3b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[246151, 6021, 244, 4, 37, "Subsection",ExpressionUUID->"5e899738-4de8-7345-a0b1-c7cd5e11a9d0"],
Cell[246398, 6027, 24072, 573, 2517, "Input",ExpressionUUID->"5cb15c32-8fbf-5a4a-859f-264a201ce2af",
 InitializationCell->True],
Cell[270473, 6602, 12948, 284, 1471, "Input",ExpressionUUID->"99f014b0-f036-3b4a-9973-97a55910dedd",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[283458, 6891, 164, 3, 53, "Subsection",ExpressionUUID->"7c404054-a428-6a44-82fa-b98cfbf04eca"],
Cell[283625, 6896, 307, 8, 63, "Input",ExpressionUUID->"0df0226b-2ffa-d846-beef-84e839a7afd1",
 InitializationCell->True]
}, Open  ]]
}
]
*)

